<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Creating Your Own Data Types</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba04_3.htm" OnClick="SyncURL(&quot;chapters/ba04_3.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3CreatingYourOwnDataTypes"></a>
<p CLASS="heading3OrgHeading1h1">Creating Your Own Data Types</p>
<p CLASS="Textttext">You can combine variables of several different types to create user-defined types (known as <span CLASS="NewTermntrm">structures</span> in the C programming language). User-defined types are useful when you want to create a single variable that records several related pieces of information.</p>
<a NAME="4DeclaringaUserDefinedType"></a>
<p CLASS="heading4OrgHeading2h2">Declaring a User-Defined Type</p>
<p CLASS="Textttext">You create a user-defined type with the <span CLASS="ElementNameeln">Type</span> statement, which must be placed in the Declarations section of a standard module. User-defined types can be declared as <span CLASS="ElementNameeln">Private</span> or <span CLASS="ElementNameeln">Public</span> with the appropriate<span CLASS="ElementNameeln"> </span>keyword, as shown in the following examples:</p>
<p CLASS="CodeTextct">Private Type YourType<br>Public Type YourType</p>
<p CLASS="Textttext">For example, you could create a user-defined type that records information about a computer system by placing the following code in the Declarations section of any standard module:</p>
<p CLASS="CodeTextct">Public Type SystemInfo<br>&nbsp;&nbsp;&amp;nbspvarCPU As Variant<br>&nbsp;&nbsp;&amp;nbsplngMemory As Long<br>&nbsp;&nbsp;&amp;nbspintVideoColors As Integer<br>&nbsp;&nbsp;&amp;nbspcurCost As Currency<br>&nbsp;&nbsp;&amp;nbspdtePurchase As Variant<br>End Type</p>
<a NAME="5DeclaringVariablesofaUserDefinedType"></a>
<p CLASS="heading5OrgHeading3h3">Declaring Variables of a User-Defined Type</p>
<p CLASS="Textttext">You can declare local, private module-level, or public module-level variables of the same user-defined type. For example:</p>
<p CLASS="CodeTextct">Dim sysMine As SystemInfo, sysYours As SystemInfo</p>
<p CLASS="Textttext">The following table illustrates where, and with what scope, you can declare user-defined types and their variables.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Procedure/Module</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">You can create a <br>user-defined type as</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Variables of a <br>user-defined type can be</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Procedures</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Not applicable</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Not applicable</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Standard modules</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Private or public</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Private or public</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Form or report modules</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Private<span CLASS="ElementNameeln"> </span>only</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Private only</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">&nbsp;&nbsp;&nbsp;<a NAME="4AssigningandRetrievingValues"></a>
<p CLASS="heading4OrgHeading2h2">Assigning and Retrieving Values</p>
<p CLASS="Textttext">Assigning and retrieving values from the elements of a user-defined variable is similar to setting and getting properties.</p>
<p CLASS="CodeTextct">sysMine.varCPU = &quot;486&quot;<br>If sysMine.dtePurchase &gt; #1/1/92# Then</p>
<p CLASS="Textttext">You can also assign one variable to another if they are both of the same user-defined type. This assigns all the elements of one variable to the same elements in the other variable.</p>
<p CLASS="CodeTextct">sysYours = sysMine</p>
<a NAME="4UserDefinedTypesThatContainArrays"></a>
<p CLASS="heading4OrgHeading2h2">User-Defined Types That Contain Arrays</p>
<p CLASS="Textttext">A user-defined type can contain an ordinary (fixed-size) array, as shown in the following example:</p>
<p CLASS="CodeTextct">Type SystemInfo<br>&nbsp;&nbsp;&amp;nbspvarCPU As Variant<br>&nbsp;&nbsp;&amp;nbsplngMemory As Long<br>&nbsp;&nbsp;&amp;nbspstrDiskDrives(25) As String&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Fixed-size array.<br>&nbsp;&nbsp;&amp;nbspintVideoColors As Integer<br>&nbsp;&nbsp;&amp;nbspcurCost As Currency<br>&nbsp;&nbsp;&amp;nbspdtePurchase As Variant<br>End Type</p>
<p CLASS="Textttext">It can also contain a dynamic array:</p>
<p CLASS="CodeTextct">Type SystemInfo<br>&nbsp;&nbsp;&amp;nbspvarCPU As Variant<br>&nbsp;&nbsp;&amp;nbsplngMemory As Long<br>&nbsp;&nbsp;&amp;nbspstrDiskDrives() As String&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Dynamic array.<br>&nbsp;&nbsp;&amp;nbspintVideoColors As Integer<br>&nbsp;&nbsp;&amp;nbspcurCost As Currency<br>&nbsp;&nbsp;&amp;nbspdtePurchase As Variant<br>End Type</p>
<p CLASS="Textttext">You can access the values in an array within a user-defined type in the same way that you access the property of an object. For example:</p>
<p CLASS="CodeTextct">Dim sysMine As SystemInfo<br>sysMine.strDiskDrives(0) = &quot;1.44 MB&quot;</p>
<p CLASS="Textttext">You can also declare an array of user-defined types:</p>
<p CLASS="CodeTextct">Dim sysAll(100) As SystemInfo</p>
<p CLASS="Textttext">Follow the same rules to access the components of each element in the array:</p>
<p CLASS="CodeTextct">sysAll(5).varCPU = &quot;386SX&quot;<br>sysAll(intX).strDiskDrives(2) = &quot;100M SCSI&quot;</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on arrays, see <a HREF="../chapters/ba04_6.htm" OnClick="SyncURL(&quot;chapters/ba04_6.htm&quot;)">&quot;Arrays&quot;</a> later in this chapter.</p>
<a NAME="4DeclaringProcedureArguments"></a>
<p CLASS="heading4OrgHeading2h2">Declaring Procedure Arguments</p>
<p CLASS="Textttext">You can declare procedure arguments with a user-defined type.</p>
<p CLASS="CodeTextct">Sub FillSystem(sysAny As SystemInfo)<br>&nbsp;&nbsp;&amp;nbspsysAny.varCPU = &quot;486&quot;<br>&nbsp;&nbsp;&amp;nbspsysAny.lngMemory = &quot;24&quot;<br>&nbsp;&nbsp;&amp;nbspsysAny.curCost = &quot;$3000.00&quot;<br>&nbsp;&nbsp;&amp;nbspsysAny.dtePurchase = Now<br>End Sub</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If you want to pass a user-defined type in a form or report module, the procedure must be private.</p>
<p CLASS="Textttext">You can return user-defined types from functions, and you can pass a user-defined type variable to a procedure as one of the arguments. Because user-defined types are always passed by reference, the procedure can modify the argument and return it to the calling procedure, as illustrated in the previous example.</p>
<a NAME="4UserDefinedTypesThatContainObjects"></a>
<p CLASS="heading4OrgHeading2h2">User-Defined Types That Contain Objects</p>
<p CLASS="Textttext">User-defined types can also contain objects. For example:</p>
<p CLASS="CodeTextct">Private Type AccountPack<br>&nbsp;&nbsp;&amp;nbspfrmInput As Form<br>&nbsp;&nbsp;&amp;nbspdbsPayRollAccount As Database<br>End Type
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>Because the <span CLASS="ElementNameeln">Variant</span> data type can store many different types of data, a <span CLASS="ElementNameeln">Variant</span> array can be used in many situations where you may expect to use a user-defined type. A <span CLASS="ElementNameeln">Variant</span> array is actually more flexible than a user-defined type, because you can change the type of data you store in each element at any time, and you can make the array dynamic so that you can change its size as necessary. However, a <span CLASS="ElementNameeln">Variant</span> array always uses more memory than an equivalent user-defined type.</p>
<a NAME="4NestingDataStructures"></a>
<p CLASS="heading4OrgHeading2h2">Nesting Data Structures</p>
<p CLASS="Textttext">Nesting data structures can get as complex as you want. In fact, user-defined types can contain other user-defined types, as shown in the following example. To make your code more readable and easier to debug, try to keep all the code that defines user-defined types in one module. For example:</p>
<p CLASS="CodeTextct">Type DriveInfo<br>&nbsp;&nbsp;&amp;nbspType As String<br>&nbsp;&nbsp;&amp;nbspSize As Long<br>End Type<br>Type SystemInfo<br>&nbsp;&nbsp;&amp;nbspvarCPU As Variant<br>&nbsp;&nbsp;&amp;nbsplngMemory As Long<br>&nbsp;&nbsp;&amp;nbspstrDiskDrives(26) As DriveInfo<br>&nbsp;&nbsp;&amp;nbspcurCost As Currency<br>&nbsp;&nbsp;&amp;nbspdtePurchase As Variant<br>End Type</p>
<p CLASS="Textttext">The following code demonstrates how you can refer to a nested user-defined type:</p>
<p CLASS="CodeTextct">Dim sysAll(100) As SystemInfo<br>sysAll(1).strDiskDrives(0).Type = &quot;Floppy&quot;</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba04_5.htm" OnClick="SyncURL(&quot;chapters/ba04_5.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
