<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>CHAPTER 14</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba13_9.htm" OnClick="SyncURL(&quot;chapters/ba13_9.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<p CLASS="heading2ChapterNumberAppendixLetterchn">CHAPTER&nbsp; 14</p>
<p CLASS="ChapterAppendixTitlecht">Securing Your Application</p>
<p CLASS="ChapterSummaryTextchsum">If you plan to distribute your application to other users, you may want to establish security within your application to protect the objects you have created, as well as the data in your tables, from improper access. This chapter discusses techniques you can use to secure your application.
<a NAME="3ProtectingYourApplication"></a>
<p CLASS="heading3OrgHeading1h1">Protecting Your Application</p>
<p CLASS="Textttext">There are several reasons why it may be important to protect the data and features in an application that you develop. For example, your application may use objects that took you a great deal of time to design. Perhaps you or the users of your application need to control access to sensitive information. Or, to reduce maintenance for your application, you may want to prevent users from inadvertently breaking your application by changing code or objects on which the application depends. Consider implementing some form of security to control what a user, or group of users, can do with the objects and data in your application.
<p CLASS="Textttext">The most powerful and flexible method of protecting your application is called <span CLASS="NewTermntrm">user-level security</span>. However, establishing user-level security is a complex process and it may exceed your situation's requirements. As alternatives to user-level security, Microsoft Access provides the following methods you can use to protect your application:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspUsing startup options to restrict access to default menus and toolbars, the Database window, and special keys.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspEstablishing a password to control opening the database.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspSaving your application as an MDE file to remove Visual Basic source code and prevent changes to the design of forms, reports, and modules.</p>
<p CLASS="Textttext">Microsoft Access also provides database <span CLASS="NewTermntrm">encryption</span> that you can use to prevent unauthorized users from viewing the objects in your application with a disk editor or other utility program. You can use encryption in conjunction with all methods of protecting your application.
<p CLASS="Textttext">The strategy you use depends on the extent of security you need and how your application will be used. The following sections discuss these options.</p>
<a NAME="4UsingStartupOptions"></a>
<p CLASS="heading4OrgHeading2h2">Using Startup Options</p>
<p CLASS="Textttext"> In a casual environment where true security isn't required, you can use startup options to restrict access to default menus and toolbars, the Database window, and special keys. To perform the following procedure, your application must have a startup form and a custom menu bar that contains only the commands you want available.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor information on creating a startup form, see <a HREF="../chapters/ba01_7.htm" OnClick="SyncURL(&quot;chapters/ba01_7.htm&quot;)">&quot;Setting Startup Options&quot;</a> in Chapter 1, &quot;Creating an Application.&quot; For information on creating a custom menu bar, see <a HREF="../chapters/ba01_6.htm#4CreatingNewMenuBarsToolbarsandShortcutMenus" OnClick="SyncURL(&quot;chapters/ba01_6.htm&quot;)">&quot;Creating New Menu Bars, Toolbars, and Shortcut Menus&quot;</a> in Chapter 1, &quot;Creating an Application.&quot;</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To use startup options to protect your application</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">Tools</span> menu, click <span CLASS="ElementNameeln">Startup</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Display Form</span> box, click the name of your startup form.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Menu Bar</span> box, click the name of your menu bar.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspClick <span CLASS="ElementNameeln">Advanced</span> to display the rest of the dialog box.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&amp;nbspClear the following check boxes: <span CLASS="ElementNameeln">Allow Full Menus</span>, <span CLASS="ElementNameeln">Allow Default Shortcut Menus</span>, <span CLASS="ElementNameeln">Display Database Window</span>, <span CLASS="ElementNameeln">Allow Built-in Toolbars</span>, <span CLASS="ElementNameeln">Allow Toolbar/Menu Changes</span>, and <span CLASS="ElementNameeln">Use Access Special Keys</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">6</span>&nbsp;&nbsp;&amp;nbspIn Visual Basic, set the <span CLASS="ElementNameeln">AllowBypassKey</span> property to <span CLASS="ElementNameeln">False</span>. This prevents users from using the SHIFT key to bypass the settings in the <span CLASS="ElementNameeln">Startup</span> dialog box.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For information on how to set the <span CLASS="ElementNameeln">AllowBypassKey</span> property, search the Help index for &quot;AllowBypassKey property.&quot;</span></p>
<p CLASS="Textttext">A user can bypass this method of security by setting the database's <span CLASS="ElementNameeln">AllowBypassKey</span> property back to <span CLASS="ElementNameeln">True</span>, but that user would need to understand how to create the appropriate line of Visual Basic code to do so.</p>
<a NAME="4SettingaDatabasePassword"></a>
<p CLASS="heading4OrgHeading2h2">Setting a Database Password</p>
<p CLASS="Textttext">Adding a database password is an easy way to prevent unauthorized users from opening your application. Use this approach when you need to control which users can open your application, but not what they do after providing the correct database password.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To set a database password</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspClose the database. If the database is being shared on a network, make sure no other users have it open.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspMake a backup copy of your database and store it in a secure place.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">File</span> menu, click <span CLASS="ElementNameeln">Open Database</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspSelect the <span CLASS="ElementNameeln">Exclusive</span> check box, and then open the database.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">Tools</span> menu, point to <span CLASS="ElementNameeln">Security</span>, and then click <span CLASS="ElementNameeln">Set Database Password</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">6</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Password</span> box, type the password. Passwords are case-sensitive.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">7</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Verify</span> box, type the password again to confirm it, and then click <span CLASS="ElementNameeln">OK</span>.</p>
<p CLASS="Textttext">The password is now set. Each time a user tries to open the database, a dialog box appears that requests the database password.</p>
<p CLASS="CautionTextcat"><span CLASS="CautionHeadingcah">Caution&nbsp;&nbsp;&nbsp;</span>Write down your database password and keep it in a safe place. If your database password is lost or forgotten, you won't be able to open your database or retrieve the information it contains.
<p CLASS="CautionTextcat">Do not use a database password if you plan to replicate the database. You can't synchronize a replicated database if a database password has been set. Defining user-level security permissions doesn't interfere with replica synchronization. For more information on database replication, see Chapter 20, <a HREF="../chapters/ba20_1.htm" OnClick="SyncURL(&quot;chapters/ba20_1.htm&quot;)">&quot;Using Replication in Your Application.&quot;</a></p>
<p CLASS="Textttext">When you set a database password, the <span CLASS="ElementNameeln">Set Database Password</span> command changes to <span CLASS="ElementNameeln">Remove Database Password</span>. To clear a database password, click <span CLASS="ElementNameeln">Remove Database Password</span> on the <span CLASS="ElementNameeln">Security</span> submenu (<span CLASS="ElementNameeln">Tools</span> menu), type the correct password in the <span CLASS="ElementNameeln">Password</span> box, then confirm it in the <span CLASS="ElementNameeln">Verify</span> box.</p>
<a NAME="5ImportantConsiderationsWhenUsingaDatabasePassword"></a>
<p CLASS="heading5OrgHeading3h3">Important Considerations When Using a Database Password</p>
<p CLASS="Textttext">Take the following items into consideration when using a database password:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspSetting a database password doesn't prevent someone from using a disk editor or other utility program to read your data without opening the database. To prevent this as well, encrypt your database.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&nbsp;<span CLASS="Xref">For more information on encrypting a database, see <a HREF="../chapters/ba14_3.htm" OnClick="SyncURL(&quot;chapters/ba14_3.htm&quot;)">&quot;Encrypting a Database&quot;</a> later in this chapter.</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspAny user who knows the database password and has access to the <span CLASS="ElementNameeln">Remove Database Password</span> command can change or clear the password, unless you remove the Administer permission on the database for all users and groups except the database administrator. Similarly, if you want to prevent users from setting a password on a database, remove the Administer permission on the database for those users or groups. By default, the Users group, the Admins group, and the creator (owner) of the database all have Administer permission on the database.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&nbsp;<span CLASS="Xref">For more information on permissions, see <a HREF="../chapters/ba14_2.htm#5Permissions" OnClick="SyncURL(&quot;chapters/ba14_2.htm&quot;)">&quot;Permissions&quot;</a> later in this chapter.</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspIf you use a password to protect a database containing tables that are linked to another database, Microsoft Access stores the password when the link is established. This means that any user who can open the database that contains the link can open the linked table. Additionally, Microsoft Access stores the password in an unencrypted form. If this will compromise the security of the password-protected database, you should not use a database password to protect the database. Instead, you should establish user-level security to control access to sensitive data in that database.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&nbsp;<span CLASS="Xref">For more information on user-level security, see <a HREF="../chapters/ba14_2.htm" OnClick="SyncURL(&quot;chapters/ba14_2.htm&quot;)">&quot;Microsoft Access User-Level Security&quot;</a> later in this chapter.</span>
<a NAME="5UsingDataAccessObjectstoWorkwithDatabasePasswords"></a>
<p CLASS="heading5OrgHeading3h3">Using Data Access Objects to Work with Database Passwords</p>
<p CLASS="Textttext">As an alternate to using the Microsoft Access user interface to work with database passwords, you can use Visual Basic code to manipulate the Data Access Objects (DAO) that control them.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>If you open a database with code and a user later sets a database password without you being aware of it, your code will no longer be able to open the database. You should always check to see if your attempt to open a database has succeeded. Your code should provide error handling in case it encounters a password-protected database.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on preventing users from setting database passwords and other considerations when using a database password, see <a HREF="#4SettingaDatabasePassword" OnClick="SyncURL(&quot;chapters/ba14_1.htm&quot;)">&quot;Setting a Database Password&quot;</a> earlier in this chapter.</p>
<a NAME="6SettingaDatabasePasswordinCode"></a>
<p CLASS="heading6OrgHeading4h4">Setting a Database Password in Code</p>
<p CLASS="Textttext">A database password can be set by using DAO code with the <span CLASS="ElementNameeln">NewPassword</span> method. The following code opens the Orders sample database and assigns a password to it:</p>
<p CLASS="CodeTextct"> Sub SetDBPassword()<br>&nbsp;&nbsp;&nbsp;' Declare database variable.<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspConst conFilePath = &quot;C:\Program Files\Microsoft Office\Office\Samples\&quot;<br>&nbsp;&nbsp;&nbsp;' Open database for exclusive access.<br>&nbsp;&nbsp;&amp;nbspSet dbs = OpenDatabase(conFilePath &amp; &quot;Orders.mdb&quot;, True)<br>&nbsp;&nbsp;&nbsp;' Set database password and close database.<br>&nbsp;&nbsp;&amp;nbspdbs.NewPassword &quot;&quot;,&quot;topsecret&quot;<br>&nbsp;&nbsp;&amp;nbspdbs.Close<br>End Sub</p>
<a NAME="6OpeningaPasswordProtectedDatabase"></a>
<p CLASS="heading6OrgHeading4h4">Opening a Password-Protected Database</p>
<p CLASS="Textttext">After a database password has been set, all attempts to open that database fail unless the correct password is given. To open a password-protected database using DAO code, you specify the password as part of the source argument. For example, the following code opens the password-protected Orders sample database:</p>
<p CLASS="CodeTextct">Sub OpenProtectedDB()<br>&nbsp;&nbsp;&nbsp;' Declare database variable.<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspConst conFilePath = &quot;C:\Program Files\Microsoft Office\Office\Samples\&quot;<br>&nbsp;&nbsp;&nbsp;' Open database for shared, read/write access, and specify database password.<br>&nbsp;&nbsp;&amp;nbspSet dbs = OpenDatabase(conFilePath &amp; &quot;Orders.mdb&quot;, False, False, &quot;;pwd=topsecret&quot;)<br>End Sub</p>
<a NAME="6ChangingaDatabasePassword"></a>
<p CLASS="heading6OrgHeading4h4">Changing a Database Password</p>
<p CLASS="Textttext">To change a database password, you must supply both the existing and new passwords to the <span CLASS="ElementNameeln">NewPassword</span> method. The following example changes the password of the Orders sample database from &quot;topsecret&quot; to &quot;ultrasecret&quot;:</p>
<p CLASS="CodeTextct"> Sub ChangeDBPassword()<br>&nbsp;&nbsp;&nbsp;' Declare database variable.<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspConst conFilePath = &quot;C:\Program Files\Microsoft Office\Office\Samples\&quot;<br>&nbsp;&nbsp;&nbsp;' Open database for exclusive, read/write access, and specify<br>&nbsp;&nbsp;&nbsp;' current database password.<br>&nbsp;&nbsp;&amp;nbspSet dbs = OpenDatabase(conFilePath &amp; &quot;Orders.mdb&quot;, True, False, &quot;;pwd=topsecret&quot;)<br>&nbsp;&nbsp;&nbsp;' Change database password and close database.<br>&nbsp;&nbsp;&amp;nbspdbs.NewPassword &quot;topsecret&quot;,&quot;ultrasecret&quot;<br>&nbsp;&nbsp;&amp;nbspdbs.Close<br>End Sub</p>
<a NAME="4SavingYourApplicationasanMDEFile"></a>
<p CLASS="heading4OrgHeading2h2">Saving Your Application as an MDE File</p>
<p CLASS="Textttext">Saving your database as an MDE file creates a separate copy of your database that contains no Visual Basic source code. Your code is compiled and continues to run, but it can't be viewed or edited. Additionally, users can't view or modify the design of forms, reports, and modules in an MDE database. However, users can view and modify the design of tables, queries, macros, and relationships in an MDE database. Saving your application as an MDE file also reduces the size of your database and makes your application's use of memory more efficient.
<p CLASS="Textttext">Saving your database as an MDE file prevents the following actions:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspViewing or modifying the design of forms, reports, or modules.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspCreating forms, reports, or modules.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspAdding or deleting references to object libraries or databases by using the <span CLASS="ElementNameeln">References</span> command on the <span CLASS="ElementNameeln">Tools</span> menu.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspUsing the Object Browser.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspChanging code by using the properties or methods of the Microsoft Access or Visual Basic object models (because an MDE file contains no source code).</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspImporting or exporting forms, reports, or modules. However, tables, queries, and macros can be imported from or exported to non-MDE databases. Any tables, queries, or macros in an MDE database can be imported into another database, but all forms, reports, and modules can't be imported into another database.</p>
<p CLASS="Textttext">If you need to modify the design of forms, reports, or modules in a database saved as an MDE file, you must open the original database, modify it, and then save it as an MDE file again. Saving a database that contains tables as an MDE file creates complications reconciling different versions of the data if you need to modify the design of the application later. For this reason, saving a database as an MDE file is most appropriate for the front-end of an application that has been split into a back-end database that contains only tables and a front-end database that contains the remaining objects.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor more information on splitting a database, see <a HREF="../chapters/ba15_3.htm" OnClick="SyncURL(&quot;chapters/ba15_3.htm&quot;)">&quot;Separating Your Application's Tables from Its Other Objects&quot;</a> in Chapter 15 &quot;Delivering Your Application.&quot;</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The process of saving a database as an MDE file compiles all modules and compacts the destination database, so there is no need to perform these steps before saving a database as an MDE file.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To save a database as an MDE file</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspClose the database. If the database is being shared on a network, make sure no other users have it open.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">Tools</span> menu, point to <span CLASS="ElementNameeln">Database Utilities</span>, and then click<span CLASS="ElementNameeln"> Make MDE File</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Save As MDE </span>dialog box, select the database you want to save as an MDE file, and then click <span CLASS="ElementNameeln">Make MDE</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Save MDE As</span> dialog box, specify a file name for the database and the location where you want to save it, and then click <span CLASS="ElementNameeln">Save</span>.</p>
<p CLASS="ListText1lt1">Your original database is unchanged and a new copy is saved as an MDE file using the file name and location you specified in step 4.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Saving a database as an MDE file doesn't create a run-time version of the database. To use an MDE database, users must have Microsoft Access 97 installed. Alternatively, if you have Microsoft Office 97, Developer Edition, you can save a database as an MDE file and then use the Setup Wizard to create a distributable run-time version of it.</p>
<p CLASS="CautionTextcat"><span CLASS="CautionHeadingcah">Caution&nbsp;&nbsp;&nbsp;</span>Be sure to save a backup copy of your original database in a safe place. You cannot modify the design of forms, reports, or modules in a database saved as an MDE file. If you need to modify the design of any of these objects, you must open the original database, modify the objects, and then save the database again as an MDE file. Also, databases saved as MDE files in Microsoft Access 97 cannot be opened or converted in later versions of Microsoft Access. To convert or open it in later versions of Microsoft Access, you must use the original database.</p>
<a NAME="5UsingOtherFormsofSecuritywithaDatabaseThatIsSavedasanMDEFile"></a>
<p CLASS="heading5OrgHeading3h3">Using Other Forms of Security with a Database That Is Saved as an MDE File</p>
<p CLASS="Textttext">Saving a database as an MDE file is a good way to protect the code and the design of forms and reports in your application, and it doesn't require users to log on or require you to create and manage the user accounts and permissions required by user-level security. However, an MDE file doesn't control how users access your application's tables, queries, and macros. If you want more control over these database objects, you should establish user-level security before you save your database as an MDE file.
<p CLASS="Textttext">If the database you want to save as an MDE file is secured with user-level security, you must meet the following requirements before you can proceed:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspBefore starting Microsoft Access, you must use the Workgroup Administrator or the <span CLASS="ElementNameeln">/wrkgrp</span> command-line option to join the workgroup defined by the workgroup information file that was in use when the database was created. The workgroup information file defines the user accounts used to access the database.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also</span><span CLASS="Xref">&nbsp;&nbsp;&amp;nbspFor more information on workgroup information files, see <a HREF="../chapters/ba14_2.htm#5WhereIsWorkgroupandPermissionInformationStored" OnClick="SyncURL(&quot;chapters/ba14_2.htm&quot;)">&quot;Where Is Workgroup and Permission Information Stored?&quot;</a> later in this chapter.</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYour user account must have Open/Run and Open Exclusive permissions for the database object.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYour user account must have Modify Design or Administer permission for any tables in the database, or you must be the owner of any tables in the database.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYour user account must have Read Design permission for all objects in the database.</p>
<p CLASS="Textttext">You can also use a database password to control who can open an MDE database. To use a database password or establish user-level security for an MDE database, you must implement these features in the original database before you save it as an MDE file. The database password or user-level security will be preserved in the new MDE database.
<p CLASS="Textttext">Saving your database as an MDE file prevents all users (including database administrators) from modifying the design of forms, reports, and modules. If this is too restrictive and you require additional control and flexibility in these areas, you shouldn't save your database as an MDE file<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">you should establish user-level security instead.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor more information on database passwords, see <a HREF="#4SettingaDatabasePassword" OnClick="SyncURL(&quot;chapters/ba14_1.htm&quot;)">&quot;Setting a Database Password&quot;</a> earlier in this chapter. For more information on user-level security, see <a HREF="../chapters/ba14_2.htm" OnClick="SyncURL(&quot;chapters/ba14_2.htm&quot;)">&quot;Microsoft Access User-Level Security&quot;</a> later in this chapter.</p>
<a NAME="5SavingaReplicatedDatabaseasanMDEFile"></a>
<p CLASS="heading5OrgHeading3h3">Saving a Replicated Database as an MDE File</p>
<p CLASS="Textttext">A replicated database (either a replica or Design Master) cannot be saved as an MDE file; however, once a database is saved as an MDE file, it can be replicated. To save a replicated database as an MDE file, you must first remove replication system fields, tables, and properties.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor more information on removing replication fields, tables, and properties, search the Help index for &quot;replicated databases, making regular.&quot; For more information on database replication, see Chapter 20, <a HREF="../chapters/ba20_1.htm" OnClick="SyncURL(&quot;chapters/ba20_1.htm&quot;)">&quot;Using Replication in Your Application.&quot;</a></p>
<a NAME="5SavingaDatabaseThatReferencesAnotherDatabaseasanMDEFile"></a>
<p CLASS="heading5OrgHeading3h3">Saving a Database That References Another Database as an MDE File</p>
<p CLASS="Textttext">If you try to save a database (.mdb) or an add-in database (.mda) that references another database or add-in as an MDE file, Microsoft Access displays an error message and doesn't let you complete the operation. To save a database that references another database as an MDE file, you must save all databases in the chain of references as MDE files, starting from the first database referenced. After saving the first database as an MDE file, you must then update the reference in the next database to point to the new MDE file before saving it as an MDE file, and so on.
<p CLASS="Textttext">For example, if Database1.mdb references Database2.mdb, which references Database3.mda, you would proceed as follows:</p>
<p CLASS="ListSequentialItem1ls">1.&nbsp;&amp;nbspSave Database3.mda as Database3.mde.</p>
<p CLASS="ListSequentialItem1ls">2.&nbsp;&amp;nbspOpen Database 2.mdb and change its reference to point to the new Database3.mde.</p>
<p CLASS="ListSequentialItem1ls">3.&nbsp;&amp;nbspSave Database2.mdb as Database2.mde.</p>
<p CLASS="ListSequentialItem1ls">4.&nbsp;&amp;nbspOpen Database1.mdb and change its reference to point to the new Database2.mde.</p>
<p CLASS="ListSequentialItem1ls">5.&nbsp;&amp;nbspSave Database1.mdb as Database1.mde.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor information on referencing another database, see <a HREF="../chapters/ba12_1.htm#4ReferencingLibraryDatabases" OnClick="SyncURL(&quot;chapters/ba12_1.htm&quot;)">&quot;Referencing Library Databases&quot;</a> in Chapter 12, &quot;Using Library Databases and Dynamic-Link Libraries.&quot;</p>
<!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<!--DocFooterEnd-->
<a HREF="ba14_2.htm" OnClick="SyncURL(&quot;chapters/ba14_2.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
