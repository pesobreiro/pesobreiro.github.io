<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Managing Events in Your Application</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba06_1.htm" OnClick="SyncURL(&quot;chapters/ba06_1.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3ManagingEventsinYourApplication"></a>
<p CLASS="heading3OrgHeading1h1">Managing Events in Your Application</p>
<p CLASS="Textttext">Most operations in Microsoft Access involve a sequence of events. For example, the process of opening a form usually includes the following sequence:</p>
<p CLASS="ListSequentialItem1ls">1.&nbsp;&amp;nbspWhen the form opens, but before the first record is displayed, the Open event occurs.</p>
<p CLASS="ListSequentialItem1ls">2.&nbsp;&amp;nbspWhen the form opens and its records are displayed, the Load event occurs.</p>
<p CLASS="ListSequentialItem1ls">3.&nbsp;&amp;nbspWhen the form becomes the active window, the Activate event occurs.</p>
<p CLASS="Textttext">Other events also occur when the previously active window becomes inactive and the focus moves to an object in the new active window. The full sequence of events in typical situations is explored later in this chapter. </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the order of events, search the Help index for &quot;events, order of.&quot;</p>
<p CLASS="Textttext">Because each step in opening a form is a separate event, your application can run a macro or a procedure exactly when you want it to. For example, your application can close another window or preset the focus in the new active window before the first record is displayed. Or it can display a custom toolbar on the form when its window becomes active.
<p CLASS="Textttext">You can also cancel many events. For example, you can prevent a form from opening if certain conditions are not met by including code in the form's Open event procedure that cancels the Open event when an expression evaluates to <span CLASS="ElementNameeln">True</span>.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on canceling events, see <a HREF="../chapters/ba06_3.htm" OnClick="SyncURL(&quot;chapters/ba06_3.htm&quot;)">&quot;Canceling Events&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">Microsoft Access events fall into several categories. The following table summarizes these event categories.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Event category</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Occur when</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Window events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Close, Load, Open, Resize, Unload</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">A user or code opens, resizes, or closes a form or report.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Focus events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Activate, Deactivate, Enter, Exit, GotFocus, LostFocus</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Objects receive or lose the focus, or become active or inactive.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Data events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">AfterDelConfirm, AfterInsert, AfterUpdate, BeforeDelConfirm, BeforeInsert, BeforeUpdate, Change, Current, Delete, NotInList, Updated</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">A user or code enters, deletes, or changes data in a form or control, or moves the focus from one record to another.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Mouse events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Click, DblClick, MouseDown, MouseMove, MouseUp</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">A user performs a mouse action, such as clicking or double-clicking.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Keyboard events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">KeyDown, KeyPress, KeyUp</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">A user types on the keyboard, or keys are sent using the SendKeys action or the <span CLASS="ElementNameeln">SendKeys</span> statement.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Print events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Format, NoData, Page, Print, Retreat</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">A report is being printed, or is being formatted for printing.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Filter events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">ApplyFilter, Filter</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">A user creates or applies a filter to a form.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Error and Timing events</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Error, Timer</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Access or the Jet database engine encounters an error, or a specified time interval passes.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on each of these events and examples of how to respond to them in your application, search the Help index for &quot;events, listed alphabetically&quot; or for the name of a particular event.</p>
<a NAME="4WorkingwithFormsandControls"></a>
<p CLASS="heading4OrgHeading2h2">Working with Forms and Controls</p>
<p CLASS="Textttext">Opening a form triggers a sequence of events, including the Open, Load, Resize, and Activate events. In addition, if no control on the form can receive the focus, a GotFocus event occurs for the form itself. Other events occur as you work with the form and its controls. You can write macros or Visual Basic code for any of these events, so you have a fine degree of control over how your application behaves. </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>To see the sequence of events that occurs when you work with forms and controls, open the ShowEvents form in the Orders sample application.</p>
<p CLASS="Textttext">Because opening forms, moving between forms, and working with controls are some of the most common operations in a Microsoft Access application, understanding the order of these events is one of the keys to effective application development. This section describes the sequence of events for some common form and control operations.</p>
<a NAME="5OpeningandClosingaForm"></a>
<p CLASS="heading5OrgHeading3h3">Opening and Closing a Form</p>
<p CLASS="Textttext">When you first open a form that contains an active control<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">one that can receive the focus<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">the following sequence of events occurs for the form:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0604.jpg"></p>
<p CLASS="Textttext">If there are no active controls on the form, Microsoft Access also triggers a GotFocus event for the form, after the Activate event, but before the Current event.
<p CLASS="Textttext">When you close a form that contains an active control, Microsoft Access triggers the following sequence of events for the form:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0605.jpg"></p>
<p CLASS="Textttext">If there are no active controls on the form, Microsoft Access triggers a LostFocus event for the form after the Unload event, but before the Deactivate event.</p>
<a NAME="5EnteringandExitingaControl"></a>
<p CLASS="heading5OrgHeading3h3">Entering and Exiting a Control</p>
<p CLASS="Textttext">When you open a form that contains one or more active controls, an Enter event occurs, followed by a GotFocus event, for the control receiving the focus. These events occur after the form's Activate and Current events:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0606.jpg"></p>
<p CLASS="Textttext">Both events occur when a control first receives the focus. If you switch to a different form and then return to the same control on the first form, Microsoft Access triggers a GotFocus event for the control, but not an Enter event.
<p CLASS="Textttext">When you exit a control<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">for example, when you select another control on the same form<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">the following events occur for the control:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0607.jpg"></p>
<a NAME="5SwitchingBetweenOpenForms"></a>
<p CLASS="heading5OrgHeading3h3">Switching Between Open Forms</p>
<p CLASS="Textttext">When you switch between two open forms that contain active controls, Microsoft Access triggers a Deactivate event on the first form and an Activate event on the second form:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0608.jpg"></p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>An Open event doesn't occur on a form that is already open but not activated, whether you switch to the form or run a macro that specifies the form in an OpenForm action. If you want your application to run the code in a form's Open event procedure when the form is already open, you can:</p>
<p CLASS="NoteListBulletedItem1nlb"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspAdd the code to the form's Activate event procedure instead of the Open event procedure, if timing isn't critical. The Activate event occurs both when you open a form and when you make it the active form, so the code is sure to run. </p>
<p CLASS="NoteListBulletedItem1nlb"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspDetermine if the form is open by checking the value returned by the IsLoaded function in the UtilityFunctions module of the Orders sample application. Do this before running the macro that contains the OpenForm action.</p>
<p CLASS="Textttext">If there are no active controls on the forms, Microsoft Access also triggers the LostFocus and GotFocus events:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0609.jpg">
<p CLASS="heading6OrgHeading4h4"><img SRC="../images/example.gif" WIDTH="73" HEIGHT="21"><!--example space-->&nbsp;&nbsp;<a NAME="XSwitchingBetweenControlsonDifferentForms"></a>Switching Between Controls on Different Forms</p>
<p CLASS="Textttext">This example shows the sequence of events that are triggered in a typical scenario while you work with forms and controls.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step One: Open a form&nbsp;&nbsp;&nbsp;</span>Open the form Form1, whose first active control is Control1.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0610.jpg"></p>
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Two: Open a second form&nbsp;&nbsp;&nbsp;</span>Open the form Form2, whose first active control is Control2.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0611.jpg"></p>
<p CLASS="Textttext">There is no Exit(Control1) event, because the object that receives the focus is on a different form.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Three: Return to the first form&nbsp;&nbsp;&nbsp;</span>Click on the first form.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0612.jpg"></p>
<p CLASS="Textttext">Control1 now has the focus. There is no Enter(Control1) event because Control1 had the focus when Form1 was last active.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Four: Click another control on the first form&nbsp;&nbsp;&nbsp;</span>Click a different control, Control3, on the second form.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0613.jpg"></p>
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Five: Click another control on the second form&nbsp;&nbsp;&nbsp;</span>Click a different control, Control4, on the second form.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0614.jpg"></p>
<a NAME="5RespondingtoKeystrokes"></a>
<p CLASS="heading5OrgHeading3h3">Responding to Keystrokes</p>
<p CLASS="Textttext">When you press a key, Microsoft Access triggers the KeyDown, KeyPress, and KeyUp events for the form or control that has the focus. For example, when a control has the focus, you'll normally want the control to receive all keystrokes when changing data in a text box. </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on responding to changes to text and data, see the following section, <a HREF="../chapters/ba06_2.htm#4WorkingwithData" OnClick="SyncURL(&quot;chapters/ba06_2.htm&quot;)">&quot;Working with Data.&quot;</a></p>
<p CLASS="Textttext">In some cases, however, you'll want to respond to specific keys pressed in a form, regardless of which control has the focus. For example, you may want to perform some action whenever the user presses a key combination such as <span CLASS="KeyNamekn">CTRL+Y</span>. You can make sure that the form receives all key events, even those that occur in controls, by setting the <span CLASS="ElementNameeln">KeyPreview</span> property for the form to Yes. With this property setting, all key events occur first for the form, and then for the control that has the focus.
<p CLASS="Textttext">You can respond to specific keys in the form's KeyPress, KeyDown, or KeyUp events. The KeyPress event responds only to the ANSI characters generated by the keyboard. ANSI characters are generated by the following keys and key combinations: any printable keyboard character, <span CLASS="KeyNamekn">CTRL+A </span>through <span CLASS="KeyNamekn">CTRL+Z</span>, <span CLASS="KeyNamekn">ENTER</span>, <span CLASS="KeyNamekn">CTRL+ENTER</span>, <span CLASS="KeyNamekn">BACKSPACE</span>, <span CLASS="KeyNamekn">CTRL+BACKSPACE</span>, and <span CLASS="KeyNamekn">TAB</span>. The KeyPress event ignores all other keystrokes.<span CLASS="KeyNamekn"> </span>In most cases, it is simplest to use only the KeyPress event to respond to keyboard events.
<p CLASS="Textttext">The following sample code demonstrates how to respond to the <span CLASS="KeyNamekn">CTRL+Y</span> key combination in a form by using the KeyPress event. Note that you can prevent the control from getting keystrokes you respond to by setting the KeyAscii variable to zero.</p>
<p CLASS="CodeTextct">Private Sub Form_KeyPress (KeyAscii As Integer)<br>&nbsp;&nbsp;&amp;nbspConst conCtrlYCode = 25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' ANSI character code for CTRL+Y.<br>&nbsp;&nbsp;&amp;nbspIf KeyAscii = conCtrlYCode Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;You pressed Ctrl+Y&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspKeyAscii = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Do not send key on to control.<br>&nbsp;&nbsp;&amp;nbspEnd If<br>End Sub</p>
<p CLASS="Textttext">The KeyDown and KeyUp events work on a lower level by responding to events generated by the keys themselves being pressed and released. Use KeyDown and KeyUp events if you need to respond to keys that don't generate ANSI characters, such as the function keys (<span CLASS="KeyNamekn">F1</span> through F12), or if you need to respond to key combinations that include the <span CLASS="KeyNamekn">SHIFT</span>, ALT, and <span CLASS="KeyNamekn">CTRL</span> keys (except the <span CLASS="KeyNamekn">CTRL</span> key combinations that respond to the KeyPress event).</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on responding to keystrokes by using the KeyDown and KeyUp events, search the Help index for &quot;KeyDown event&quot; and &quot;KeyUp event.&quot;</p>
<a NAME="4WorkingwithData"></a>
<p CLASS="heading4OrgHeading2h2">Working with Data</p>
<p CLASS="Textttext">You can use data events in your application to respond to many types of changes to records and data. For example, the application can run a macro or an event procedure in response to:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspChanges to text in a text box or combo box.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspUpdates to data in a control or record.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspInsertions or deletions of records, either before or after the record is inserted or deleted, or before or after a deletion is confirmed.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Some events do not occur when you use Visual Basic code to manipulate data in your application<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">for example, the Change event, the BeforeInsert event, and the AfterInsert event.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>To see the sequence of events that occurs when you work with data, open the ShowEvents form in the Orders sample application.</p>
<a NAME="5ChangingTextinaTextBoxorComboBox"></a>
<p CLASS="heading5OrgHeading3h3">Changing Text in a Text Box or Combo Box</p>
<p CLASS="Textttext">When you change text in a text box or combo box, a Change event occurs. The event occurs whenever the contents of a control changes, but before you move to a different control or record. For example, when you delete a character in a text box by pressing the <span CLASS="KeyNamekn">DELETE</span> key, Microsoft Access triggers the following sequence of events:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0615.jpg"></p>
<p CLASS="Textttext">If you then type one or more characters in the text box, Microsoft Access recognizes the same sequence of events for each keystroke.
<p CLASS="Textttext">The Change event doesn't occur when a value changes in a calculated control, or when you select an item from a combo box list.</p>
<a NAME="5UpdatingDatainaControlorRecord"></a>
<p CLASS="heading5OrgHeading3h3">Updating Data in a Control or Record</p>
<p CLASS="Textttext">When you update data in a control by moving to a different control on the form, Microsoft Access triggers the BeforeUpdate and AfterUpdate events for the control. The BeforeUpdate event occurs just before the data is updated; the AfterUpdate event occurs after the update.
<p CLASS="Textttext">For example, if you update data in a text box (TB1) by deleting a character, then click a different text box (TB2), Microsoft Access triggers the following sequence of events:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0616.jpg"></p>
<p CLASS="Textttext">If you update a control or record by moving to a different record or by clicking <span CLASS="ElementNameeln">Save Record</span> on the <span CLASS="ElementNameeln">Records</span> menu, the BeforeUpdate and AfterUpdate events for both the control and the form occur. For example, if you delete a character in a text box and then click <span CLASS="ElementNameeln">Save Record</span> on the <span CLASS="ElementNameeln">Records</span> menu, the following sequence of events occurs:</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0617.jpg"></p>
<p CLASS="Textttext">When you update a control or record by moving to a different record, Microsoft Access triggers several events after the BeforeUpdate and AfterUpdate events for the control and form: It triggers Exit and LostFocus events for the control losing the focus, the Current event for the new record, and Enter and GotFocus events for the control receiving the focus.</p>
<a NAME="5InsertingRecords"></a>
<p CLASS="heading5OrgHeading3h3">Inserting Records</p>
<p CLASS="Textttext">When you enter data in a new record by way of the user interface, Microsoft Access triggers a BeforeInsert event when you first enter data in the record, and an AfterInsert event when the record is saved.
<p CLASS="heading6OrgHeading4h4"><img SRC="../images/example.gif" WIDTH="73" HEIGHT="21"><!--example space-->&nbsp;&nbsp;<a NAME="XEnteringDatainaNewRecord"></a>Entering Data in a New Record</p>
<p CLASS="Textttext">This example shows the sequence of events that Microsoft Access triggers in a typical scenario when you enter data in a new record.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step One: Enter text in the first field of a new record&nbsp;&nbsp;&nbsp;</span>After clicking <span CLASS="ElementNameeln">Data Entry</span> on the <span CLASS="ElementNameeln">Records</span> menu of a form to display a blank record, type a character in a text box (TB1).</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0618.jpg"></p>
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Two: Move to another field of the same record and enter text&nbsp;&nbsp;&nbsp;</span>Click another text box (TB2) on the form and type a character.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0619.jpg"></p>
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Three: Save the new record&nbsp;&nbsp;&nbsp;</span>Click <span CLASS="ElementNameeln">Save Record</span> on the <span CLASS="ElementNameeln">Records</span> menu.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0620.jpg"></p>
<a NAME="5DeletingRecords"></a>
<p CLASS="heading5OrgHeading3h3">Deleting Records</p>
<p CLASS="Textttext">When you select a record and delete it (either by pressing the <span CLASS="KeyNamekn">DELETE</span> key or by clicking <span CLASS="ElementNameeln">Delete</span> on the <span CLASS="ElementNameeln">Edit</span> menu), Microsoft Access triggers the Delete event, and then the Current event. If you select multiple records and delete them, the Delete event occurs once for each record that you have selected, and then Microsoft Access triggers the Current event. Unless you cancel the Delete event, Microsoft Access also triggers BeforeDelConfirm and AfterDelConfirm events. You use these events to control how record deletions are confirmed.
<p CLASS="Textttext">For example, when you select a record on a form and delete it, Microsoft Access by default:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspTriggers the following sequence of events:</p>
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0621.jpg"></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspDisplays the following dialog box after the BeforeDelConfirm event.</p>
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0622.jpg">
<p CLASS="Textttext">If you want, you can prevent this dialog box from appearing in two ways. You can cancel the BeforeDelConfirm event, in which case the deletion is canceled. Or you can set the Response argument of the BeforeDelConfirm event procedure to <span CLASS="ElementNameeln">acDataErrContinue</span>, in which case the deletion is confirmed.
<p CLASS="Textttext">After the deletion is confirmed, your BeforeDelConfirm event procedure can display a custom dialog box and handle the user's responses.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba06_3.htm" OnClick="SyncURL(&quot;chapters/ba06_3.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
