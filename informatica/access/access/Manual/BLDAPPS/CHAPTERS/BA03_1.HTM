<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>CHAPTER 3</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba02_5.htm" OnClick="SyncURL(&quot;chapters/ba02_5.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<p CLASS="heading2ChapterNumberAppendixLetterchn">CHAPTER&nbsp; 3</p>
<p CLASS="ChapterAppendixTitlecht">Using Forms to Collect, Filter, and Display Information</p>
<p CLASS="ChapterSummaryTextchsum">Forms that work well with each other make your application easy to use. This chapter presents a variety of techniques you can use to automate your forms and to make individual forms work together as a unified application.</p>
<a NAME="3CustomizingaCommandButtonCreatedwithaWizard"></a>
<p CLASS="heading3OrgHeading1h1">Customizing a Command Button Created with a Wizard</p>
<p CLASS="Textttext">Using the Command Button Wizard is a great way to create most general-purpose command buttons on your forms. However, a command button created with the wizard may not do exactly what you want it to do. Rather than creating a command button from scratch, you can use the Command Button Wizard to create the button and an event procedure for its Click event, and then customize the way the button works by editing the event procedure. For example, you can use the Command Button Wizard to create a button that opens a form, and then you can edit the event procedure so that it opens the form for read-only access instead of for editing data.
<p CLASS="Textttext">The event procedure that the Command Button Wizard creates includes simple Visual Basic statements that perform the action you specify. In addition, the wizard adds a simple method of error handling to respond appropriately to run-time errors. If an error occurs, the error-handling code displays the Microsoft Access error message and then exits the event procedure. The following illustration shows the event procedure the Command Button Wizard creates for a command button that opens a form.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0301.jpg"></p>
<p CLASS="Textttext">To change or enhance the way the button works, you edit the lines of code that are highlighted in the previous illustration. Unless you want to change the way the event procedure handles errors, you don't need to edit any other lines in the procedure.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on error handling in Visual Basic, see Chapter 8, <a HREF="../chapters/ba08_1.htm" OnClick="SyncURL(&quot;chapters/ba08_1.htm&quot;)">&quot;Handling Run-Time Errors.&quot;</a></p>
<!--mstheme--></font><table CELLPADDING="3" BORDER="2" BORDERCOLOR="#0000FF" bordercolordark="#660000" bordercolorlight="#CC9966"><tr BGCOLOR="#FFFFFF"><td><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="SidebarHeadingsbrh">Using Variables to Refer to Object Names</p>
<p CLASS="SidebarTextsbrt">You may have noticed that the Command Button Wizard's event procedure uses a <span CLASS="ElementNameeln">Dim</span> statement to declare a variable that holds the name of the form the event procedure opens. A <span CLASS="NewTermntrm">variable</span> is a placeholder that temporarily stores data, such as the name of an object or the value in a field, while your procedure runs. Once you declare a variable and assign it a value, you can use the variable throughout your procedure to refer to the value.
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">' Creates a variable that can hold a string value.</span></p>
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">Dim strDocName As String</span></p>
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">' Assigns the form name to it.</span></p>
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">strDocName = &quot;ProductsPopup&quot;</span></p>
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">' Opens the ProductsPopup form.</span></p>
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">DoCmd.OpenForm strDocName</span></p>
<p CLASS="SidebarTextsbrt">You don't have to use a variable to open a form. The following line of code performs the exact same action as the previous three lines.
<p CLASS="SidebarTextsbrt"><span CLASS="CodeTextFeaturedElementctfe">DoCmd.OpenForm &quot;ProductsPopup&quot;</span>
<p CLASS="SidebarTextsbrt">If you refer to a form only once in a procedure, it's probably easiest to just use the form name directly, as in the preceding line of code. Use a variable when you want to perform more than one operation on an object. In these cases, using a variable makes your code easier to write and maintain. If you want to change the form that the procedure opens, for example, you just change the form name once in the statement that assigns it to the variable.</p>
<p CLASS="SidebarCrossRefTextsbrcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on creating and using variables, see Chapter 4, <a HREF="../chapters/ba04_1.htm" OnClick="SyncURL(&quot;chapters/ba04_1.htm&quot;)">&quot;Working with Variables, Data Types, and Constants.&quot;</a>
<!--mstheme--></font></td></tr></table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="heading6OrgHeading4h4"><img SRC="../images/example.gif" WIDTH="73" HEIGHT="21"><!--example space-->&nbsp;&nbsp;<a NAME="XCustomizingaCommandButtonThatOpensaForm"></a>Customizing a Command Button That Opens a Form</p>
<p CLASS="Textttext">Customers sometimes ask Northwind sales representatives for further information about a product on their order. You can provide a command button on the Orders form to open a pop-up form that shows details about the product selected in the Orders subform.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0302.jpg"></p>
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step One: Create the button that opens the form&nbsp;&nbsp;&nbsp;</span>The Orders sample application includes a form named ProductsPopup that displays details about Northwind products. You can open the Orders form in Design view and use the Command Button Wizard to add a command button named Details that opens the ProductsPopup form. The Command Button Wizard creates the command button and writes an event procedure for the command button's Click event.
<p CLASS="Textttext">However, the pop-up form displays details about a value on the subform, not the main form. Because the wizard can't filter based on a subform value, you'll need to modify the command button's event procedure yourself so the pop-up form shows information from the correct product.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on creating the ProductsPopup form, see <a HREF="../chapters/ba03_3.htm" OnClick="SyncURL(&quot;chapters/ba03_3.htm&quot;)">&quot;Using Pop-up Forms and Dialog Boxes&quot;</a> later in this chapter.</p>
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Two: Open the event procedure&nbsp;&nbsp;&nbsp;</span>In Design view, right-click the command button and then click <span CLASS="ElementNameeln">Build Event</span> on the shortcut menu. Microsoft Access opens the form module and displays the button's Click event procedure.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Three: Change the code so it filters records&nbsp;&nbsp;&nbsp;</span>You want to filter the records in the ProductsPopup form to show the record whose ProductID is equal to the ProductID of the current record in the Orders subform. To do this, you need to apply a filter to the form when you open it.
<p CLASS="Textttext">The Command Button Wizard automatically creates a variable in the Click event procedure that makes it easy for you to set a filter for the form you're opening. The following line of code sets the strLinkCriteria variable to the appropriate filter string.</p>
<p CLASS="CodeTextct">strLinkCriteria = &quot;ProductID = Forms!Orders!OrdersSubform!ProductID&quot;</p>
<p CLASS="Textttext">Add this line of code to the Click event procedure that opens the form, as shown in the following example:</p>
<p CLASS="CodeTextct">Dim strDocName As String<br>Dim strLinkCriteria As String<br>strDocName = &quot;ProductsPopup&quot;<br>strLinkCriteria = &quot;ProductID = Forms!Orders!OrdersSubform!ProductID&quot;<br>DoCmd.OpenForm strDocName, , , strLinkCriteria</p>
<p CLASS="Textttext">This event procedure passes the filter string you added (strLinkCriteria) as the <span CLASS="NewTermntrm">wherecondition</span> argument of the <span CLASS="ElementNameeln">OpenForm</span> method that opens the form. Microsoft Access then automatically sets a filter on the ProductsPopup form and makes the form display the correct record.
<p CLASS="Textttext">Compile your edited code and test it to make sure it works as expected. Now when you click the command button on the Orders form, the ProductsPopup form opens, showing values in the record for the current product in the Orders subform.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>When the Details_Click event procedure opens the ProductsPopup form, the ProductsPopup form becomes the active form. In addition to the code that opens the ProductsPopup form, the Details_Click event procedure contains code that moves the focus from the pop-up form to the Orders form, so that sales representatives can continue filling out the order without having to click the Orders form. This code uses the <span CLASS="ElementNameeln">SetFocus</span> method, first to set the focus to the Orders form, and then to set the focus to the Orders subform rather than to the Details command button (the last control on the form to have the focus). To see this code, open the Orders form in Design view. Right-click the Details command button, and then click <span CLASS="ElementNameeln">Build Event</span> on the shortcut menu.</p>
<!--mstheme--></font><table CELLPADDING="3" BORDER="2" BORDERCOLOR="#0000FF" bordercolordark="#660000" bordercolorlight="#CC9966"><tr BGCOLOR="#FFFFFF"><td><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="SidebarHeadingsbrh">Keeping Two Forms Synchronized</p>
<p CLASS="SidebarTextsbrt">You can keep the ProductsPopup form synchronized with the Orders form, so that when you move from record to record in the Orders subform, the ProductsPopup form always shows details about the current product in the subform. To do this, write an event procedure for the subform's Current event that sets the pop-up form's <span CLASS="ElementNameeln">Filter</span> property. (You can also do this by writing a macro you specify as the subform's <span CLASS="ElementNameeln">OnCurrent</span> event property setting.)
<p CLASS="SidebarTextsbrt">To see this event procedure in the Orders sample application, look at the Form_Current event procedure for the Orders subform. Open the Orders subform in Design view, and then click <span CLASS="ElementNameeln">Code</span> on the <span CLASS="ElementNameeln">View</span> menu to open its form module. In the <span CLASS="ElementNameeln">Object</span> box, click <span CLASS="ElementNameeln">Form</span>, and then click <span CLASS="ElementNameeln">Current</span> in the <span CLASS="ElementNameeln">Procedure</span> box.</p>
<p CLASS="SidebarCrossRefTextsbrcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on keeping two forms synchronized, see <a HREF="../chapters/ba03_4.htm#XSynchronizingRecordsbyChangingtheFilter" OnClick="SyncURL(&quot;chapters/ba03_4.htm&quot;)">&quot;Synchronizing Records by Changing the Filter&quot;</a> later in this chapter.</p><!--mstheme--></font></td></tr></table><!--mstheme--><font face="book antiqua, times new roman, times">
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba03_2.htm" OnClick="SyncURL(&quot;chapters/ba03_2.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
