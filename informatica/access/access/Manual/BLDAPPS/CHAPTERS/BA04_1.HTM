<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>CHAPTER 4</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta HTTP-EQUIV="keywords" content="Variables: using: in Microsoft Visual Basic code, Declaring: variables, Constants: using in Microsoft Visual Basic code, Data types: using in Microsoft Visual Basic code, Variables: using: to store values, Values: using variables to store, Dim statements: declaring variables with, Variables: supplying names for, Variables: declaring: described, Data types: defining, String data type: described, Integer data type: described, Currency data type: described, Variant data type: described, Deftype statements: changing default data types with, Data types: changing default, Dim statements: As type clause, Case-sensitive: Microsoft Visual Basic variables not, Variables: not case-sensitive, Prefixes indicating data types, Declarations: implicit, Implicit declaration, Declarations: explicit, Option Explicit statements: avoiding misnaming variables with, Variables: avoiding misnaming, Explicit declaration, Require Variable Declaration option: forcing explicit declaration with">
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba03_8.htm" OnClick="SyncURL(&quot;chapters/ba03_8.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<p CLASS="heading2ChapterNumberAppendixLetterchn">CHAPTER&nbsp; 4</p>
<p CLASS="ChapterAppendixTitlecht">Working with Variables, Data Types, and Constants </p>
<p CLASS="ChapterSummaryTextchsum">So far, you've been introduced to the essential components of Visual Basic<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">the modules and procedures that contain your application's Visual Basic code. You've also learned some of the elements of Visual Basic procedures and have seen examples of some of the programming tools you can use to control how your code runs. This chapter takes you one step further, showing you the basics of declaring and using variables, data types, and constants in your Visual Basic code.
<a NAME="3DeclaringVariables"></a>
<p CLASS="heading3OrgHeading1h1">Declaring Variables</p>
<p CLASS="Textttext">As you saw in Chapter 2, <a HREF="../chapters/ba02_1.htm" OnClick="SyncURL(&quot;chapters/ba02_1.htm&quot;)">&quot;Introducing Visual Basic,&quot;</a> you use variables to store values while your Visual Basic code is running. Within a procedure or module, you declare a variable with the <span CLASS="ElementNameeln">Dim</span> statement. The syntax for the <span CLASS="ElementNameeln">Dim</span> statement is:</p>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">Dim</span> <span CLASS="NewTermntrm">variablename</span> [<span CLASS="ElementNameeln">As</span> <span CLASS="NewTermntrm">type</span>]</p>
<p CLASS="Textttext">In the <span CLASS="ElementNameeln">Dim</span> statement, you supply a name for the variable. Like other things you create and name in Visual Basic, variable names:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspMust begin with a letter.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspCan't contain an embedded period or an embedded type-declaration character.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspMust not exceed 255 characters.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspMust be unique within the same scope.</p>
<p CLASS="Textttext">You use the optional <span CLASS="ElementNameeln">As</span> <span CLASS="NewTermntrm">type</span> clause in the <span CLASS="ElementNameeln">Dim</span> statement to define the <span CLASS="NewTermntrm">data type</span> of the variable you're declaring. A data type is a designation of the type of information a variable can store. Examples of data types include <span CLASS="ElementNameeln">String</span>, <span CLASS="ElementNameeln">Integer</span>, and <span CLASS="ElementNameeln">Currency</span>. If you omit the <span CLASS="ElementNameeln">As</span> <span CLASS="NewTermntrm">type</span> clause, Visual Basic makes the variable a <span CLASS="ElementNameeln">Variant</span>, which is the default data type (unless you change the default with the <span CLASS="ElementNameeln">Def</span><span CLASS="NewTermntrm">type</span> statement). Data types, including <span CLASS="ElementNameeln">Variant</span>, are discussed later in this chapter. Variables can also contain objects from Microsoft Access, such as <span CLASS="ElementNameeln">Form</span>, <span CLASS="ElementNameeln">Report</span>, and <span CLASS="ElementNameeln">Control</span> objects, or objects from other applications.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on manipulating objects, see Chapter 5, <a HREF="../chapters/ba05_1.htm" OnClick="SyncURL(&quot;chapters/ba05_1.htm&quot;)">&quot;Working with Objects and Collections.&quot;</a></p>
<p CLASS="Textttext">Visual Basic variables are not case-sensitive; when you specify a variable, you don't need to match the exact uppercase and lowercase letters you used in declaring the variable. Visual Basic automatically changes any explicitly declared variable to the case used in the declaration. An implicitly declared variable is given the same case it had the last time it was used.
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>When you name variables, you may find it useful to include prefixes to indicate each variable's data type. For example, you might name a variable <span CLASS="CodeTextEmbeddedcte">dblTemp</span> to indicate that its data type is <span CLASS="ElementNameeln">Double</span>. This practice makes your code easier to read and helps you avoid type-mismatch errors.</p>
<a NAME="4ImplicitDeclaration"></a>
<p CLASS="heading4OrgHeading2h2">Implicit Declaration</p>
<p CLASS="Textttext">Although it's not recommended, you can use a variable without explicitly declaring it. For example, you could write a function as follows:</p>
<p CLASS="CodeTextct">Function SafeSqr(ByVal dblNum As Double) As Double<br>&nbsp;&nbsp;&amp;nbspdblTemp = Abs(dblNum)<br>&nbsp;&nbsp;&amp;nbspSafeSqr = Sqr(dblTemp)<br>End Function</p>
<p CLASS="Textttext">Here, you haven't declared <span CLASS="CodeTextEmbeddedcte">dblTemp</span> as a variable before you use it in the function. In cases such as this, Visual Basic implicitly creates a variable with that name, so you can use the variable as if you had explicitly declared it. Although implicit declarations are convenient, they can lead to subtle errors in your code if a variable name is misspelled. For example, suppose you wrote the following function:</p>
<p CLASS="CodeTextct">Function SafeSqr(ByVal dblNum As Double) As Double<br>&nbsp;&nbsp;&amp;nbspdblTemp = Abs(dblNum)<br>&nbsp;&nbsp;&amp;nbspSafeSqr = Sqr(dblTmp)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' dblTemp is misspelled.<br>End Function</p>
<p CLASS="Textttext">At first glance, this looks the same as the previous function. But because the <span CLASS="CodeTextEmbeddedcte">dblTemp</span> variable is misspelled, this function always returns zero. When Visual Basic encounters a new variable name, it can't determine if you actually meant to create a new variable or if you just made a mistake typing an existing variable name. Because it assumes you want to create a variable, it creates a new variable named <span CLASS="CodeTextEmbeddedcte">dblTmp</span>.</p>
<a NAME="4ExplicitDeclaration"></a>
<p CLASS="heading4OrgHeading2h2">Explicit Declaration</p>
<p CLASS="Textttext">To avoid the problem of misspelling variable names, specify an <span CLASS="ElementNameeln">Option</span> <span CLASS="ElementNameeln">Explicit</span> statement in the Declarations section of your modules. The <span CLASS="ElementNameeln">Option</span> <span CLASS="ElementNameeln">Explicit</span> statement forces the explicit declaration of all variables in a module. If Visual Basic encounters a name not explicitly declared as a variable, it generates an error message.
<p CLASS="Textttext">If you had specified an <span CLASS="ElementNameeln">Option Explicit</span> statement for the module containing the SafeSqr function shown earlier, Visual Basic would have recognized <span CLASS="CodeTextEmbeddedcte">dblTemp</span> and <span CLASS="CodeTextEmbeddedcte">dblTmp</span> as undeclared variables and would have generated errors for both of them. You would then explicitly declare <span CLASS="CodeTextEmbeddedcte">dblTemp</span>, as shown in the following code:</p>
<p CLASS="CodeTextct">Function SafeSqr(ByVal dblNum As Double) As Double<br>&nbsp;&nbsp;&amp;nbspDim dblTemp As Double<br>&nbsp;&nbsp;&amp;nbspdblTemp = Abs(dblNum)<br>&nbsp;&nbsp;&amp;nbspSafeSqr = Sqr(dblTmp)<br>End Function</p>
<p CLASS="Textttext">Now Microsoft Access would display an error message for the incorrectly spelled <span CLASS="CodeTextEmbeddedcte">dblTmp</span> and the problem would be clear. Because the <span CLASS="ElementNameeln">Option Explicit</span> statement helps you catch these kinds of errors, you should use it with all your code.
<p CLASS="Textttext">You can also force variables to be explicitly declared in any new modules by clicking <span CLASS="ElementNameeln">Options</span> (<span CLASS="ElementNameeln">Tools</span> menu), clicking the <span CLASS="ElementNameeln">Module</span> tab, and then selecting the <span CLASS="ElementNameeln">Require Variable Declaration</span> check box. This automatically inserts the <span CLASS="ElementNameeln">Option Explicit</span> statement in any new modules.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The <span CLASS="ElementNameeln">Option Explicit</span> statement operates on a per-module basis; it must be placed in the Declarations section of every form, report, and standard module for which you want Visual Basic to enforce explicit variable declarations. If you select the <span CLASS="ElementNameeln">Require Variable Declaration </span>check box, Visual Basic inserts the <span CLASS="ElementNameeln">Option Explicit</span> statement in all subsequent form, report, and standard modules, but doesn't add it to existing code. You must manually add the <span CLASS="ElementNameeln">Option Explicit</span> statement to any existing modules within an application.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Option Explicit</span> statement, search the Help index for &quot;Option Explicit statement.&quot;</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba04_2.htm" OnClick="SyncURL(&quot;chapters/ba04_2.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
