<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Working with Objects and Collections</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba05_1.htm" OnClick="SyncURL(&quot;chapters/ba05_1.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3WorkingwithObjectsandCollections"></a>
<p CLASS="heading3OrgHeading1h1">Working with Objects and Collections</p>
<p CLASS="Textttext">Now that you're familiar with the objects available in Microsoft Access, you can begin working with them in Visual Basic. The following sections provide you with the information you need to begin working with objects.</p>
<a NAME="4ReferringtoObjects"></a>
<p CLASS="heading4OrgHeading2h2">Referring to Objects</p>
<p CLASS="Textttext">To use an object in Visual Basic, you must specify which object it is that you intend to use. There are two types of objects with which you need to be concerned: objects that exist individually and don't belong to collections, and objects that belong to collections.
<p CLASS="Textttext">Some objects, such as the Microsoft Access <span CLASS="ElementNameeln">Application </span>object, are not members of a collection. Most of the time you can refer to these objects directly in your code. For example, you refer to the <span CLASS="ElementNameeln">Application </span>object in Visual Basic as follows:</p>
<p CLASS="CodeTextct">Application</p>
<p CLASS="Textttext">Other objects belong to collections, and you need to distinguish which object in the collection you want to work with, and which collection contains the object. For example, the DAO <span CLASS="ElementNameeln">TableDef</span>, <span CLASS="ElementNameeln">QueryDef</span>, <span CLASS="ElementNameeln">Recordset</span>, and <span CLASS="ElementNameeln">Relation </span>objects all have a <span CLASS="ElementNameeln">Fields </span>collection. If you refer to a <span CLASS="ElementNameeln">Field </span>object, you need to specify to which collection it belongs. Also, it's likely that there's more than one <span CLASS="ElementNameeln">Field </span>object in the <span CLASS="ElementNameeln">Fields </span>collection of one of these objects. To refer to a particular <span CLASS="ElementNameeln">Field </span>object, you must provide either its name or its position in the collection.
<p CLASS="Textttext">There are three ways to refer to an object in a collection. The fastest way is to provide the name of the collection followed by the name of the object to which you are referring, as shown in the following examples:</p>
<p CLASS="CodeTextct">Forms!Employees<br>QueryDefs![Current Product List]</p>
<p CLASS="Textttext">Use the<span CLASS="ElementNameeln"> ! </span>operator to separate the name of the collection from the name of the particular object within it. Also, if the name of the object contains spaces, you must enclose it in brackets. Finally, keep in mind that the <span CLASS="ElementNameeln">Forms </span>collection includes only forms that are currently open. If the Employees form isn't open when you run the code in the preceding example, an error occurs. The same is true for the <span CLASS="ElementNameeln">Reports </span>collection.
<p CLASS="Textttext">In most cases, you'll know the name of the object to which you're referring, and you should use this syntax. Occasionally, however, you may not know the name of the object until the procedure is running. In this case, you can use a string variable to represent the name of the object. In the following examples, <span CLASS="CodeTextEmbeddedcte">strFormName</span> and <span CLASS="CodeTextEmbeddedcte">strQueryDefName</span> are string variables that contain the name of a <span CLASS="ElementNameeln">Form</span> object and a <span CLASS="ElementNameeln">QueryDef</span> object.</p>
<p CLASS="CodeTextct">Forms(strFormName)<br>QueryDefs(strQueryDefName)</p>
<p CLASS="Textttext">If the value of <span CLASS="CodeTextEmbeddedcte">strFormName</span> is <span CLASS="CodeTextEmbeddedcte">&quot;Employees&quot;</span> and the value of <span CLASS="CodeTextEmbeddedcte">strQueryDefName</span> is <span CLASS="CodeTextEmbeddedcte">&quot;Current Product Name&quot;</span>, then the previous example is equivalent to the following lines of code:</p>
<p CLASS="CodeTextct">Forms(&quot;Employees&quot;)<br>QueryDefs(&quot;Current Product Name&quot;)</p>
<p CLASS="Textttext">You can also refer to an object in a collection by its index number. Like the elements of an array, each object in a collection has an index number that refers to its position in the collection. The following examples use the index number to refer to a particular object in a collection.</p>
<p CLASS="CodeTextct">Forms(0)<br>QueryDefs(1)</p>
<p CLASS="Textttext">Most collections are indexed beginning with zero. That is, the first object in a collection has an index of 0, the second has an index of 1, and so on. The first line of code in the previous example refers to the first open <span CLASS="ElementNameeln">Form </span>object in the <span CLASS="ElementNameeln">Forms </span>collection. In most cases, <span CLASS="ElementNameeln">Form </span>objects are indexed according to the order in which they were opened.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Some collections, such as the Microsoft Office <span CLASS="ElementNameeln">CommandBars</span> collection, are indexed beginning with 1 rather than 0. To determine how a particular collection is indexed, search the Help index for the name of that collection.</p>
<p CLASS="Textttext">The second line refers to the second <span CLASS="ElementNameeln">QueryDef </span>object in the <span CLASS="ElementNameeln">QueryDefs </span>collection. The <span CLASS="ElementNameeln">QueryDefs </span>collection includes all saved queries in the database, regardless of whether they are open. In most cases, <span CLASS="ElementNameeln">QueryDef </span>objects and other objects are indexed according to the order in which they were created in the database.
<p CLASS="Textttext">When you refer to an object in code in any of these ways, Visual Basic returns an <span CLASS="NewTermntrm">object reference</span>. An object reference points to the place in memory where a particular object exists. When you work with an object in Visual Basic, you're actually working with a reference to that object in memory.</p>
<a NAME="5ReferringtoObjectsinaDefaultCollection"></a>
<p CLASS="heading5OrgHeading3h3">Referring to Objects in a Default Collection</p>
<p CLASS="Textttext">Many objects in Microsoft Access contain one or more collections of lower-level objects, and one of these collections is generally designated as the default collection for that object. For example, a <span CLASS="ElementNameeln">Form</span> object contains a <span CLASS="ElementNameeln">Controls</span> collection, which is the collection you're most likely to use with a <span CLASS="ElementNameeln">Form</span> object. Since the <span CLASS="ElementNameeln">Controls</span> collection is the default collection of a <span CLASS="ElementNameeln">Form</span> object, you can refer to the collection without explicitly specifying its name.
<p CLASS="Textttext">The following line of code returns an object reference to a control called LastName on the Employees form using the default collection.</p>
<p CLASS="CodeTextct">Forms!Employees!LastName</p>
<p CLASS="Textttext">You can also use the full reference to the control, as shown in the following line of code:</p>
<p CLASS="CodeTextct">Forms!Employees.Controls!LastName</p>
<p CLASS="Textttext">The following table lists some objects that have default collections.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Object library</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Object</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Default collection</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><b>Microsoft Access</b></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Form</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Controls</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Report</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Controls</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><b>DAO</b></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Container</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Documents</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Database</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">TableDefs</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">DBEngine</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Workspaces</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Group</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Users</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Index</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Fields</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">QueryDef</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Parameters</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Recordset</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Fields</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Relation</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Fields</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">TableDef</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Fields</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">User</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Groups</span></p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Workspace</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Databases</span></p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<a NAME="4DeclaringandAssigningObjectVariables"></a>
<p CLASS="heading4OrgHeading2h2">Declaring and Assigning Object Variables</p>
<p CLASS="Textttext">The preceding sections have shown how to return a reference to an object in order to work with that object in Visual Basic. It's possible to use an object reference throughout your code each time you need to refer to a particular object. However, your code runs more quickly if you declare an <span CLASS="NewTermntrm">object variable </span>to represent the object instead. An object variable is a variable that represents an object in Visual Basic.
<p CLASS="Textttext">To create an object variable, you first declare it as you would declare any variable, by using a <span CLASS="ElementNameeln">Dim</span>, <span CLASS="ElementNameeln">ReDim</span>, <span CLASS="ElementNameeln">Static</span>, <span CLASS="ElementNameeln">Private</span>, or <span CLASS="ElementNameeln">Public</span> statement. You can declare an object variable as a specific type of object or as the more generic type <span CLASS="ElementNameeln">Object</span>. You can also assign a variable of type <span CLASS="ElementNameeln">Variant </span>to an object. Whenever possible, declare an object variable as a specific type of object, because this makes your code run faster. The following line of code declares an object variable as type <span CLASS="ElementNameeln">Form</span>.</p>
<p CLASS="CodeTextct">Dim frm As Form</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on declaring variables, see Chapter 4, <a HREF="../chapters/ba04_1.htm" OnClick="SyncURL(&quot;chapters/ba04_1.htm&quot;)">&quot;Working with Variables, Data Types, and Constants.&quot;</a></p>
<p CLASS="Textttext">Once you've declared an object variable, you assign an object reference to it. An object reference, as discussed in the previous section, refers to an object in memory. Each time you use an object reference, Visual Basic looks up the object in memory. When you assign the object reference to an object variable, it's stored in that variable so that Visual Basic doesn't have to look it up again. If you need to refer to an object more than once, it's a good idea to create an object variable.
<p CLASS="Textttext">To assign an object reference to an object variable, use the <span CLASS="ElementNameeln">Set </span>statement. The following line of code assigns a reference to the Employees <span CLASS="ElementNameeln">Form </span>object to the object variable declared in the preceding example.</p>
<p CLASS="CodeTextct">Set frm = Forms!Employees</p>
<p CLASS="Textttext">There is a key difference between using the <span CLASS="ElementNameeln">Set</span> statement with an object variable and assigning a value to other types of variables, such as variables of type <span CLASS="ElementNameeln">String </span>or <span CLASS="ElementNameeln">Integer</span>. Ordinary variables store a value. Even if two variables store the same value, they are stored in different locations in memory. Object variables, however, refer to actual physical objects in the database or in memory. An object variable stores a reference to an object, not the actual object itself or a copy of the object. It is this reference to the object that is assigned to the variable when you use the <span CLASS="ElementNameeln">Set</span> statement. You always work with the object reference in your code, never with the object itself.
<p CLASS="Textttext">In the preceding example, <span CLASS="CodeTextEmbeddedcte">Forms!Employees</span> returns a reference to the Employees <span CLASS="ElementNameeln">Form</span> object, and it is this reference that is assigned to the variable <span CLASS="CodeTextEmbeddedcte">frm</span>. You can also say that the variable <span CLASS="CodeTextEmbeddedcte">frm</span> <span CLASS="NewTermntrm">points </span>to the Employees <span CLASS="ElementNameeln">Form</span> object.
<p CLASS="Textttext">One advantage to this system of storing objects is that all variables assigned the same object reference refer to the same object. Therefore, even if an object is changed in some way, all variables that refer to the object reflect the change and represent the same information. You can also point the variable to a different object of the same type by using the <span CLASS="ElementNameeln">Set </span>statement again; you don't necessarily have to create another variable. The variable simply stores an object reference to the new object.</p>
<a NAME="5TheNothingKeyword"></a>
<p CLASS="heading5OrgHeading3h3">The Nothing Keyword</p>
<p CLASS="Textttext">An object variable doesn't require much memory or system resources until you assign it to an object. Once it's pointing to an object, it uses much more. With the <span CLASS="ElementNameeln">Nothing </span>keyword, you can free the memory that's being consumed by an object variable. You use the <span CLASS="ElementNameeln">Nothing </span>keyword with the <span CLASS="ElementNameeln">Set </span>statement to disassociate an object variable from the object to which it's been pointing once you are no longer using it. For example, if you are no longer using an object variable that points to a <span CLASS="ElementNameeln">Form </span>object, you can free that variable as follows:</p>
<p CLASS="CodeTextct">Set frm = Nothing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Where frm is a Form object variable.</p>
<p CLASS="Textttext">When you set an object variable to the <span CLASS="ElementNameeln">Nothing </span>keyword, you are no longer storing a reference to a particular object. The variable still exists, and you can assign another object to it when you need it.</p>
<a NAME="4UsingObjectsandCollectionsinCode"></a>
<p CLASS="heading4OrgHeading2h2">Using Objects and Collections in Code</p>
<p CLASS="Textttext">Once you understand how to refer to objects in Visual Basic and how to create object variables to represent them, you can begin using objects in code. The following sections present concepts that may be useful to you as you begin working with objects and collections.</p>
<a NAME="5NavigatingtheObjectHierarchy"></a>
<p CLASS="heading5OrgHeading3h3">Navigating the Object Hierarchy</p>
<p CLASS="Textttext">As explained earlier in this chapter, in order to work with an object that belongs to a collection, you must refer to that object in its collection. Since objects are related to one another in an object hierarchy, you must also make clear where the object and collection exist in the overall hierarchy. In other words, if the object is a member of a collection, you must qualify the object with the name of its collection. If that collection belongs to another object, you must qualify the collection with the name of that object, and so on.
<p CLASS="Textttext">When you create an object variable and assign an object to it, the information about that object's position within the object hierarchy is stored with the variable. An object variable becomes a sort of shorthand for all the objects preceding the one you want to work with in the object hierarchy.
<p CLASS="Textttext">The following example shows how you can work within the Microsoft Access object hierarchy to access individual objects. The procedure returns a reference to the Employees <span CLASS="ElementNameeln">Form </span>object, which is a member of the <span CLASS="ElementNameeln">Forms</span> collection, and assigns it to an object variable. Then it returns a reference to the LastName <span CLASS="ElementNameeln">Control </span>object, which is a member of the <span CLASS="ElementNameeln">Controls</span> collection of the <span CLASS="ElementNameeln">Form</span> object, and assigns it to an object variable. Finally it uses the <span CLASS="ElementNameeln">ControlType </span>property of the <span CLASS="ElementNameeln">Control </span>object to determine what type of control this is. If the control is a text box, the procedure sets its <span CLASS="ElementNameeln">Locked </span>property to <span CLASS="ElementNameeln">True</span>.</p>
<p CLASS="CodeTextct">Sub LockControl()<br>&nbsp;&nbsp;&amp;nbspDim frm As Form, ctl As Control&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Declare object variables.<br>&nbsp;&nbsp;&amp;nbspSet frm = Forms!Employees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Return reference to Form object.<br>&nbsp;&nbsp;&amp;nbspSet ctl = frm!LastName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Return reference to Control object.<br>&nbsp;&nbsp;&amp;nbspIf ctl.ControlType = acTextBox Then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Check ControlType property.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspctl.Locked = True&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Lock control if it's a text box.<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&amp;nbspSet frm = Nothing<br>End Sub</p>
<p CLASS="Textttext">Although the <span CLASS="ElementNameeln">Forms </span>collection is a member of the Microsoft Access <span CLASS="ElementNameeln">Application </span>object, you don't need to refer to the <span CLASS="ElementNameeln">Application </span>object when you refer to the <span CLASS="ElementNameeln">Forms </span>collection or to other Microsoft Access objects and collections. The <span CLASS="ElementNameeln">Application </span>object is implicitly understood.
<p CLASS="Textttext">You work with objects and collections in the DAO object hierarchy in a similar manner. The next example navigates through the DAO object hierarchy and prints the name of each field in the Employees table.</p>
<p CLASS="CodeTextct">Sub ListTableFields()<br>&nbsp;&nbsp;&nbsp;' Declare object variables.<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database, tdf As TableDef, fld As Field<br>&nbsp;&nbsp;&nbsp;' Return reference to current database.<br>&nbsp;&nbsp;&amp;nbspSet dbs = CurrentDb<br>&nbsp;&nbsp;&nbsp;' Return reference to Employees table.<br>&nbsp;&nbsp;&amp;nbspSet tdf = dbs.TableDefs!Employees<br>&nbsp;&nbsp;&nbsp;' Print out all fields in the table.<br>&nbsp;&nbsp;&amp;nbspFor Each fld In tdf.Fields<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print fld.Name<br>&nbsp;&nbsp;&amp;nbspNext fld<br>&nbsp;&nbsp;&amp;nbspSet dbs = Nothing<br>End Sub</p>
<a NAME="5EnumeratingtheObjectsinaCollection"></a>
<p CLASS="heading5OrgHeading3h3">Enumerating the Objects in a Collection</p>
<p CLASS="Textttext">The previous example shows another concept that's important when working with collections. In order to print out all the fields in the table, the procedure must loop through, or <span CLASS="NewTermntrm">enumerate</span>, all the <span CLASS="ElementNameeln">Field </span>objects in the <span CLASS="ElementNameeln">Fields </span>collection of the <span CLASS="ElementNameeln">TableDef </span>object. You accomplish this by using the <span CLASS="ElementNameeln">For Each...Next </span>statement. You can use the <span CLASS="ElementNameeln">For Each...Next </span>statement to perform the same operation on each member of a collection.
<p CLASS="Textttext">To use the <span CLASS="ElementNameeln">For Each...Next </span>statement, you must first identify which objects you want to enumerate and in which collection they reside. Next, you declare a variable of that type of object. The previous example declares the variable <span CLASS="CodeTextEmbeddedcte">fld</span> as type <span CLASS="ElementNameeln">Field</span>. Within the <span CLASS="ElementNameeln">For Each...Next</span> statement, that variable refers to each object in the <span CLASS="ElementNameeln">Fields </span>collection. By using this variable, you can perform a method or set or return a property on each object in the collection, without knowing how many objects the collection contains.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">For Each...Next </span>statement, search the Help index for &quot;For Each...Next statement.&quot;</p>
<a NAME="5AddingNewDAOObjectstoaCollection"></a>
<p CLASS="heading5OrgHeading3h3">Adding New DAO Objects to a Collection</p>
<p CLASS="Textttext">As stated earlier in this chapter, some DAO objects represent the structure of the database, and others provide a means for you to work with the data stored in the database. Objects that represent the structure of the database are saved with the database. Objects that you use to work with the data in the database generally are not saved, but are created each time you need them.
<p CLASS="Textttext">When you create a new DAO object to be saved with the database, you must append it to the appropriate collection of saved objects. The following example creates a new <span CLASS="ElementNameeln">TableDef </span>object named ArchivedInvoices with a new <span CLASS="ElementNameeln">Field </span>object named OrderID. It appends the new <span CLASS="ElementNameeln">Field </span>object to the <span CLASS="ElementNameeln">Fields </span>collection of the new <span CLASS="ElementNameeln">TableDef </span>object, and it appends the <span CLASS="ElementNameeln">TableDef </span>object to the <span CLASS="ElementNameeln">TableDefs </span>collection of the <span CLASS="ElementNameeln">Database </span>object representing the current database. After you run this code, the new table appears on the <span CLASS="ElementNameeln">Tables</span> tab of the Database window.</p>
<p CLASS="CodeTextct">Sub AddTable()<br>&nbsp;&nbsp;&nbsp;' Declare object variables.<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database, tdf As TableDef, fld As Field<br>&nbsp;&nbsp;&nbsp;' Assign the current database to the database variable.<br>&nbsp;&nbsp;&amp;nbspSet dbs = CurrentDb<br>&nbsp;&nbsp;&nbsp;' Create new table and field, and assign to table and field variables.<br>&nbsp;&nbsp;&amp;nbspSet tdf = dbs.CreateTableDef(&quot;ArchivedInvoices&quot;)<br>&nbsp;&nbsp;&amp;nbspSet fld = tdf.CreateField(&quot;OrderID&quot;, dbLong)<br>&nbsp;&nbsp;&nbsp;' Add field to table's Fields collection.<br>&nbsp;&nbsp;&amp;nbsptdf.Fields.Append fld<br>&nbsp;&nbsp;&nbsp;' Add table to database's TableDefs collection.<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Append tdf<br>&nbsp;&nbsp;&nbsp;' Refresh TableDefs collection.<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Refresh<br>&nbsp;&nbsp;&amp;nbspSet dbs = Nothing<br>End Sub</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The preceding example uses the <span CLASS="ElementNameeln">CurrentDb </span>function to return a reference to the current database, and assigns this reference to an object variable of type <span CLASS="ElementNameeln">Database</span>. Anytime you're writing code to work with the database that's currently open, you should use <span CLASS="ElementNameeln">CurrentDb </span>to return a reference to the current database.</p>
<a NAME="5ThePropertiesCollection"></a>
<p CLASS="heading5OrgHeading3h3">The Properties Collection</p>
<p CLASS="Textttext">DAO objects and Microsoft Access <span CLASS="ElementNameeln">Form</span>, <span CLASS="ElementNameeln">Report</span>, and <span CLASS="ElementNameeln">Control </span>objects all contain a <span CLASS="ElementNameeln">Properties </span>collection. Each <span CLASS="ElementNameeln">Property </span>object in the <span CLASS="ElementNameeln">Properties </span>collection corresponds to a property of the object. You can use an object's <span CLASS="ElementNameeln">Properties </span>collection either to determine which properties apply to a particular object or to return their settings. For example, the following procedure loops through the properties that apply to the <span CLASS="ElementNameeln">Database </span>object, which represents the current database, and to the Employees <span CLASS="ElementNameeln">Form</span> object. The procedure displays the name of each property in the Debug window.</p>
<p CLASS="CodeTextct">Sub DisplayProperties()<br>&nbsp;&nbsp;&nbsp;' Declare variables.<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database, frm As Form, prp As Property<br>&nbsp;&nbsp;&nbsp;' Return reference to current database.<br>&nbsp;&nbsp;&amp;nbspSet dbs = CurrentDb<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Current Database Properties&quot;<br>&nbsp;&nbsp;&nbsp;' Enumerate Properties collection.<br>&nbsp;&nbsp;&amp;nbspFor Each prp In dbs.Properties<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print prp.Name<br>&nbsp;&nbsp;&amp;nbspNext prp<br>&nbsp;&nbsp;&nbsp;' Print blank line.<br>&nbsp;&nbsp;&amp;nbspDebug.Print<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Employees Form Properties&quot;<br>&nbsp;&nbsp;&nbsp;' Open Employees form in Form view.<br>&nbsp;&nbsp;&amp;nbspDoCmd.OpenForm &quot;Employees&quot;, acWindowNormal<br>&nbsp;&nbsp;&nbsp;' Return reference to Employees form.<br>&nbsp;&nbsp;&amp;nbspSet frm = Forms!Employees<br>&nbsp;&nbsp;&nbsp;' Enumerate Properties collection.<br>&nbsp;&nbsp;&amp;nbspFor Each prp In frm.Properties<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print prp.Name<br>&nbsp;&nbsp;&amp;nbspNext prp<br>&nbsp;&nbsp;&amp;nbspSet frm = Nothing<br>&nbsp;&nbsp;&amp;nbspSet dbs = Nothing<br>End Sub</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If you're looping through the <span CLASS="ElementNameeln">Properties </span>collection of a table or query, some properties aren't displayed because they're added to the collection only when they have a value.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Properties </span>collection, search the Help index for &quot;Properties collection.&quot;</p>
<a NAME="5WorkingwithCommandBarObjects"></a>
<p CLASS="heading5OrgHeading3h3">Working with CommandBar Objects</p>
<p CLASS="Textttext">Creating new <span CLASS="ElementNameeln">CommandBar </span>objects is somewhat different from creating other new objects in Microsoft Access. To create a new <span CLASS="ElementNameeln">CommandBar </span>object, you use the <span CLASS="ElementNameeln">Add </span>method of the <span CLASS="ElementNameeln">CommandBars </span>collection. The following example creates a new <span CLASS="ElementNameeln">CommandBar</span> object and adds a button to it:</p>
<p CLASS="CodeTextct">Sub CreateNewCommandBar()<br>&nbsp;&nbsp;&amp;nbspDim cmb As CommandBar, cbc As CommandBarControl<br>&nbsp;&nbsp;&nbsp;' Create new CommandBar object and return reference to it.<br>&nbsp;&nbsp;&amp;nbspSet cmb = CommandBars.Add(&quot;NewCommandBar&quot;, msoBarFloating, msoBarTypeNormal)<br>&nbsp;&nbsp;&nbsp;' Create new CommandBarControl object and return reference to it.<br>&nbsp;&nbsp;&amp;nbspSet cbc = cmb.Controls.Add(msoControlButton)<br>&nbsp;&nbsp;&nbsp;' Set properties of new command bar control.<br>&nbsp;&nbsp;&amp;nbspWith cbc<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Caption = &quot;Button1&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.DescriptionText = &quot;First button in NewCommandBar&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.TooltipText = &quot;Button1&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Visible = True<br>&nbsp;&nbsp;&amp;nbspEnd With<br>&nbsp;&nbsp;&nbsp;' Make command bar visible.<br>&nbsp;&nbsp;&amp;nbspcmb.Visible = True<br>&nbsp;&nbsp;&amp;nbspSet cmb = Nothing<br>End Sub</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>In order to use objects in the Microsoft Office 8.0 object library from Visual Basic, you must first set a <span CLASS="NewTermntrm">reference</span> to the object library. When you set a reference to an object library, you notify Visual Basic that you may want to use the objects in that library. To set a reference to the Microsoft Office 8.0 object library, open a module and click <span CLASS="ElementNameeln">References</span> on the <span CLASS="ElementNameeln">Tools</span> menu. Then select the <span CLASS="ElementNameeln">Microsoft Office 8.0 Object Library </span>check box in the <span CLASS="ElementNameeln">Available References</span> box.</p>
<a NAME="5CreatingNewObjectswithClassModules"></a>
<p CLASS="heading5OrgHeading3h3">Creating New Objects with Class Modules</p>
<p CLASS="Textttext">Every object that you use in Microsoft Access is derived from a unique definition for that object. The definition for an object includes its name, its inherent characteristics, and its properties, methods, and events. The definition for an object is known as a <span CLASS="NewTermntrm">class</span>.
<p CLASS="Textttext">To simplify the concept of a class, you can think of a class as a cookie cutter, and an object as the cookie that it makes. You can create multiple objects from a single class, just as you can make multiple cookies with a single cookie cutter. Each individual object has the same characteristics, just as each cookie has the same shape and pattern.
<p CLASS="Textttext">An individual object can also be referred to as an <span CLASS="NewTermntrm">instance</span> of a class. An instance of a class is like a single cookie cut from the cookie cutter. When you create an instance of a class, you create a new object and return an object reference to it. You then work with the instance by setting its properties and applying its methods.
<p CLASS="Textttext">In addition to the objects provided by Microsoft Access and its associated object libraries, you can define your own custom objects in <span CLASS="NewTermntrm">class modules</span>. A class module is a module that can contain the definition for a new object.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To create a definition for a new object in a class module</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspDefine the purpose for your new object. Think of the object in terms of the methods and properties it should have. For example, calling functions in a dynamic-link library (DLL) is often tricky. You can create an object that has methods that contain those function calls. Then, when you want to call a particular function, you can simply call the method that contains it, rather than calling the complex function.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspCreate a new class module by clicking <span CLASS="ElementNameeln">Class Module</span> on the <span CLASS="ElementNameeln">Insert</span> menu. Choose a name for your class and save the class module with that name.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspAdd procedures to the class module. Any <span CLASS="ElementNameeln">Sub</span> or <span CLASS="ElementNameeln">Function</span> procedures that you define in a class module become custom methods of your new object. Any <span CLASS="ElementNameeln">Property Get</span>, <span CLASS="ElementNameeln">Property Let</span>, or <span CLASS="ElementNameeln">Property Set</span> procedures that you define become custom properties of your new object.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspIf you want certain code to run when an instance of the class is created, add that code to the class's Initialize event procedure. If you want certain code to run when an instance of the class is removed from memory, add it to the class's Terminate event procedure.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on the Initialize and Terminate events, search the Help index for &quot;Initialize event&quot; or &quot;Terminate event.&quot;</span></p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&amp;nbspTest the new class by creating an instance of it and applying its methods and setting its properties. To create an instance of your class, use the <span CLASS="ElementNameeln">New</span> keyword to declare an object variable of type <span CLASS="NewTermntrm">classname</span>, where <span CLASS="NewTermntrm">classname</span> represents the name of your class. The <span CLASS="ElementNameeln">New</span> keyword creates a new instance of the class.</p>
<p CLASS="ListText1lt1">For example, if your class is named NewClass, you can declare a new instance of it as shown in the following line of code:
<p CLASS="ListText1lt1"></p>
<p CLASS="ListCodeText1lct1">Dim obj As New NewClass</p>
<p CLASS="ListText1lt1">If you've defined a method called ListNames within the class module, you can then apply that method as follows:
<p CLASS="ListText1lt1"></p>
<p CLASS="ListCodeText1lct1">Obj.ListNames</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on the <span CLASS="ElementNameeln">New</span> keyword, search the Help index for &quot;New keyword.&quot;
</span>
<p CLASS="ListText1lt1"></p>
<p CLASS="Textttext">You can view the new class and its variables, methods, and properties in the Object Browser, which is available through the <span CLASS="ElementNameeln">View</span> menu. In the <span CLASS="ElementNameeln">Project/Library</span> box, click the name of your project, and then click the name of the class in the <span CLASS="ElementNameeln">Classes</span> box. You can determine the name of your project by checking the value in the <span CLASS="ElementNameeln">Project Name</span> box on the <span CLASS="ElementNameeln">Advanced</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the Object Browser, see <a HREF="../chapters/ba05_4.htm" OnClick="SyncURL(&quot;chapters/ba05_4.htm&quot;)">&quot;Using the Object Browser&quot;</a> later in this chapter. For more information on programming with class modules, search the Help index for &quot;class modules.&quot;</p>
<a NAME="5CreatingMultipleInstancesofFormsandReports"></a>
<p CLASS="heading5OrgHeading3h3">Creating Multiple Instances of Forms and Reports</p>
<p CLASS="Textttext">Form modules and report modules are also class modules. They are identical to the class modules on the <span CLASS="ElementNameeln">Modules</span> tab of the Database window, except that they are associated with forms and reports. Since form and report modules are class modules, you can create one or more instances of a form or report class. This is useful if you want to display more than one instance of a form or report at a time.
<p CLASS="Textttext">When you create a new instance of a form or report class, the new instance has all the properties and methods of a <span CLASS="ElementNameeln">Form</span> or <span CLASS="ElementNameeln">Report</span> object, and its properties are set to the same values as those in the original <span CLASS="ElementNameeln">Form </span>or <span CLASS="ElementNameeln">Report</span> object. Additionally, any procedures that you have written in the form or report class module behave as methods and properties of the new instance.
<p CLASS="Textttext">To create a new instance of a form or report class, you declare a new object variable with the name of the form or report's class module and the <span CLASS="ElementNameeln">New </span>keyword. The name of the class module appears in the title bar of the module. It indicates whether the class is associated with a form or a report and includes the name of the form or report. For example, the class name for an Orders form is Form_Orders. The following line of code creates a new instance of the Orders form:</p>
<p CLASS="CodeTextct">Dim frmInstance As New Form_Orders</p>
<p CLASS="Textttext">By creating multiple instances of a Orders form class, you could show information about one order on one form instance, and information about another order on another form instance. 
<p CLASS="Textttext">When you create an instance of a form class by using the <span CLASS="ElementNameeln">New</span> keyword, it is hidden. To show the form, set the <span CLASS="ElementNameeln">Visible</span> property to <span CLASS="ElementNameeln">True</span>.
<p CLASS="Textttext">You should declare the variable that represents the new instance of a form<span CLASS="ElementNameeln"> </span>class at the module level. If you declare the variable at the procedure level, the variable goes out of scope when the procedure finishes running, and the new instance is removed from memory. The instance exists in memory only as long as the variable to which it is assigned remains in scope.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>When you create a new form or report in Microsoft Access, the form or report doesn't automatically have an associated module. Forms and reports without associated modules load more quickly. If you're working in form or report Design view, Microsoft Access automatically creates the form or report module when you click <span CLASS="ElementNameeln">Code</span> on the <span CLASS="ElementNameeln">View</span> menu. Once you enter code in the module, Microsoft Access saves the module with the form or report.
<p CLASS="NoteTextnt">Whether or not the form or report module exists is determined by the setting of the <span CLASS="ElementNameeln">HasModule </span>property. When a form or report is created, the <span CLASS="ElementNameeln">HasModule </span>property is automatically set to <span CLASS="ElementNameeln">False</span>. When you create a form or report module by clicking <span CLASS="ElementNameeln">Code</span> on the <span CLASS="ElementNameeln">View</span> menu, Microsoft Access sets the <span CLASS="ElementNameeln">HasModule</span> property to <span CLASS="ElementNameeln">True</span>. If you refer to the <span CLASS="ElementNameeln">Module</span> property of a form or report, the <span CLASS="ElementNameeln">HasModule</span> property is also automatically set to <span CLASS="ElementNameeln">True</span>. For more information on the<span CLASS="ElementNameeln"> HasModule </span>property, search the Help index for &quot;HasModule property.&quot;</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba05_3.htm" OnClick="SyncURL(&quot;chapters/ba05_3.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
