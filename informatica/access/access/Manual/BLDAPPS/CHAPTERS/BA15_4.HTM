<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Documenting Your Database</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba15_3.htm" OnClick="SyncURL(&quot;chapters/ba15_3.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3DocumentingYourDatabase"></a>
<p CLASS="heading3OrgHeading1h1">Documenting Your Database</p>
<p CLASS="Textttext">Before you distribute your database to users, you may want to document the objects in your database; the underlying structure, or schema, of your application; and any Data Access Objects (DAO) objects, methods, and properties. This is sometimes called <span CLASS="NewTermntrm">mapping</span> the database. When you have a complete map of your database, it's easier to modify the database and to write applications that manipulate the data.
<p CLASS="Textttext">If you just need information about application objects that appear in the user interface, you can use the Documenter (<span CLASS="ElementNameeln">Tools</span> menu, <span CLASS="ElementNameeln">Analyze</span> submenu) to produce a report on those objects. However, to obtain information about the DAO objects, properties, and methods that can't be manipulated by way of the user interface, you must use Visual Basic.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the Documenter, search the Help index for &quot;Documenter.&quot;</p>
<p CLASS="Textttext">Because DAO objects are organized in a hierarchy of nested containers, you can map the database by walking through the hierarchy with a series of nested <span CLASS="ElementNameeln">For...Each</span> loops. Each element in the collection can be accessed with a statement block with the following syntax:</p>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">For Each</span> <span CLASS="NewTermntrm">object</span> <span CLASS="ElementNameeln">In</span> <span CLASS="Placeholderp">collection</span>
<p CLASS="SyntaxTextsyn">&nbsp;&nbsp;&nbsp;<span CLASS="NewTermntrm">statements</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Map the properties of the <span CLASS="NewTermntrm">object</span>.
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">Next</span> <span CLASS="Placeholderp">object</span></p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on individual properties that are exposed when you map a database, search the Help index for the name of the property.</p>
<p CLASS="Textttext">The following code maps the current database. For brevity, the <span CLASS="ElementNameeln">Attributes</span> property is fully mapped only for each <span CLASS="ElementNameeln">TableDef</span> object. If you want to map attributes of the other objects, simply use the code for the <span CLASS="ElementNameeln">TableDef</span> object attributes as a model and insert the appropriate statements. This example assumes that the user running this code has at least Read Design permission on all tables in the database.</p>
<p CLASS="CodeTextct">Sub MapDatabase()<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database, tdf As TableDef, fld As Field<br>&nbsp;&nbsp;&amp;nbspDim idx As Index, rel As Relation<br>&nbsp;&nbsp;&amp;nbspDim intX As Integer<br>&nbsp;&nbsp;&amp;nbspSet dbs = CurrentDb<br>&nbsp;&nbsp;&nbsp;' Map the Database properties.<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;DATABASE&quot;<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, dbs.Name<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Connect string: &quot;, dbs.Connect<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Transactions supported?: &quot;, dbs.Transactions<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Updatable?: &quot;, dbs.Updatable<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Sort order: &quot;, dbs.CollatingOrder<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Query time-out: &quot;, dbs.QueryTimeout<br>&nbsp;&nbsp;&nbsp;' Map the TableDef objects.<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;TABLEDEFS&quot;<br>&nbsp;&nbsp;&amp;nbspFor Each tdf in dbs.TableDefs<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, tdf.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, tdf.DateCreated,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, tdf.LastUpdated,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf tdf.Updatable = True Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Updatable&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Not Updatable&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Show the TableDef Attributes.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print Hex$(tdf.Attributes)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf (tdf.Attributes And dbSystemObject) &lt;&gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;System object&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf (tdf.Attributes And dbAttachedTable) &lt;&gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Linked table&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf (tdf.Attributes And dbAttachedODBC) &lt;&gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Linked ODBC table&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf (tdf.Attributes And dbAttachExclusive)&lt;&gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Linked table opened in exclusive mode&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Map Fields for each TableDef object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;FIELDS&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspFor Each fld in tdf.Fields<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, fld.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Type: &quot;, fld.Type<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Size: &quot;, fld.Size<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Attribute Bits: &quot;, Hex$(fld.Attributes)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Collating Order: &quot;, fld.CollatingOrder<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Ordinal Position: &quot;, fld.OrdinalPosition<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Source Field: &quot;, fld.SourceField<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Source Table: &quot;, fld.SourceTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Show the Field Attributes here.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print Hex$(fld.Attributes)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf (fld.Attributes And dbSystemObject) &lt;&gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;System Object&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspNext fld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Get the next Field in the TableDef object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Map Indexes for each TableDef object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;INDEXES&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspFor Each idx in tdf.Indexes<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set the Index variable.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspSet idx = tdf.Indexes(intX)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, idx.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Clustered: &quot;, idx.Clustered<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Foreign: &quot;, idx.Foreign<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;IgnoreNulls: &quot;, idx.IgnoreNulls<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Primary: &quot;, idx.Primary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Unique: &quot;, idx.Unique<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Required: &quot;, idx.Required<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Map the Fields of the Index.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspFor Each fld in idx.Fields<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, fld.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspNext fld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Get the next Field in the Index.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspNext idx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Get the next Index in the TableDef object.<br>&nbsp;&nbsp;&amp;nbspNext tdf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Get next TableDef in the Database.<br>&nbsp;&nbsp;&nbsp;' Map the Relation objects.<br>&nbsp;&nbsp;&amp;nbspDebug.Print &quot;RELATIONS&quot;<br>&nbsp;&nbsp;&amp;nbspFor Each rel in dbs.Relations<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, rel.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Attributes: &quot;, rel.Attributes&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Table: &quot;, rel.Table<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;ForeignTable: &quot;, rel.ForeignTable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Map the Fields of the Relation objects.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspFor Each fld in rel.Fields<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;Name: &quot;, fld.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspDebug.Print &quot;ForeignName: &quot;, fld.ForeignName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspNext fld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Get the next Field in the Relation object.<br>&nbsp;&nbsp;&amp;nbspNext rel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Get next Relation object in the Database.<br>End Sub</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba15_5.htm" OnClick="SyncURL(&quot;chapters/ba15_5.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
