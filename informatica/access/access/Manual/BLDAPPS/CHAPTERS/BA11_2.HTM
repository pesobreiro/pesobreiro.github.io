<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Using Automation</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba11_1.htm" OnClick="SyncURL(&quot;chapters/ba11_1.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3UsingAutomation"></a>
<p CLASS="heading3OrgHeading1h1">Using Automation</p>
<p CLASS="Textttext">Using Automation, you can integrate two or more components in a way that appears seamless to the user. Working with objects through Automation is very similar to working with objects in the component itself<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">you set and retrieve the object's properties and apply its methods.
<p CLASS="Textttext">When you perform an Automation operation, there are always two components involved. One component contains the objects you want to use. The other component is the one in which you are currently working, and from which you want to control those objects. Many components, including Microsoft Access, can act as either type of component. Some components can act as one or the other, but not both.
<p CLASS="Textttext">For example, if you are working in Microsoft Access, you can create a Microsoft Word document through Automation if Microsoft Word 97 is installed on your computer. On the other hand, if you are working in Microsoft Word, you can use Automation to start Microsoft Access so that you can create a new database or retrieve information from an existing database.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Microsoft Word 97 is the first version of Microsoft Word that supports Automation.</p>
<p CLASS="Textttext">To use Automation in Microsoft Access, perform these steps, which are explained in greater detail in the sections that follow:</p>
<p CLASS="ListSequentialItem1ls">1.&nbsp;&amp;nbspSet a reference to the component's object library.</p>
<p CLASS="ListSequentialItem1ls">2.&nbsp;&amp;nbspCreate an instance of a class that defines an object in that object library and assign it to an object variable.</p>
<p CLASS="ListSequentialItem1ls">3.&nbsp;&amp;nbspWork with the new object by setting its properties and applying its methods.</p>
<p CLASS="ListSequentialItem1ls">4.&nbsp;&amp;nbspClose the object by using its <span CLASS="ElementNameeln">Quit </span>or <span CLASS="ElementNameeln">Close </span>method, or use the <span CLASS="ElementNameeln">Nothing</span> keyword to free the memory it has been using.</p>
<a NAME="4SettingaReferencetoanObjectLibrary"></a>
<p CLASS="heading4OrgHeading2h2">Setting a Reference to an Object Library</p>
<p CLASS="Textttext">Any component that supports Automation supplies information about its objects in an object library. The object library contains <span CLASS="NewTermntrm">classes </span>that define individual objects. An object's class includes its name and information about its properties and methods<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">the information you need to know about the object in order to use it through Automation.
<p CLASS="Textttext">Before you use another component's objects in Visual Basic, you should set a reference to that component's object library. Once you set a reference to an object library, Visual Basic recognizes the objects in that object library. You can then view those objects and their properties and methods in the Object Browser, which is available through the <span CLASS="ElementNameeln">View</span> menu when you have a module open.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To set a reference to a component's object library</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOpen a new or existing module.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">Tools</span> menu, click <span CLASS="ElementNameeln">References</span>.</p>
<p CLASS="ListText1lt1">Microsoft Access displays the <span CLASS="ElementNameeln">References</span> dialog box.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Available References</span> box, select the check box next to the object library that you want to reference.</p>
<p CLASS="ListText1lt1">If a component's object library doesn't appear in the list, click <span CLASS="ElementNameeln">Browse</span> to locate the object library yourself. Often object library files end with .olb or .tlb file name extensions.
<p CLASS="ListText1lt1"></p>
<p CLASS="Textttext">For example, to see what objects are available in Microsoft Word, set a reference to the Microsoft Word 8.0 Object Library from Microsoft Access. Then open the Object Browser and click <span CLASS="ElementNameeln">Word</span> in the <span CLASS="ElementNameeln">Project/Library</span> box. The <span CLASS="ElementNameeln">Classes</span> box now lists all of the objects in the Microsoft Word object model.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the Object Browser, see <a HREF="../chapters/ba05_4.htm" OnClick="SyncURL(&quot;chapters/ba05_4.htm&quot;)">&quot;Using the Object Browser&quot;</a> in Chapter 5, &quot;Working with Objects and Collections.&quot; For more information on setting references to object libraries, see <a HREF="../chapters/ba12_1.htm#4ReferencingLibraryDatabases" OnClick="SyncURL(&quot;chapters/ba12_1.htm&quot;)">&quot;Referencing Library Databases&quot;</a> in Chapter 12, &quot;Using Library Databases and Dynamic-Link Libraries.&quot;</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>You can also set references in Visual Basic. For more information on setting references in code, search the Help index for &quot;Reference object&quot; or &quot;References collection.&quot;</p>
<a NAME="5BindingObjectVariables"></a>
<p CLASS="heading5OrgHeading3h3">Binding Object Variables</p>
<p CLASS="Textttext">You can use a component's objects without setting a reference to that component's object library. However, your code runs much faster if you do set a reference. Setting a reference affects when your code is bound. <span CLASS="NewTermntrm">Binding </span>is the process by which Visual Basic determines what type of object an object variable refers to. There are two types of binding: early binding and late binding.
<p CLASS="Textttext">If you haven't set a reference to the object library, you must declare any object variables that point to the component's objects as type <span CLASS="ElementNameeln">Object</span>. When you declare an object variable as type <span CLASS="ElementNameeln">Object</span>, your code is late-bound. With late binding, Visual Basic has to determine at run time what type of object it is that you want to use; this process slows down your code.
<p CLASS="Textttext">Once you've set a reference to an object library, you can declare object variables according to their specific types. When you declare an object variable as a specific object type, your code is early-bound. Early-bound code runs faster than late-bound code because with early binding, Visual Basic determines what kind of object to create when you compile your code<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">before you run it.
<p CLASS="Textttext">For example, if you are using Microsoft Excel's objects through Automation, you can set a reference to the Microsoft Excel object library and then declare an object variable that points to a <span CLASS="ElementNameeln">Workbook </span>object as type <span CLASS="ElementNameeln">Workbook</span>. This code is early-bound.</p>
<p CLASS="CodeTextct">Dim wbk As Excel.Workbook</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>You can also declare the object variable in the previous example by using the <span CLASS="ElementNameeln">New </span>keyword. For more information on the <span CLASS="ElementNameeln">New</span> keyword, see <a HREF="../chapters/ba11_2.htm#5CreatingaNewInstancewiththeNewKeyword" OnClick="SyncURL(&quot;chapters/ba11_2.htm&quot;)">&quot;Creating a New Instance with the New Keyword&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">Alternatively, if you declared the variable as type <span CLASS="ElementNameeln">Object</span>, the code would be late-bound. This is true whether or not you've set a reference to the Microsoft Excel object library.</p>
<p CLASS="CodeTextct">Dim wbk As Object</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on object libraries, see Chapter 5, <a HREF="../chapters/ba05_1.htm" OnClick="SyncURL(&quot;chapters/ba05_1.htm&quot;)">&quot;Working with Objects and Collections.&quot;</a> For more information on setting references, search the Help index for &quot;setting references.&quot;</p>
<a NAME="4CreatinganInstanceofaClass"></a>
<p CLASS="heading4OrgHeading2h2">Creating an Instance of a Class</p>
<p CLASS="Textttext">Once you set a reference to a component's object library, you can begin using that component's objects in Visual Basic. To create an object to use in Automation operations, you create an instance of that object's class and assign the instance to an object variable. The object variable then points to the new object in memory. Note that when you create a new instance of a class, you are simply creating an object defined by that class.
<p CLASS="Textttext">You can't immediately use any object in the component's object model, however. When you begin an Automation operation, the operating system has to start the component and return a reference to it. There are only a few objects in each object hierarchy that the operating system itself recognizes. Objects that the operating system recognizes are <span CLASS="NewTermntrm">registered </span>with the operating system. When you begin an Automation operation, you must begin with a registered object.
<p CLASS="Textttext">Most components that are also applications have an <span CLASS="ElementNameeln">Application </span>object at the top of their object hierarchy which represents the component and contains all other objects and collections. The <span CLASS="ElementNameeln">Application </span>object is always recognized by the operating system. When you create a new instance of a component's <span CLASS="ElementNameeln">Application </span>class, the operating system starts the component. You can then access all of the other objects in the component's object model through the <span CLASS="ElementNameeln">Application </span>object.
<p CLASS="Textttext">Some components register a few other objects with the operating system as well. For example, Microsoft Excel registers a <span CLASS="ElementNameeln">Workbook</span> object in addition to its <span CLASS="ElementNameeln">Application </span>object. You can create a new <span CLASS="ElementNameeln">Workbook </span>object directly, without going through the <span CLASS="ElementNameeln">Application </span>object.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on which objects can be created directly through Automation, see the component's documentation.</p>
<p CLASS="Textttext">The different ways to create a new instance of an object's class are described in the following sections.</p>
<a NAME="5CreatingaNewInstancewiththeNewKeyword"></a>
<p CLASS="heading5OrgHeading3h3">Creating a New Instance with the New Keyword</p>
<p CLASS="Textttext">The simplest way to create a new object is to declare an object variable by using the <span CLASS="ElementNameeln">New </span>keyword. When you use the <span CLASS="ElementNameeln">New </span>keyword, Visual Basic creates a new instance of an object's class, returns a reference to that instance, and assigns the reference to the object variable being declared.
<p CLASS="Textttext">For example, the following line of code creates a new instance of the Microsoft Excel <span CLASS="ElementNameeln">Application </span>class, returns a reference to that instance, and assigns it to an object variable.</p>
<p CLASS="CodeTextct">Dim appXL As New Excel.Application</p>
<p CLASS="Textttext">You can use the <span CLASS="ElementNameeln">New </span>keyword syntax only if you have set a reference to the object library supplied by the component. For example, you must set a reference to the Microsoft Excel object library before you can create a new instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class and assign it to an object variable. Variables declared with the <span CLASS="ElementNameeln">New </span>keyword are always early-bound.
<p CLASS="Textttext">Note in the preceding example that the <span CLASS="ElementNameeln">Application </span>object is qualified so that Visual Basic knows to create the Microsoft Excel <span CLASS="ElementNameeln">Application </span>class. If you were to omit this qualification, Visual Basic would create a new instance of the Microsoft Access <span CLASS="ElementNameeln">Application </span>class, because you're working within Microsoft Access. You can qualify an object with the name of the component that supplies the object library, as long as you've set a reference to that object library. To determine the name of the component, open the Object Browser and look in the <span CLASS="ElementNameeln">Project/Library</span> box. In the preceding example, the name of the component is Excel.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>It's a good idea to make a habit of qualifying all objects used in Automation operations, because objects in different object libraries may have the same names. If you qualify your objects as you write Automation code, you can be assured that your code will continue to run properly in the presence of new object libraries that may be introduced in the future.</p>
<p CLASS="Textttext">If you want to use Microsoft Access objects from another component, such as Microsoft Excel, you can use the <span CLASS="ElementNameeln">New </span>keyword to create a new instance of the Microsoft Access <span CLASS="ElementNameeln">Application </span>class. For example:</p>
<p CLASS="CodeTextct">Dim appAccess As New Access.Application</p>
<p CLASS="Textttext">Each time you use the <span CLASS="ElementNameeln">New </span>keyword to create a new instance of a component's <span CLASS="ElementNameeln">Application </span>class, Visual Basic starts the component. If the component is already running and you don't want to start another instance, you should use the <span CLASS="ElementNameeln">GetObject </span>function.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">GetObject </span>function, see <a HREF="../chapters/ba11_2.htm#5GettinganExistingInstancewiththeGetObjectFunction" OnClick="SyncURL(&quot;chapters/ba11_2.htm&quot;)">&quot;Getting an Existing Instance with the GetObject Function&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">A component that supports the <span CLASS="ElementNameeln">New </span>keyword syntax must have an object library, but not all components with object libraries also support the <span CLASS="ElementNameeln">New </span>keyword syntax. Check the component's documentation to determine whether it supports the <span CLASS="ElementNameeln">New </span>keyword syntax. For components that don't support the <span CLASS="ElementNameeln">New </span>keyword syntax, you can use the <span CLASS="ElementNameeln">CreateObject </span>function to return a new instance of an object's class.</p>
<a NAME="5CreatingaNewInstancewiththeCreateObjectFunction"></a>
<p CLASS="heading5OrgHeading3h3">Creating a New Instance with the CreateObject Function</p>
<p CLASS="Textttext">The <span CLASS="ElementNameeln">CreateObject</span> function creates a new instance of a class and returns a reference to that instance. The <span CLASS="ElementNameeln">CreateObject </span>function is most useful for working with components that don't support the <span CLASS="ElementNameeln">New </span>keyword syntax, although you can also use it with components that do support the <span CLASS="ElementNameeln">New </span>keyword.
<p CLASS="Textttext">Use the <span CLASS="ElementNameeln">Set </span>statement to assign the reference returned by the<span CLASS="ElementNameeln"> CreateObject </span>function to an object variable. The syntax for the <span CLASS="ElementNameeln">CreateObject </span>function is:</p>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">Set </span><span CLASS="NewTermntrm">objectvariable </span>= <span CLASS="ElementNameeln">CreateObject(</span><span CLASS="NewTermntrm">class</span><span CLASS="ElementNameeln">)</span></p>
<p CLASS="Textttext">In this syntax, <span CLASS="NewTermntrm">objectvariable </span>is an object variable of the type of object you want to create. For example, Microsoft Office Binder supplies an object library but doesn't support the <span CLASS="ElementNameeln">New </span>keyword. To work with an instance of Microsoft Office Binder, you would first declare an object variable of type <span CLASS="ElementNameeln">Binder</span>, qualifying it with the name of the object library, as follows:</p>
<p CLASS="CodeTextct">Dim bnd As OfficeBinder.Binder</p>
<p CLASS="Textttext">In order for this example to work, you must have Microsoft Office Binder installed on your computer, and you must set a reference to the Microsoft Office Binder object library.
<p CLASS="Textttext">As discussed earlier, declaring the object variable as a specific object type makes your code early-bound. If you declare the object variable as type <span CLASS="ElementNameeln">Object</span>, your code is late-bound.
<p CLASS="Textttext">The <span CLASS="NewTermntrm">class </span>argument specifies which component creates the object and what type of object it is, and takes the form <span CLASS="NewTermntrm">appname.objecttype</span>. To determine what the class argument should be, consult the component's documentation. In the following example, <span CLASS="NewTermntrm">appname </span>is Office and <span CLASS="NewTermntrm">objecttype </span>is Binder.</p>
<p CLASS="CodeTextct">Set bnd = CreateObject(&quot;Office.Binder&quot;)</p>
<p CLASS="Textttext">The following example creates a new binder and adds a new Microsoft Word document and a new Microsoft Excel document.</p>
<p CLASS="CodeTextct">Sub CreateNewBinder()<br>&nbsp;&nbsp;&nbsp;' Declare variable of type Binder.<br>&nbsp;&nbsp;&amp;nbspDim bnd As OfficeBinder.Binder<br>&nbsp;&nbsp;&nbsp;' Create new instance and assign to variable.<br>&nbsp;&nbsp;&amp;nbspSet bnd = CreateObject(&quot;Office.Binder&quot;)<br>&nbsp;&nbsp;&nbsp;' Add new Microsoft Word document.<br>&nbsp;&nbsp;&amp;nbspbnd.Sections.Add(&quot;Word.Document&quot;)<br>&nbsp;&nbsp;&nbsp;' Add new Microsoft Excel workbook.<br>&nbsp;&nbsp;&amp;nbspbnd.Sections.Add(&quot;Excel.Sheet&quot;)<br>&nbsp;&nbsp;&nbsp;' Save binder.<br>&nbsp;&nbsp;&amp;nbspbnd.SaveAs FileName:= &quot;NewBinder.obd&quot;<br>&nbsp;&nbsp;&nbsp;' Free memory.<br>&nbsp;&nbsp;&amp;nbspSet bnd = Nothing<br>End Sub</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If you have more than one version of a component on your computer, you can specify the version number of the component that you want to use for an Automation operation. The following example creates a new instance of the Microsoft Excel version 7.0 <span CLASS="ElementNameeln">Application</span> class.</p>
<p CLASS="NoteCodeTextnct">Dim appXL As Excel.Application<br>Set appXL = CreateObject(&quot;Excel.Application.7&quot;)</p>
<p CLASS="NoteTextnt">The version number for most applications included in Microsoft Office 95 is 7.0, while those in Microsoft Office 97 are version 8.0. For example, Microsoft Excel 95 is version 7.0, and Microsoft Excel 97 is version 8.0.</p>
<a NAME="5GettinganExistingInstancewiththeGetObjectFunction"></a>
<p CLASS="heading5OrgHeading3h3">Getting an Existing Instance with the GetObject Function</p>
<p CLASS="Textttext">You can use the <span CLASS="ElementNameeln">GetObject</span> function to return a reference to an existing instance of a class in order to use that instance for an Automation operation. The <span CLASS="ElementNameeln">GetObject</span> function is useful when an instance of a component's <span CLASS="ElementNameeln">Application</span> class already exists in memory, and you don't want to create another instance. Use the <span CLASS="ElementNameeln">Set</span> statement to assign the reference returned by the <span CLASS="ElementNameeln">GetObject</span> function to an object variable.
 The syntax for the <span CLASS="ElementNameeln">GetObject</span> function is:</p>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">Set</span> <span CLASS="NewTermntrm">objectvariable</span> <span CLASS="ElementNameeln">=</span> <span CLASS="ElementNameeln">GetObject(</span>[<span CLASS="NewTermntrm">pathname</span>][, <span CLASS="NewTermntrm">class</span>]<span CLASS="ElementNameeln">)</span></p>
<p CLASS="Textttext">As with the <span CLASS="ElementNameeln">CreateObject</span> function, <span CLASS="NewTermntrm">objectvariable </span>is an object variable of the type of object you want to work with. For example, if you want to work with an instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class, first declare an object variable of type <span CLASS="ElementNameeln">Excel.Application</span>, and then use this variable with the <span CLASS="ElementNameeln">Set</span> statement and the <span CLASS="ElementNameeln">GetObject</span> function, as follows:</p>
<p CLASS="CodeTextct">Dim appXL As Excel.Application<br>Set appXL = GetObject(, &quot;Excel.Application&quot;)</p>
<p CLASS="Textttext">The optional <span CLASS="NewTermntrm">pathname</span> argument specifies the fully qualified path to an existing file. Use this argument if you want to work with an object in a specific file. The <span CLASS="NewTermntrm">class </span>argument specifies which component creates the object and what type of object it is, and takes the form <span CLASS="NewTermntrm">appname.objecttype</span>. In the previous example, <span CLASS="NewTermntrm">appname </span>is Excel and <span CLASS="NewTermntrm">objecttype </span>is Application.
<p CLASS="Textttext">The following table provides a list of <span CLASS="NewTermntrm">class </span>arguments for some Microsoft components.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Component</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth"><span CLASS="NewTermntrm">class </span>argument</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth"> Object returned</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Access</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="CodeTableTextEmbeddedctt">Access.Application</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Access <span CLASS="ElementNameeln">Application </span>object</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Excel</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="CodeTableTextEmbeddedctt">Excel.Application</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Excel <span CLASS="ElementNameeln">Application </span>object</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="CodeTableTextEmbeddedctt">Excel.Sheet</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Excel <span CLASS="ElementNameeln">Workbook </span>object</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
</font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="CodeTableTextEmbeddedctt">Excel.Chart</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Excel <span CLASS="ElementNameeln">Chart </span>object</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Word</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="CodeTableTextEmbeddedctt">Word.Application</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Word <span CLASS="ElementNameeln">Application </span>object</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>To determine the <span CLASS="NewTermntrm">class </span>argument for a component not in this list, consult the component's documentation.</p>
<p CLASS="Textttext">You must specify either the <span CLASS="NewTermntrm">pathname </span>or the <span CLASS="NewTermntrm">class </span>argument, or both. If you specify a zero-length string (&quot;&quot;) for the <span CLASS="NewTermntrm">pathname</span> argument, the <span CLASS="ElementNameeln">GetObject </span>function creates a new instance of the component's <span CLASS="ElementNameeln">Application</span> class specified by the <span CLASS="NewTermntrm">class</span> argument.
<p CLASS="Textttext">You will get different results depending on which arguments you use with the <span CLASS="ElementNameeln">GetObject </span>function. The examples in the following table show different uses of the <span CLASS="ElementNameeln">GetObject </span>function with Microsoft Excel.</p>
<!--mstheme--></font><table WIDTH="160%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">GetObject function example</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Result</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableCodeTexttct">Dim appXL As Excel.Application<br>Set appXL = GetObject(, &quot;Excel.Application&quot;)</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Returns a reference to an existing instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class. Generates an error if Microsoft Excel is not already running.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableCodeTexttct">Dim appXL As Excel.Application<br>Set appXL = GetObject(&quot;&quot;, &quot;Excel.Application&quot;)</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Creates a hidden instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class and returns a reference to that instance.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableCodeTexttct">Dim wbk As Excel.Workbook<br>Set wbk = GetObject(&quot;&quot;, &quot;Excel.Sheet&quot;)</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Creates a hidden instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class and returns a reference to a <span CLASS="ElementNameeln">Workbook</span> object.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableCodeTexttct">Dim wbk As Excel.Workbook<br>Set wbk = GetObject(, &quot;Excel.Sheet&quot;)</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Generates an error whether or not Microsoft Excel is running.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableCodeTexttct">Dim wbk As Excel.Workbook<br>Set wbk = GetObject(&quot;C:\My Documents\Revenue.xls&quot;)</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Creates a hidden instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class and returns a reference to the <span CLASS="ElementNameeln">Workbook</span> object representing Revenue.xls.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="Textttext">If a component saves documents to disk as files, you can use the <span CLASS="ElementNameeln">GetObject</span> function to return a reference to an object in a specific document. For example, you can use the <span CLASS="ElementNameeln">GetObject </span>function to return a reference to a specific Microsoft Excel <span CLASS="ElementNameeln">Workbook</span> object, as shown in the last entry of the preceding table.
<p CLASS="Textttext">This can be useful if a user has more than one instance of a component running at one time and you need to return a particular instance. For example, suppose your code has already opened the Microsoft Excel workbook Revenue.xls. If there's another instance of Microsoft Excel open at the same time, the <span CLASS="ElementNameeln">GetObject</span> function may return either one. If you specifically need a reference to Revenue.xls, then you can specify the path and file name as an argument to the <span CLASS="ElementNameeln">GetObject</span> function.
<p CLASS="Textttext">The following example creates an instance of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> class and returns a reference to the <span CLASS="ElementNameeln">Workbook</span> object that represents the file Revenue.xls. The instance of Microsoft Excel is invisible to the user.</p>
<p CLASS="CodeTextct">Dim wbk As Excel.Workbook<br>Set wbk = GetObject(&quot;C:\My Documents\Revenue.xls&quot;, &quot;Excel.Sheet&quot;)</p>
<p CLASS="Textttext">In the preceding example, the <span CLASS="NewTermntrm">class </span>argument, <span CLASS="CodeTextEmbeddedcte">&quot;Excel.Sheet&quot;</span>, is optional. If you omit this argument, the operating system still knows what type of object to create because you've specified a particular file name. However, if you have more than one version of the component on your computer, you should specify the <span CLASS="NewTermntrm">class </span>argument with the component's version number so that the correct version is used.</p>
<a NAME="4WorkingwithObjectsThroughAutomation"></a>
<p CLASS="heading4OrgHeading2h2">Working with Objects Through Automation</p>
<p CLASS="Textttext">Once you've created a new object and returned a reference to it, you can work with the object in Visual Basic in the same way you would work with any other object. That is, you can set and retrieve the object's properties and apply its methods.
<p CLASS="Textttext">Automation is useful when you're writing code within a component that doesn't provide some functionality you need, but you have another component that does provide that functionality. If both components support Automation, you can use the second component's objects, properties, and methods from the first component.
<p CLASS="Textttext">For example, Microsoft Access doesn't have a built-in means to determine the median of a set of numbers. You can write your own procedure to find the median value, but using Automation to access the <span CLASS="ElementNameeln">Median</span> method of the Microsoft Excel <span CLASS="ElementNameeln">Application</span> object is easier. The following procedure uses the Microsoft Excel <span CLASS="ElementNameeln">Median</span> method to determine the median for a set of data passed as an array.</p>
<p CLASS="CodeTextct">Function GetMedian(avarItemArray As Variant) As Variant<br>&nbsp;&nbsp;&nbsp;' Create new instance of Microsoft Excel Application class.<br>&nbsp;&nbsp;&amp;nbspDim appXL As New Excel.Application<br>&nbsp;&nbsp;&nbsp;' Pass array to Microsoft Excel's Median function.<br>&nbsp;&nbsp;&amp;nbspGetMedian = appXL.Application.Median(avarItemArray)<br>&nbsp;&nbsp;&nbsp;' Close Excel.<br>&nbsp;&nbsp;&amp;nbspappXL.Quit<br>End Function</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The Microsoft Excel <span CLASS="ElementNameeln">Median</span> method is also a function in Microsoft Excel. The method and the function are identical, but the method is used with the <span CLASS="ElementNameeln">Application</span> object, while the function stands by itself. Functions that belong to a component are often available as methods of an object.</p>
<a NAME="5AnticipatingMessagesinAutomationCode"></a>
<p CLASS="heading5OrgHeading3h3">Anticipating Messages in Automation Code</p>
<p CLASS="Textttext">When you write Automation code, you should avoid actions that cause a component to display a dialog box, such as a message box. Once a dialog box is open, the code stops running until the user closes the dialog box. If the component isn't visible to the user, the user won't be able to close the dialog box. The best solution is to avoid writing code that displays a dialog box.
<p CLASS="Textttext">Some components post warning messages to the user before certain operations take place. For example, Microsoft Access warns the user before deleting a record in a table. When a component posts a warning message, execution halts until the user closes the warning message.
<p CLASS="Textttext">The posted warning message presents problems if the component isn't visible to the user or if the user doesn't know what to do when the warning is posted. In some components, you can solve this problem in part by turning off all messages posted by the component. For example, in Microsoft Access you can use the <span CLASS="ElementNameeln">SetWarnings</span> method of the <span CLASS="ElementNameeln">DoCmd</span> object to turn off messages. This method turns off all messages except error messages. To determine whether a particular component offers a similar method, check the component's documentation.</p>
<a NAME="5HandlingErrorsinAutomationCode"></a>
<p CLASS="heading5OrgHeading3h3">Handling Errors in Automation Code</p>
<p CLASS="Textttext">You must also carefully consider any errors that may occur when your Automation code is running and try to prevent them. For example, if a user must input a value that lies within a certain range, try to write the procedure so that it tests the value without generating an error. If an error does occur, Visual Basic posts an error message and halts the running code, unless you've included error-handling routines. By using an error-handling routine, you can prevent the error message from being displayed and correct the error. However, depending on the error, an error-handling routine can sometimes generate unpredictable results. If possible, it's best to avoid generating an error in the first place.
<p CLASS="Textttext">When necessary, you can write error-handling routines to handle errors. However, you should try to avoid writing code that deliberately generates errors that you then handle with error-handling routines. For example, if you are creating a new <span CLASS="ElementNameeln">TableDef</span> object in code, you may typically assume that no other object exists with the same name, and write an error-handling routine to handle the case in which the name given to the new object is not unique. In most situations this is acceptable coding practice, but you may get unpredictable results during Automation operations. Rather than generating an error, you should test to determine whether the object exists before you try to create it. Once you've created an application that calls Automation code, you should test the application thoroughly.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on error handling, see Chapter 8, <a HREF="../chapters/ba08_1.htm" OnClick="SyncURL(&quot;chapters/ba08_1.htm&quot;)">&quot;Handling Run-Time Errors.&quot;</a></p>
<a NAME="4ClosinganObject"></a>
<p CLASS="heading4OrgHeading2h2">Closing an Object</p>
<p CLASS="Textttext">Objects use memory and system resources while they're active. When you've finished working with an object, you should close the object by using the method supported by that particular object. Most objects support a <span CLASS="ElementNameeln">Close</span> method or a <span CLASS="ElementNameeln">Quit</span> method that you can use to close the object and free the resources it has been using. You can also use the <span CLASS="ElementNameeln">Nothing</span> keyword with the <span CLASS="ElementNameeln">Set</span> statement to free the memory that's being used by the object variable associated with an object. Once you set an object variable to the <span CLASS="ElementNameeln">Nothing</span> keyword, it no longer points to an object and no longer uses system resources.
<p CLASS="Textttext">The following example shows different ways to free the memory associated with an object variable:</p>
<p CLASS="CodeTextct">Sub UseExcel()<br>&nbsp;&nbsp;&nbsp;' Create a new instance of the Excel Application class.<br>&nbsp;&nbsp;&amp;nbspDim appXL As New Excel.Application<br>&nbsp;&nbsp;&nbsp;' Declare other object variables.<br>&nbsp;&nbsp;&amp;nbspDim wbk As Excel.Workbook, wks As Excel.Worksheet<br>&nbsp;&nbsp;&amp;nbspSet wbk = appXL.Workbooks.Add<br>&nbsp;&nbsp;&amp;nbspappXL.Visible = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. ' Perform an Automation operation.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;' Close objects and component and free memory.<br>&nbsp;&nbsp;&amp;nbspwbk.Close<br>&nbsp;&nbsp;&amp;nbspappXL.Quit<br>&nbsp;&nbsp;&amp;nbspSet appXL = Nothing<br>End Sub</p>
<p CLASS="Textttext">System resources are also freed when an object variable that points to an object goes out of scope. However, it's a good idea to close an object or set it to the <span CLASS="ElementNameeln">Nothing</span> keyword to guarantee that resources are freed when you need them, and to make your code self-documenting.
<p CLASS="Textttext">If you are working with a component's <span CLASS="ElementNameeln">Application</span> object, the component may not actually close when you set the object variable to the <span CLASS="ElementNameeln">Nothing</span> keyword, even though the memory used by the object variable has been freed. In this case, you must explicitly use the <span CLASS="ElementNameeln">Application</span> object's <span CLASS="ElementNameeln">Quit</span> method to close the component before you set the object variable to the <span CLASS="ElementNameeln">Nothing</span> keyword.</p>
<a NAME="4UsingMicrosoftAccessObjectsThroughAutomation"></a>
<p CLASS="heading4OrgHeading2h2">Using Microsoft Access Objects Through Automation</p>
<p CLASS="Textttext">So far, you have seen how to work with other components' objects from Microsoft Access. You can also work with Microsoft Access objects from other components. For example, you can use Automation to create a Microsoft Access report from a Microsoft Excel spreadsheet.
<p CLASS="Textttext">The following example uses Automation from Microsoft Excel to create a linked table in a Microsoft Access database and then create a Microsoft Access report based on the data in the linked table. To use this example, you need to create a Microsoft Excel workbook named Revenue.xls, add some data to a worksheet in that workbook, and create a named range called DataRange that includes this data. Then, enter the following code in the Declarations section of a module in the Microsoft Excel workbook.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>Before you run this code, make sure that the Microsoft Excel ISAM driver (MSEXCL35.dll) is installed on your system. The Microsoft Excel ISAM driver enables Microsoft Excel files to work with the Microsoft Jet database engine. For more information on working with the Microsoft Excel ISAM driver, search the Help index for &quot;Microsoft Excel driver.&quot;</p>
<p CLASS="CodeTextct">' Enter in Declarations section of a module.<br>Dim appAccess As New Access.Application<br>Sub PrintReport()<br>&nbsp;&nbsp;&amp;nbspDim rpt As Access.Report, ctl As Access.Control<br>&nbsp;&nbsp;&amp;nbspDim dbs As DAO.Database, tdf As DAO.TableDef, fld As DAO.Field<br>&nbsp;&nbsp;&amp;nbspDim strDB As String, intLeft As Integer<br>&nbsp;&nbsp;&nbsp;' Set this constant to the path to your Northwind sample database.<br>&nbsp;&nbsp;&amp;nbspConst conFilePath As String = &quot;C:\Program Files\Microsoft Office\Office\Samples\&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Open database in Microsoft Access, specifying full path name.<br>&nbsp;&nbsp;&amp;nbspappAccess.OpenCurrentDatabase conFilePath &amp; &quot;Northwind.mdb&quot;<br>&nbsp;&nbsp;&nbsp;' Return reference to current database.<br>&nbsp;&nbsp;&amp;nbspSet dbs = appAccess.CurrentDb<br>&nbsp;&nbsp;&nbsp;' Create new TableDef object.<br>&nbsp;&nbsp;&amp;nbspSet tdf = dbs.CreateTableDef(&quot;XLData&quot;)<br>&nbsp;&nbsp;&nbsp;' Specify connect string for Microsoft Excel ISAM driver.<br>&nbsp;&nbsp;&amp;nbsptdf.Connect = &quot;EXCEL 8.0; Database=C:\My Documents\Revenue.xls&quot;<br>&nbsp;&nbsp;&nbsp;' Specify source table as a named range in a worksheet.<br>&nbsp;&nbsp;&amp;nbsptdf.SourceTableName = &quot;DataRange&quot;<br>&nbsp;&nbsp;&nbsp;' Append new linked table to database.<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Append tdf<br>&nbsp;&nbsp;&nbsp;' Create new report in Microsoft Access.<br>&nbsp;&nbsp;&amp;nbspSet rpt = appAccess.CreateReport<br>&nbsp;&nbsp;&nbsp;' Specify linked table as report's record source.<br>&nbsp;&nbsp;&amp;nbsprpt.RecordSource = tdf.Name<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Create control on report for each field in linked table.<br>&nbsp;&nbsp;&amp;nbspFor Each fld In tdf.fields<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspSet ctl = appAccess.CreateReportControl(rpt.Name, acTextBox, , , _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspfld.Name, intLeft)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspintLeft = intLeft + ctl.Width<br>&nbsp;&nbsp;&amp;nbspNext fld<br>&nbsp;&nbsp;&nbsp;' Open report in Print Preview.<br>&nbsp;&nbsp;&amp;nbspappAccess.DoCmd.OpenReport rpt.Name, acViewPreview<br>&nbsp;&nbsp;&nbsp;' Restore report.<br>&nbsp;&nbsp;&amp;nbspappAccess.DoCmd.Restore<br>&nbsp;&nbsp;&nbsp;' Display Microsoft Access as active application.<br>&nbsp;&nbsp;&amp;nbspAppActivate &quot;Microsoft Access&quot;<br>End Sub</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba11_3.htm" OnClick="SyncURL(&quot;chapters/ba11_3.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
