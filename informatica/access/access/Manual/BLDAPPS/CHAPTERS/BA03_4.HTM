<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Filtering and Sorting Data in Forms and Reports</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba03_3.htm" OnClick="SyncURL(&quot;chapters/ba03_3.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3FilteringandSortingDatainFormsandReports"></a>
<p CLASS="heading3OrgHeading1h1">Filtering and Sorting Data in Forms and Reports</p>
<p CLASS="Textttext">One of the most important functions of a database application is to make it easy for users to find the data they need to use or change. For example, in the Orders sample application, users need a way to find existing orders easily. Microsoft Access provides powerful tools for users to find, filter, and sort records. Depending on your users' needs, you can allow them to use existing tools, or provide your own ways to accomplish these tasks.
<p CLASS="Textttext">This section describes the following approaches to filtering and sorting data in your application:
<p CLASS="Textttext"><span CLASS="ElementNameeln">Using Standard Filter and Sort Commands&nbsp;&nbsp;&nbsp;</span>If you make the <span CLASS="ElementNameeln">Filter By Selection</span>, <span CLASS="ElementNameeln">Filter By Form</span>, and <span CLASS="ElementNameeln">Sort</span> commands available on your application's forms, users can easily filter and sort records themselves. If you want, you can customize these features by responding to events.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Opening a Form or Report with a Filter&nbsp;&nbsp;&nbsp;</span>You can use a number of methods to open forms or reports in your application so that they show a subset of records.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Changing the Filter or Sort Order of a Form or Report&nbsp;&nbsp;&nbsp;</span>After a form or report is open, you can change the filter or sort order in code, or apply or remove the filter.
<p CLASS="Textttext">If you have special needs for finding and filtering data in your application, you may want to provide your own filtering interface. In this case, you'll use a combination of the previous techniques, creating your own forms where users can specify the records they want to see. For example, you may know that there are only a few fields the user wants to filter on. By displaying your own form, you can provide a straightforward interface for filtering on important fields while ignoring others.</p>
<a NAME="4UsingStandardFilterandSortCommands"></a>
<p CLASS="heading4OrgHeading2h2">Using Standard Filter and Sort Commands</p>
<p CLASS="Textttext">Unless you set properties or change menus and toolbars to make them unavailable, the following filter and sort commands are available on the <span CLASS="ElementNameeln">Records</span> menu and the toolbar in Form view:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Filter By Selection</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Filter By Form</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Advanced Filter/Sort</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Apply Filter/Sort</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Remove Filter/Sort</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Sort Ascending</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Sort Descending</span></p>
<p CLASS="Textttext">Using these commands, users of your application can easily filter and sort records themselves. When a user applies a filter or sort order using these commands, Microsoft Access sets the <span CLASS="ElementNameeln">Filter</span>, <span CLASS="ElementNameeln">FilterOn</span>, <span CLASS="ElementNameeln">OrderBy</span>, and <span CLASS="ElementNameeln">OrderByOn</span> properties for the form accordingly, and requeries records on the form.
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>When a user changes the filter or sort order of a form and then closes the form, Microsoft Access saves this information. The last sort order saved is reapplied automatically the next time the form is opened, and the user can reapply the last filter saved by clicking the <span CLASS="ElementNameeln">Apply Filter</span> button <img SRC="..\images\FILTER.gif">.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Filter By Selection</span>, <span CLASS="ElementNameeln">Filter By Form</span>, or <span CLASS="ElementNameeln">Advanced Filter/Sort</span> commands, search the Help index for the name of the command.</p>
<a NAME="5DisablingFilterandSortFeatures"></a>
<p CLASS="heading5OrgHeading3h3">Disabling Filter and Sort Features</p>
<p CLASS="Textttext">In some cases, you don't want users of your application to filter records. To disable the standard filtering commands on a form, set the <span CLASS="ElementNameeln">AllowFilters</span> property to No.
<p CLASS="Textttext">If you want to disable sorting, or if you want to disable some filtering features while allowing others, create custom menu bars and toolbars for your form that include the commands and buttons you want and leave off the ones you don't want to make available.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on custom menu bars and toolbars, see Chapter 1, <a HREF="../chapters/ba01_1.htm" OnClick="SyncURL(&quot;chapters/ba01_1.htm&quot;)">&quot;Creating an Application.&quot;</a></p>
<a NAME="5RespondingtoFilterEvents"></a>
<p CLASS="heading5OrgHeading3h3">Responding to Filter Events</p>
<p CLASS="Textttext">If you want to change the way that standard filtering and sorting commands work, you can write event procedures for the Filter and ApplyFilter events. For example, you may want to display a message each time a user uses the <span CLASS="ElementNameeln">Filter By Form</span> or the <span CLASS="ElementNameeln">Advanced Filter/Sort</span> command for a form to remind the user to specify criteria and then apply the filter.
<p CLASS="Textttext">If you want to display a message or take other action when a user uses the <span CLASS="ElementNameeln">Filter By Form</span> or <span CLASS="ElementNameeln">Advanced Filter/Sort</span> command, write an event procedure for the Filter event. To help you respond to each command, the Filter event procedure has a FilterType argument that tells you which of these commands was selected.
<p CLASS="Textttext">If you want to cancel the filtering command the user chose, you can set the Cancel argument for the event procedure to <span CLASS="ElementNameeln">True</span>.
<p CLASS="Textttext">The following event procedure compares the FilterType argument to the <span CLASS="ElementNameeln">acFilterByForm</span> and <span CLASS="ElementNameeln">acFilterAdvanced</span> constants to display a different message to the user depending on which filtering command was chosen.</p>
<p CLASS="CodeTextct">Private Sub Form_Filter(Cancel As Integer, FilterType As Integer)<br>&nbsp;&nbsp;&amp;nbspDim strMsg As String<br>&nbsp;&nbsp;&amp;nbspSelect Case FilterType<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acFilterByForm<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = &quot;Specify the records you want to see by choosing &quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = strMsg &amp; &quot;from the lists, then click Apply Filter.&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acFilterAdvanced<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = &quot;Drag fields to the filter design grid, specify &quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = strMsg &amp; &quot;criteria and sort order, then click &quot; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = strMsg &amp; &quot;Apply Filter.&quot;<br>&nbsp;&nbsp;&amp;nbspEnd Select<br>&nbsp;&nbsp;&amp;nbspMsgBox strMsg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Display the message.<br>End Sub</p>
<p CLASS="Textttext">If you want to display a message or take other action when a user applies or changes a filter, write an event procedure for the ApplyFilter event. This event occurs whenever a user chooses the <span CLASS="ElementNameeln">Apply Filter/Sort</span>, <span CLASS="ElementNameeln">Remove Filter/Sort</span>, or<span CLASS="ElementNameeln"> Filter By Selection</span> command, and whenever the user closes the Filter window without applying the filter. The ApplyFilter event procedure has an ApplyType argument that tells you which of these actions was taken so you can respond in different ways.
<p CLASS="Textttext">If you want to cancel the filtering command the user chose, you can set the Cancel argument for the event procedure to<span CLASS="ElementNameeln"> True</span>, and the filter won't be applied.
<p CLASS="Textttext">The following event procedure displays a message if the user is applying a filter. The message shows the setting of the <span CLASS="ElementNameeln">Filter</span> property and gives the user a chance to cancel the operation.</p>
<p CLASS="CodeTextct">Private Sub Form_ApplyFilter(Cancel As Integer, ApplyType As Integer)<br>&nbsp;&nbsp;&amp;nbspDim strMsg As String, intResponse As Integer<br>&nbsp;&nbsp;&amp;nbspIf ApplyType = acApplyFilter Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = &quot;You've chosen to filter for the following criteria:&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrMsg = strMsg &amp; vbCrLf &amp; Me.Filter<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;' Display the message box and get an OK or Cancel response.<br>&nbsp;&nbsp;&amp;nbspintResponse = MsgBox(strMsg, vbOkCancel + vbQuestion)<br>&nbsp;&nbsp;&amp;nbspIf intResponse = vbCancel Then Cancel = True<br>End Sub</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on arguments for the Filter events, search the Help index for &quot;Filter event&quot; and &quot;ApplyFilter event.&quot; For more information on events, see Chapter 6, <a HREF="../chapters/ba06_1.htm" OnClick="SyncURL(&quot;chapters/ba06_1.htm&quot;)">&quot;Responding to Events.&quot;</a>
<p CLASS="heading6OrgHeading4h4"><img SRC="../images/example.gif" WIDTH="73" HEIGHT="21"><!--example space-->&nbsp;&nbsp;<a NAME="XCustomizingtheStandardFilteringInterface"></a>Customizing the Standard Filtering Interface</p>
<p CLASS="Textttext">When a Northwind sales representative starts the Orders application, the Orders form opens for data entry (no existing records are available). To find an existing order in the database, the employee clicks the Filter Orders button on the Orders toolbar.
<p CLASS="Textttext">You want the filtering interface on the Orders form to be as straightforward as possible. Because most fields aren't appropriate for setting criteria, you don't want the employee to worry about them. To make them less obtrusive, you can disable all the fields except those you expect a user to set criteria for.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0314.jpg"></p><br>
<p CLASS="Textttext">The Filter event procedure for the Orders form disables all but three fields (BillTo, EmployeeID, and OrderDate).</p>
<p CLASS="CodeTextct">Private Sub Form_Filter(Cancel As Integer, FilterType As Integer)<br>' If Filter By Form, disable all but three fields.<br>&nbsp;&nbsp;&amp;nbspIf FilterType = acFilterByForm Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspBillTo.SetFocus<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control<br>&nbsp;&nbsp;&amp;nbspFor Each ctl In Me.Controls<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspSelect Case ctl.ControlType<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acTextBox, acComboBox, acOptionGroup, acSubForm<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspSelect Case ctl.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase &quot;BillTo&quot;, &quot;EmployeeID&quot;, &quot;OrderDate&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspctl.Enabled = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd Select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd Select<br>&nbsp;&nbsp;&amp;nbspNext ctl<br>&nbsp;&nbsp;&amp;nbspDoCmd.ShowToolbar &quot;Orders Form Toolbar&quot;, acToolbarNo<br>&nbsp;&nbsp;&amp;nbspEnd If<br>End Sub</p>
<p CLASS="Textttext">If you set properties in the Filter event procedure, be sure to reset them in the ApplyFilter event procedure.</p>
<p CLASS="CodeTextct">Private Sub Form_ApplyFilter(Cancel As Integer, ApplyType As Integer)<br>' Reset fields after filtering.<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control<br>&nbsp;&nbsp;&amp;nbspFor Each ctl In Me.Controls<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspSelect Case ctl.ControlType<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acTextBox, acComboBox, acOptionGroup, acSubForm<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspSelect Case ctl.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase &quot;OrderID&quot;, &quot;Subtotal&quot;, &quot;Total&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspctl.Enabled = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd Select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd Select<br>&nbsp;&nbsp;&amp;nbspNext ctl<br>&nbsp;&nbsp;&amp;nbspBillTo.SetFocus<br>&nbsp;&nbsp;&amp;nbspDoCmd.ShowToolbar &quot;Orders Form Toolbar&quot;, acToolbarYes<br>End Sub</p>
<!--mstheme--></font><table CELLPADDING="3" BORDER="2" BORDERCOLOR="#0000FF" bordercolordark="#660000" bordercolorlight="#CC9966"><tr BGCOLOR="#FFFFFF"><td><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="SidebarHeadingsbrh">Controlling Combo Boxes in Filter By Form</p>
<p CLASS="SidebarTextsbrt">You can control whether text boxes on a form display suggested values in drop-down combo boxes in the Filter By Form window. For example, if you have a large set of records or if your data is stored on a network, you may want to prevent Microsoft Access from running queries to fill all the lists. By default, Filter By Form displays lists of values for indexed and non-indexed fields if the record source for the form is in the current database or a linked table, but doesn't display them if the record source is a linked Open Database Connectivity (ODBC) database. To change this behavior, set the <span CLASS="ElementNameeln">FilterLookup</span> property for the text box in form Design view, or set Filter By Form options on the <span CLASS="ElementNameeln">Edit/Find</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu). </p>
<p CLASS="SidebarCrossRefTextsbrcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on Filter By Form, search the Help index for &quot;Filter By Form.&quot;</p><!--mstheme--></font></td></tr></table><!--mstheme--><font face="book antiqua, times new roman, times">
<a NAME="4OpeningaFormorReportwithaFilter"></a>
<p CLASS="heading4OrgHeading2h2">Opening a Form or Report with a Filter</p>
<p CLASS="Textttext">When you use Visual Basic code or a macro to open a form or report, you may want to specify which records to display. This is especially useful for reports, because users can't directly filter records in a report.
<p CLASS="Textttext">When your application provides a customized way for users to open a form or print a report, you can specify the records to display in the form or report in several ways. A common approach is to display a custom dialog box where the user enters criteria for the form or report's underlying query. To get the criteria, you refer to the controls in the dialog box. The following sections describe three ways you can use criteria entered in a custom dialog box to filter records.</p>
<a NAME="5Usingthe"></a>
<p CLASS="heading5OrgHeading3h3">Using the <span CLASS="NewTermntrm">wherecondition</span> Argument</p>
<p CLASS="Textttext">The <span CLASS="NewTermntrm">wherecondition</span> argument of the <span CLASS="ElementNameeln">OpenForm</span> or <span CLASS="ElementNameeln">OpenReport</span> method or action is the simplest way to get criteria in situations where a user is providing only one value. For example, the PrintInvoiceDialog form in the Orders sample application prompts users to select an OrderID for the invoice they want to print. If you're using an event procedure, you can apply a filter that displays only one record by adding an argument to the <span CLASS="ElementNameeln">OpenReport</span> method, as shown in the following line of code:</p>
<p CLASS="CodeTextct">DoCmd.OpenReport &quot;Invoice&quot;, acViewPreview, , &quot;OrderID = &quot; &amp; OrderID</p>
<p CLASS="Textttext">The <span CLASS="CodeTextEmbeddedcte">&quot;OrderID = &quot;</span> in the filter expression refers to the OrderID field in the Invoice report's underlying query. The <span CLASS="CodeTextEmbeddedcte">OrderID</span> on the right side of the expression refers to the value the user selected from the OrderID list box in the dialog box. The expression concatenates the two, causing the report to include only the invoice for the record the user selected.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the PrintInvoiceDialog form, see the example <a HREF="../chapters/ba03_3.htm#XCreatingaDialogBoxtoPrintInvoices" OnClick="SyncURL(&quot;chapters/ba03_3.htm&quot;)">&quot;Creating a Dialog Box to Print Invoices&quot;</a> earlier in this chapter.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If you're using a macro, you can use the following Where Condition argument in the OpenReport action that prints the report.
<p CLASS="NoteTextnt">OrderID = [Forms]![PrintInvoiceDialog]![OrderID]</p>
<p CLASS="Textttext">The <span CLASS="NewTermntrm">wherecondition</span> argument is applied only by the event procedure or macro specified for the OnClick event of the button that runs the <span CLASS="ElementNameeln">OpenForm</span> or <span CLASS="ElementNameeln">OpenReport</span> method or action. This gives you the flexibility of using any number of different dialog boxes to open the same form or report and applying different sets of criteria depending on what the user wants to do. For example, the user may want to print an invoice for a certain customer or view orders only for a certain product. If users open the form or report in the Database window rather than through your dialog box, however, no criteria are applied to the query and all its records are displayed or printed. To prevent this, you can hide the Database window by clearing the <span CLASS="ElementNameeln">Display Database Window</span> check box in the <span CLASS="ElementNameeln">Startup</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on Startup options, see <a HREF="../chapters/ba01_7.htm" OnClick="SyncURL(&quot;chapters/ba01_7.htm&quot;)">&quot;Setting Startup Options&quot;</a> in Chapter 1, &quot;Creating an Application.&quot;</p>
<p CLASS="Textttext">You can use the <span CLASS="NewTermntrm">wherecondition</span> argument to set criteria for more than one field, but if you do, the argument setting quickly becomes long and complicated. In those situations, specifying criteria in a query may be easier.</p>
<a NAME="5UsingaQueryasaFilter"></a>
<p CLASS="heading5OrgHeading3h3">Using a Query as a Filter </p>
<p CLASS="Textttext">A separate query, sometimes called a <span CLASS="NewTermntrm">filter query</span>, can refer to the controls on your dialog box to get its criteria. Using this approach, you filter the records in a form or report by setting the <span CLASS="NewTermntrm">filtername</span> argument of the <span CLASS="ElementNameeln">OpenForm</span> or <span CLASS="ElementNameeln">OpenReport</span> method or action to the name of the filter query you create. The filter query must include all the tables in the record source of the form or report you're opening. Additionally, the filter query must either include all the fields in the form or report you're opening, or you must set its <span CLASS="ElementNameeln">OutputAllFields</span> property to Yes.
<p CLASS="Textttext">For example, to create a filter query for the Invoice report, make a copy of the report's underlying query and save it under another name. Then, add criteria to the OrderID field in the filter query that refers to the control on the dialog box. (If the filter query's <span CLASS="ElementNameeln">OutputAllFields</span> property is set to Yes, this is the only field you need to include in the filter query as long as you include all the tables that contain fields on the report.)</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0315.jpg"></p>
<p CLASS="Textttext">After you create and save the query you'll use as a filter, set the <span CLASS="NewTermntrm">filtername</span> argument of the <span CLASS="ElementNameeln">OpenReport</span> method or action to the name of the filter query. The <span CLASS="NewTermntrm">filtername</span> argument applies the specified filter query each time the <span CLASS="ElementNameeln">OpenReport</span> method or action runs.
<p CLASS="Textttext">Using a query as a filter to set the criteria has advantages similar to using the <span CLASS="NewTermntrm">wherecondition</span> argument of the <span CLASS="ElementNameeln">OpenForm</span> or <span CLASS="ElementNameeln">OpenReport</span> method or action. A filter query gives you the same flexibility of using more than one dialog box to open the same form or report and applying different sets of criteria depending on what a user wants to do. If users open the form or report in the Database window rather than through your dialog box, however, no criteria are applied to the query and all its records are displayed or printed. To prevent this, you can hide the Database window by clearing the <span CLASS="ElementNameeln">Display Database Window</span> check box in the <span CLASS="ElementNameeln">Startup</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on Startup options, see <a HREF="../chapters/ba01_7.htm" OnClick="SyncURL(&quot;chapters/ba01_7.htm&quot;)">&quot;Setting Startup Options&quot;</a> in Chapter 1, &quot;Creating an Application.&quot;</p>
<a NAME="5DirectlyReferringtoDialogBoxControlsinaFormorReportsUnderlyingQuery"></a>
<p CLASS="heading5OrgHeading3h3">Directly Referring to Dialog Box Controls in a Form or Report's Underlying Query</p>
<p CLASS="Textttext">You can also refer to the dialog box controls directly in the form or report's underlying query instead of through the arguments of the <span CLASS="ElementNameeln">OpenForm</span> or <span CLASS="ElementNameeln">OpenReport</span> method or action. For example, instead of referring to the control on the PrintInvoiceDialog form in a filter query's criteria as shown in the previous illustration, you can set the exact same criteria in the Invoice report's underlying query, Invoices.
<p CLASS="Textttext">Using this approach, the <span CLASS="ElementNameeln">OpenForm</span> or <span CLASS="ElementNameeln">OpenReport</span> method or action requires no <span CLASS="NewTermntrm">wherecondition</span> or <span CLASS="NewTermntrm">filtername</span> argument. Instead, each time you open a form or report, its underlying query looks for the dialog box to get its criteria. However, if a user opens the form or report in the Database window rather than through your dialog box, Microsoft Access displays a parameter box prompting the user for the dialog box value. To prevent this, you can hide the Database window by clearing the <span CLASS="ElementNameeln">Display Database Window</span> check box in the <span CLASS="ElementNameeln">Startup</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on Startup options, see <a HREF="../chapters/ba01_7.htm" OnClick="SyncURL(&quot;chapters/ba01_7.htm&quot;)">&quot;Setting Startup Options&quot;</a> in Chapter 1, &quot;Creating an Application.&quot;</p>
<a NAME="4ChangingtheFilterorSortOrderofaFormorReport"></a>
<p CLASS="heading4OrgHeading2h2">Changing the Filter or Sort Order of a Form or Report</p>
<p CLASS="Textttext">After a form or report is open, you can change the filter or sort order in response to users' actions by setting form and report properties in Visual Basic code or in macros. For example, you may want to provide a menu command or a toolbar button that users can use to change the records that are displayed. Or you may have an option group control on a form that users can use to select from common sorting options.
<p CLASS="Textttext">To set the filter of a form or report, set its <span CLASS="ElementNameeln">Filter</span> property to the appropriate <span CLASS="NewTermntrm">wherecondition</span> argument, and then set the <span CLASS="ElementNameeln">FilterOn</span> property to <span CLASS="ElementNameeln">True</span>. To set the sort order, set the <span CLASS="ElementNameeln">OrderBy</span> property to the field or fields you want to sort on, and then set the <span CLASS="ElementNameeln">OrderByOn</span> property to <span CLASS="ElementNameeln">True</span>. If a filter or sort order is already applied on a form, you can change it simply by setting the <span CLASS="ElementNameeln">Filter</span> or <span CLASS="ElementNameeln">OrderBy</span> properties.
<p CLASS="Textttext">When you apply or change the filter or sort order by setting these properties, Microsoft Access automatically requeries the records in the form or report. For example, the following code changes the sort order of a form based on a user's selection in an option group:</p>
<p CLASS="CodeTextct">Private Sub SortOptionGrp_AfterUpdate()<br>&nbsp;&nbsp;&amp;nbspConst conName = 0, conDate = 1<br>&nbsp;&nbsp;&amp;nbspSelect Case SortOptionGrp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase conName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMe.OrderBy = &quot;LastName, FirstName&quot;&nbsp;&nbsp;&nbsp;' Sort by two fields.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase conDate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMe.OrderBy = &quot;HireDate DESC&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Sort by descending date.<br>&nbsp;&nbsp;&amp;nbspEnd Select<br>&nbsp;&nbsp;&amp;nbspMe.OrderByOn = True&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Apply the sort order.<br>End Sub</p>
<p CLASS="Textttext">Whether the filter and sort order get set in code or by the user, you can apply or remove them by setting the <span CLASS="ElementNameeln">FilterOn</span> and <span CLASS="ElementNameeln">OrderByOn</span> properties to <span CLASS="ElementNameeln">True</span> or <span CLASS="ElementNameeln">False</span>. For example, you could add a button to a report's custom toolbar that runs the following macro to apply or remove a filter you specified when opening the report.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0316.jpg">
<p><a NAME="XSynchronizingRecordsbyChangingtheFilter"></a>
<p CLASS="heading6OrgHeading4h4"><img SRC="../images/example.gif" WIDTH="73" HEIGHT="21"><!--example space-->&nbsp;&nbsp;<a NAME="XSynchronizingRecordsbyChangingtheFilter"></a>Synchronizing Records by Changing the Filter</p>
<p CLASS="Textttext">The Orders sample application controls which record appears in the ProductsPopup form by setting the form's <span CLASS="ElementNameeln">Filter</span> property. You can keep the ProductsPopup form synchronized with the Orders form; this will make sure the ProductsPopup form always shows details about the current product when you move from record to record in the Orders subform.
<p CLASS="Textttext">To do this, write an event procedure for the subform's Current event that sets the pop-up form's <span CLASS="ElementNameeln">Filter</span> property. (You can also do this by writing a macro you specify as the subform's <span CLASS="ElementNameeln">OnCurrent</span> event property setting.) The following code example shows the event procedure for the Current event of the Orders subform. This event procedure uses the IsLoaded function from the UtilityFunctions module that is included with the Orders sample application.</p>
<p CLASS="CodeTextct">Private Sub Form_Current()<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&amp;nbspIf IsLoaded(&quot;ProductsPopup&quot;) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' If there's no current product record, display a blank pop-up window,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' otherwise filter to show the current product.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspIf IsNull(ProductID) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrFilter = &quot;ProductID = 0&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspForms!ProductsPopup.Filter = &quot;ProductID = &quot; &amp; ProductID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspForms!Orders.SetFocus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set focus back to Orders subform.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspForms!Orders!OrdersSubform.SetFocus&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>End Sub</p>
<p CLASS="Textttext">Each time a user changes records in the subform, the procedure resets the <span CLASS="ElementNameeln">Filter</span> property of the pop-up form, causing it to display the corresponding record.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba03_5.htm" OnClick="SyncURL(&quot;chapters/ba03_5.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
