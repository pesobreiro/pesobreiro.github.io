<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Making Additional Replicas</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba20_4.htm" OnClick="SyncURL(&quot;chapters/ba20_4.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3MakingAdditionalReplicas"></a>
<p CLASS="heading3OrgHeading1h1">Making Additional Replicas</p>
<p CLASS="Textttext">Although you can make changes to the design of the database only in the Design Master replica, you can make additional replicas from any replica in the set. In fact, the only way to include new copies of the database in the replica set is to create them from an existing replica. Once you create them, all new replicas become part of the replica set.
<p CLASS="Textttext">All the replicas in a replica set have a unique identity and can communicate and synchronize with one another. Each replica set is independent from all other replica sets, and replicas in different sets cannot communicate or synchronize with each other.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>Never try to make additional replicas from the original, nonreplicated database. The result would not be an additional replica, but rather a new Design Master and replica set.</p>
<p CLASS="Textttext">When you convert your database to a Design Master by setting its <span CLASS="ElementNameeln">ReplicableBool </span>property to <span CLASS="ElementNameeln">True</span>, you have only one replica (the Design Master) in the replica set, and you make your second replica from the first. You can make your second replica, and subsequent replicas, by using the <span CLASS="ElementNameeln">Create Replica</span> command (<span CLASS="ElementNameeln">Tools</span> menu, <span CLASS="ElementNameeln">Replication</span> submenu) in Microsoft Access, or by using the <span CLASS="ElementNameeln">MakeReplica </span>method in code. For example, to make a replica of your database, you can use the following code:</p>
<p CLASS="CodeTextct">Function MakeAdditionalReplica(strReplicableDB As String, _<br>&nbsp;&nbsp;&amp;nbspstrNewReplica As String, intOptions As Integer) As Boolean<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&amp;nbspOn Error GoTo ErrorHandler<br>&nbsp;&nbsp;&amp;nbspSet dbs = OpenDatabase(strReplicableDB)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' If no options are passed to MakeAdditionalReplica, omit the options<br>&nbsp;&nbsp;&nbsp;' argument, which defaults to a full, read/write replica. Otherwise,<br>&nbsp;&nbsp;&nbsp;' use the value of intOptions.<br>&nbsp;&nbsp;&amp;nbspIf intOptions = 0 Then&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspdbs.MakeReplica strNewReplica, &quot;Replica of &quot; &amp; strReplicableDB<br>&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspdbs.MakeReplica strNewReplica, &quot;Replica of &quot; &amp; strReplicableDB, intOptions<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&amp;nbspdbs.Close<br>ErrorHandler: <br>&nbsp;&nbsp;&amp;nbspSelect Case Err<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase 0: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMakeAdditionalReplica = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspExit Function<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase Else:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;Error &quot; &amp; Err &amp; &quot; : &quot; &amp; Error<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMakeAdditionalReplica = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspExit Function<br>&nbsp;&nbsp;&amp;nbspEnd Select<br>End Function</p>
<p CLASS="Textttext">If you specify the <span CLASS="ElementNameeln">dbRepMakeReadOnly </span>constant<span CLASS="ElementNameeln"> </span>in the <span CLASS="NewTermntrm">options</span> argument of the <span CLASS="ElementNameeln">MakeReplica</span> method, then the objects in the newly created replica cannot be modified. Otherwise, users are able to make changes to the data in the new replica. If you specify the <span CLASS="ElementNameeln">dbRepMakePartial</span> constant<span CLASS="ElementNameeln"> </span>in the <span CLASS="NewTermntrm">options</span> argument of the<span CLASS="ElementNameeln"> MakeReplica</span> method, you create a partial replica rather than a full replica.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on partial replicas, see <a HREF="../chapters/ba20_6.htm" OnClick="SyncURL(&quot;chapters/ba20_6.htm&quot;)">&quot;Replicating Part of a Database&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">When Microsoft Jet creates the new replica, all property settings of the source replica except custom property settings are included in the new replica. You can make subsequent replicas from either the Design Master replica or from another replica in the set.
<p CLASS="Textttext">Microsoft Jet locks objects while they are open in Design view or while their data is being updated. When you use the <span CLASS="ElementNameeln">MakeReplica</span> method, be sure that the objects you are replicating aren't locked. If objects are locked when you make a replica, the <span CLASS="ElementNameeln">MakeReplica</span> method fails.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>When you make a new replica, you copy all of the objects and properties that can be replicated from the source replica to the new replica. Although you copy all linked tables, the path to a linked table may no longer be accurate because of the new replica's location on the network. Be sure to test the new replica to determine if you need to establish a new path for any of the linked tables. You can change the path specified in the connection string of the <span CLASS="ElementNameeln">Connect</span> property for a linked table even though modifying the connection information is a design change. All other design changes must be made in the Design Master.</p>
<a NAME="4UsingReplicasInsteadofBackups"></a>
<p CLASS="heading4OrgHeading2h2">Using Replicas Instead of Backups </p>
<p CLASS="Textttext">With database replication, it's no longer necessary to make a separate backup copy of your database. If the Design Master is destroyed, you can recover your data from any one of the replicas in the replica set. However, depending on how frequently you synchronize, a replica may not contain all the data in the Design Master or in other replicas. If you want to be able to recover most of the information in your Design Master, be sure to synchronize frequently.
<p CLASS="Textttext">Although it's possible to back up replicas by using traditional backup methods, it's strongly advised not to back up and restore replicas as you would ordinary files. If you back up and restore the Design Master, you could lose critical information about changes to the design of the database as well as the ability of the Design Master to synchronize with the other replicas in the set. If the Design Master is damaged or unusable, don't copy or restore an older version of the Design Master; instead, make another replica the Design Master.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba20_6.htm" OnClick="SyncURL(&quot;chapters/ba20_6.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
