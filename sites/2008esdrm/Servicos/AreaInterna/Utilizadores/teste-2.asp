<%@LANGUAGE="JAVASCRIPT" CODEPAGE="1252"%><!--#include file="../../../Connections/Esdrm.asp" --><%// *** Edit Operations: declare variables// set the form action variablevar MM_editAction = Request.ServerVariables("SCRIPT_NAME");if (Request.QueryString) {  MM_editAction += "?" + Request.QueryString;}// boolean to abort record editvar MM_abortEdit = false;// query string to executevar MM_editQuery = "";%><%// *** Update Record: set variablesif (String(Request("MM_update")) == "form1" &&    String(Request("MM_recordId")) != "undefined") {  var MM_editConnection = MM_Esdrm_STRING;  var MM_editTable  = "dbo.TabUtilizadores";  var MM_editColumn = "numero";  var MM_recordId = "" + Request.Form("MM_recordId") + "";  var MM_editRedirectUrl = "";  var MM_fieldsStr = "titulo|value|nomeUser|value|usernameNT|value|passwordNT|value|usernameMail|value|passwordMail|value|email|value|URLPagina|value|tipoUtilizador|value|Extensao|value|Telefone|value|Cargos|value|GrauAcademico|value|Foto|value|NomeCompleto|value|Morada|value|Localidade|value|CodPostal|value|LocPostal|value|TelefCasa|value|Telemovel|value|DataNasc|value|BI|value|NIF|value|IdComputador|value|validade|value";  var MM_columnsStr = "titulo|none,none,NULL|nomeUser|',none,''|usernameNT|',none,''|passwordNT|',none,''|usernameMail|',none,''|passwordMail|',none,''|email|',none,''|URLPagina|',none,''|tipoUtilizador|none,none,NULL|Extensao|none,none,NULL|Telefone|',none,''|Cargos|',none,''|GrauAcademico|',none,''|Foto|',none,''|NomeCompleto|',none,''|Morada|',none,''|Localidade|',none,''|CodPostal|',none,''|LocPostal|',none,''|TelefCasa|',none,''|Telemovel|',none,''|DataNasc|',none,NULL|BI|',none,''|NIF|',none,''|IdComputador|',none,''|validade|',none,NULL";  // create the MM_fields and MM_columns arrays  var MM_fields = MM_fieldsStr.split("|");  var MM_columns = MM_columnsStr.split("|");    // set the form values  for (var i=0; i+1 < MM_fields.length; i+=2) {    MM_fields[i+1] = String(Request.Form(MM_fields[i]));  }  // append the query string to the redirect URL  if (MM_editRedirectUrl && Request.QueryString && Request.QueryString.Count > 0) {    MM_editRedirectUrl += ((MM_editRedirectUrl.indexOf('?') == -1)?"?":"&") + Request.QueryString;  }}%><%// *** Update Record: construct a sql update statement and execute itif (String(Request("MM_update")) != "undefined" &&    String(Request("MM_recordId")) != "undefined") {  // create the sql update statement  MM_editQuery = "update " + MM_editTable + " set ";  for (var i=0; i+1 < MM_fields.length; i+=2) {    var formVal = MM_fields[i+1];    var MM_typesArray = MM_columns[i+1].split(",");    var delim =    (MM_typesArray[0] != "none") ? MM_typesArray[0] : "";    var altVal =   (MM_typesArray[1] != "none") ? MM_typesArray[1] : "";    var emptyVal = (MM_typesArray[2] != "none") ? MM_typesArray[2] : "";    if (formVal == "" || formVal == "undefined") {      formVal = emptyVal;    } else {      if (altVal != "") {        formVal = altVal;      } else if (delim == "'") { // escape quotes        formVal = "'" + formVal.replace(/'/g,"''") + "'";      } else {        formVal = delim + formVal + delim;      }    }    MM_editQuery += ((i != 0) ? "," : "") + MM_columns[i] + " = " + formVal;  }  MM_editQuery += " where " + MM_editColumn + " = " + MM_recordId;  if (!MM_abortEdit) {    // execute the update    var MM_editCmd = Server.CreateObject('ADODB.Command');    MM_editCmd.ActiveConnection = MM_editConnection;    MM_editCmd.CommandText = MM_editQuery;    MM_editCmd.Execute();    MM_editCmd.ActiveConnection.Close();    if (MM_editRedirectUrl) {      Response.Redirect(MM_editRedirectUrl);    }  }}%><%var Recordset1__MMColParam = "1";if (String(Request.QueryString("46")) != "undefined" &&     String(Request.QueryString("46")) != "") {   Recordset1__MMColParam = String(Request.QueryString("46"));}%><%var Recordset1 = Server.CreateObject("ADODB.Recordset");Recordset1.ActiveConnection = MM_Esdrm_STRING;Recordset1.Source = "SELECT * FROM dbo.TabUtilizadores WHERE numero = "+ Recordset1__MMColParam.replace(/'/g, "''") + "";Recordset1.CursorType = 0;Recordset1.CursorLocation = 2;Recordset1.LockType = 1;Recordset1.Open();var Recordset1_numRows = 0;%><html><head><title>Untitled Document</title><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></head><body><form method="post" action="<%=MM_editAction%>" name="form1">  <table align="center">    <tr valign="baseline">       <td nowrap align="right">Titulo:</td>      <td> <input type="text" name="titulo" value="<%=(Recordset1.Fields.Item("titulo").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">NomeUser:</td>      <td> <input type="text" name="nomeUser" value="<%=(Recordset1.Fields.Item("nomeUser").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">UsernameNT:</td>      <td> <input type="text" name="usernameNT" value="<%=(Recordset1.Fields.Item("usernameNT").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">PasswordNT:</td>      <td> <input type="text" name="passwordNT" value="<%=(Recordset1.Fields.Item("passwordNT").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">UsernameMail:</td>      <td> <input type="text" name="usernameMail" value="<%=(Recordset1.Fields.Item("usernameMail").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">PasswordMail:</td>      <td> <input type="text" name="passwordMail" value="<%=(Recordset1.Fields.Item("passwordMail").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Email:</td>      <td> <input type="text" name="email" value="<%=(Recordset1.Fields.Item("email").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">URLPagina:</td>      <td> <input type="text" name="URLPagina" value="<%=(Recordset1.Fields.Item("URLPagina").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">TipoUtilizador:</td>      <td> <input type="text" name="tipoUtilizador" value="<%=(Recordset1.Fields.Item("tipoUtilizador").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Extensao:</td>      <td> <input type="text" name="Extensao" value="<%=(Recordset1.Fields.Item("Extensao").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Telefone:</td>      <td> <input type="text" name="Telefone" value="<%=(Recordset1.Fields.Item("Telefone").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Cargos:</td>      <td> <input type="text" name="Cargos" value="<%=(Recordset1.Fields.Item("Cargos").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">GrauAcademico:</td>      <td> <input type="text" name="GrauAcademico" value="<%=(Recordset1.Fields.Item("GrauAcademico").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Foto:</td>      <td> <input type="text" name="Foto" value="<%=(Recordset1.Fields.Item("Foto").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">NomeCompleto:</td>      <td> <input type="text" name="NomeCompleto" value="<%=(Recordset1.Fields.Item("NomeCompleto").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Morada:</td>      <td> <input type="text" name="Morada" value="<%=(Recordset1.Fields.Item("Morada").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Localidade:</td>      <td> <input type="text" name="Localidade" value="<%=(Recordset1.Fields.Item("Localidade").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">CodPostal:</td>      <td> <input type="text" name="CodPostal" value="<%=(Recordset1.Fields.Item("CodPostal").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">LocPostal:</td>      <td> <input type="text" name="LocPostal" value="<%=(Recordset1.Fields.Item("LocPostal").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">TelefCasa:</td>      <td> <input type="text" name="TelefCasa" value="<%=(Recordset1.Fields.Item("TelefCasa").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Telemovel:</td>      <td> <input type="text" name="Telemovel" value="<%=(Recordset1.Fields.Item("Telemovel").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">DataNasc:</td>      <td> <input type="text" name="DataNasc" value="<%=(Recordset1.Fields.Item("DataNasc").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">BI:</td>      <td> <input type="text" name="BI" value="<%=(Recordset1.Fields.Item("BI").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">NIF:</td>      <td> <input type="text" name="NIF" value="<%=(Recordset1.Fields.Item("NIF").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">IdComputador:</td>      <td> <input type="text" name="IdComputador" value="<%=(Recordset1.Fields.Item("IdComputador").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">Validade:</td>      <td> <input type="text" name="validade" value="<%=(Recordset1.Fields.Item("validade").Value)%>" size="32">      </td>    </tr>    <tr valign="baseline">       <td nowrap align="right">&nbsp;</td>      <td> <input type="submit" value="Update Record"> </td>    </tr>  </table>  <input type="hidden" name="MM_update" value="form1">  <input type="hidden" name="MM_recordId" value="<%= Recordset1.Fields.Item("numero").Value %>"></form><p>&nbsp;</p></body></html><%Recordset1.Close();%>