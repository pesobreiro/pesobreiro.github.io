<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Pausing at a Problem Statement</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="BA07_2.HTM" OnClick="SyncURL(&quot;chapters/BA07_2.HTM&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3PausingataProblemStatement"></a>
<p CLASS="heading3OrgHeading1h1">Pausing at a Problem Statement</p>
<p CLASS="Textttext">To use most of the Microsoft Access debugging tools, you need to suspend execution of your code. In the suspended state, the code is still running but paused between statements. Variables and property settings retain their values, and the Module window displays the code that is currently running.
<p CLASS="Textttext">If you suspect that the problem you're trying to uncover occurs at a certain place in the code, you'll probably want to suspend execution at that location. To make Visual Basic pause execution of your code, you can use one of the following procedures:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspSet a <span CLASS="NewTermntrm">breakpoint</span> on a given line. A breakpoint is a statement at which Visual Basic automatically suspends execution.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on breakpoints, see the following section, <a HREF="#4UsingaBreakpoint" OnClick="SyncURL(&quot;chapters/ba07_3.htm&quot;)">&quot;Using a Breakpoint.&quot;</a></span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspUse a <span CLASS="ElementNameeln">Stop</span> statement on a given line.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on the <span CLASS="ElementNameeln">Stop</span> statement, see <a HREF="../chapters/ba07_3.htm#4UsingaStopStatement" OnClick="SyncURL(&quot;chapters/ba07_3.htm&quot;)">&quot;Using a Stop Statement&quot;</a> later in this chapter.</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspPress <span CLASS="KeyNamekn">CTRL+BREAK</span> while the code is running.</p>
<p CLASS="Textttext">Visual Basic also suspends execution at a given line if a statement on that line generates a run-time error. However, this is true only if no error trapping is in effect at the time the error occurs.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If your Microsoft Access workgroup has security enabled (if you logged on by using the <span CLASS="ElementNameeln">Logon</span> dialog box), you must have Read Design permission for a module in order to suspend code execution within that module. If you don't have Read Design permission for the module that contains the code, and you run code that contains a <span CLASS="ElementNameeln">Stop</span> statement or produces a run-time error, Visual Basic gives you the choice of continuing execution or resetting the code. If you press <span CLASS="KeyNamekn">CTRL+BREAK</span> while code is running, Visual Basic suspends execution at the first statement in a module for which you do have Read Design permission. For information on permissions and security, see Chapter 14, <a HREF="../chapters/ba14_1.htm" OnClick="SyncURL(&quot;chapters/ba14_1.htm&quot;)">&quot;Securing Your Application.&quot;</a></p>
<a NAME="4UsingaBreakpoint"></a>
<p CLASS="heading4OrgHeading2h2">Using a Breakpoint</p>
<p CLASS="Textttext">When Visual Basic encounters a breakpoint while running a procedure, it suspends execution just before running the breakpoint line. Set a breakpoint at any point in your code where you want to monitor what's really going on behind the scenes. For example, if you want to verify that a certain section of code is setting variables as you expect, set a breakpoint on a line of code at the beginning of the section.
<p CLASS="Textttext">You can set or clear a breakpoint when you are writing code in the Module window or when execution is suspended. When execution is suspended, Visual Basic displays the breakpoint and surrounding lines of code in the Module window.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To set or clear a breakpoint</p>
<p CLASS="ListProcedureSingleItemlprocs"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspIn the Module window, click the left margin next to the line of code on which you want to set or clear the breakpoint.</p>
<p CLASS="Textttext">When you set a breakpoint, Visual Basic displays the breakpoint indicator (a red circle) in the margin to the left of the line on which code will pause and displays the text of the line as white text on a red background. For example, the third statement of the procedure in the following illustration is a breakpoint.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0702.jpg"></p>
<p CLASS="Textttext">Visual Basic displays a yellow arrow in the margin to the left of the statement at which the procedure is suspended and displays the statement inside a box with a yellow background. This arrow and yellow box indicate the <span CLASS="NewTermntrm">current statement</span>, or the next statement to be run. When the current statement also contains a breakpoint, both the breakpoint and current statement indicators are displayed overlapping in the margin. In the procedure in the preceding illustration, one <span CLASS="ElementNameeln">Step Into</span> command has been carried out after reaching the breakpoint, and the fifth line is the current statement.
<p CLASS="Textttext">Once a breakpoint is reached and the code is suspended, you can examine what has happened up to that point by inspecting variables and objects in the Debug window, by switching between the Debug window and the other windows in your database, and by using other debugging strategies described in the remainder of this chapter.
<p CLASS="Textttext">If the problem you're trying to solve has already occurred, then you know a line of code that has already run is causing the problem. If the problem hasn't already occurred, then a line of code that has not yet run is causing the problem. If the breakpoint line is the cause, the problem won't occur until you run at least one more statement. Once execution has been suspended, you can step through your code line by line to find the problem.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on stepping through code line by line, see <a HREF="../chapters/ba07_5.htm#4SteppingThroughStatements" OnClick="SyncURL(&quot;chapters/ba07_5.htm&quot;)">&quot;Stepping Through Statements&quot;</a> later in this chapter.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>The problem may not be a line of code. A statement can be the indirect cause of the problem if it assigns an incorrect value to a variable. You can examine the values of controls, properties, and variables while execution is suspended. For more information, see <a HREF="../chapters/ba07_7.htm" OnClick="SyncURL(&quot;chapters/ba07_7.htm&quot;)">&quot;Using the Immediate Pane&quot;</a> later in this chapter.</p>
<a NAME="4UsingaStopStatement"></a>
<p CLASS="heading4OrgHeading2h2">Using a Stop Statement</p>
<p CLASS="Textttext">As an alternative to setting a breakpoint, you can put a <span CLASS="ElementNameeln">Stop</span> statement in a procedure. Visual Basic suspends execution whenever it encounters a <span CLASS="ElementNameeln">Stop</span> statement. In effect, a <span CLASS="ElementNameeln">Stop</span> statement is a breakpoint, but it's more permanent. If you close the database or quit Microsoft Access, all breakpoints are cleared. <span CLASS="ElementNameeln">Stop</span> statements stay in the code until you remove them.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Stop</span> statement, search the Help index for &quot;Stop statement.&quot;</p>
<a NAME="4ContinuingExecutionAfteraRunTimeError"></a>
<p CLASS="heading4OrgHeading2h2">Continuing Execution After a Run-Time Error</p>
<p CLASS="Textttext">Some run-time errors result from simple oversights when you enter code and can be easily fixed. Suppose, for example, that you want your application to disable the Details command button on the Orders form in the Orders sample application when the form opens. But instead of adding code in the form's Load event procedure that sets the control's <span CLASS="ElementNameeln">Enabled</span> property to <span CLASS="ElementNameeln">False</span>, you add code that tries to set the control's nonexistent <span CLASS="ElementNameeln">Locked</span> property to <span CLASS="ElementNameeln">True</span>.</p>
<p CLASS="CodeTextct">Forms!Orders!Details.Locked = True</p>
<p CLASS="Textttext">The code produces a run-time error when you open the Orders form, as shown in the following illustration.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0703.jpg"></p>
<p CLASS="Textttext">In this case, the solution is to fix the problem statement so that it uses the correct property and setting.</p>
<p CLASS="CodeTextct">Forms!Orders!Details.Enabled = False</p>
<p CLASS="Textttext">After you've changed the code that caused a run-time error, you can continue running your application from the point where execution was suspended. To continue running your application, click the<span CLASS="ElementNameeln"> Go/Continue</span> button <img SRC="..\images\CONTINU.gif">on the toolbar. The Orders form opens as expected with the Details command button disabled.
<p CLASS="Textttext">Some changes, most commonly changes in variable declarations, require the code to be reset. When this is the case, Visual Basic displays a message and gives you the option of continuing without the change or accepting the change and resetting the code.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba07_4.htm" OnClick="SyncURL(&quot;chapters/ba07_4.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
