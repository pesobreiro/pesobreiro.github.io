<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Arrays</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba04_5.htm" OnClick="SyncURL(&quot;chapters/ba04_5.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3Arrays"></a>
<p CLASS="heading3OrgHeading1h1">Arrays</p>
<p CLASS="Textttext">If you have programmed in other languages, you're probably familiar with the concept of <span CLASS="NewTermntrm">arrays</span>. You use arrays to refer to a series of variables by the same name while using a number (an index) to tell them apart. This helps you create smaller and simpler code in many situations because you can set up loops that deal efficiently with multiple cases by using the index number. Arrays have both upper and lower bounds, and the elements of the array are contiguous within those bounds. Because Visual Basic allocates space for each index number, avoid declaring an array larger than you need it to be.
<p CLASS="Textttext">All the elements in an array have the same data type. Of course, when the data type is <span CLASS="ElementNameeln">Variant</span>, the individual elements may contain different kinds of data (strings, numbers, date/time values, or objects). You can declare an array with any of the fundamental data types, including user-defined types, and object variables. </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on user-defined types, see <a HREF="../chapters/ba04_4.htm" OnClick="SyncURL(&quot;chapters/ba04_4.htm&quot;)">&quot;Creating Your Own Data Types&quot;</a> earlier in this chapter. For information on object types, see Chapter 5, <a HREF="../chapters/ba05_1.htm" OnClick="SyncURL(&quot;chapters/ba05_1.htm&quot;)">&quot;Working with Objects and Collections.&quot;</a></p>
<a NAME="4DeclaringFixedSizeArrays"></a>
<p CLASS="heading4OrgHeading2h2">Declaring Fixed-Size Arrays</p>
<p CLASS="Textttext">You can declare an ordinary (fixed-size) array in three ways, depending on the scope you want the array to have:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspTo create a <span CLASS="NewTermntrm">public array</span>, use the <span CLASS="ElementNameeln">Public</span> statement in the Declarations section of a module to declare the array.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspTo create a <span CLASS="NewTermntrm">module-level array</span>, use the <span CLASS="ElementNameeln">Private</span> or <span CLASS="ElementNameeln">Dim</span> statement in the Declarations section of a module to declare the array. </p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspTo create a <span CLASS="NewTermntrm">local array</span>, use the <span CLASS="ElementNameeln">Dim</span> or <span CLASS="ElementNameeln">Static</span> statement within a procedure to declare the array.</p>
<p CLASS="Textttext">There are additional rules when you create a <span CLASS="NewTermntrm">dynamic array</span> (an array whose size can change at run time). </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on dynamic arrays, see <a HREF="../chapters/ba04_6.htm#4DynamicArrays" OnClick="SyncURL(&quot;chapters/ba04_6.htm&quot;)">&quot;Dynamic Arrays&quot;</a> later in this chapter.</p>
<a NAME="5SettingUpperandLowerBounds"></a>
<p CLASS="heading5OrgHeading3h3">Setting Upper and Lower Bounds</p>
<p CLASS="Textttext">When declaring an array, follow the array name with the upper bound in parentheses. The upper bound must be a <span CLASS="ElementNameeln">Long</span> data type (in the range -2<span CLASS="Superscriptsup">31</span> to 2<span CLASS="Superscriptsup">31</span>). For example, the following array declarations can appear in the Declarations section of a module:</p>
<p CLASS="CodeTextct">Dim intCount(14) As Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Declares an array with 15<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' elements (0 through 14).<br>Dim dblSum(20) As Double&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Declares an array with 21<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' elements (0 through 20).</p>
<p CLASS="Textttext">To create a public array, you use <span CLASS="ElementNameeln">Public</span> in place of <span CLASS="ElementNameeln">Dim </span>(or<span CLASS="ElementNameeln"> Private</span>):</p>
<p CLASS="CodeTextct">Public intCount(14) As Integer<br>Public dblSum(20) As Double</p>
<p CLASS="Textttext">To create a local array, use the <span CLASS="ElementNameeln">Dim</span> (or <span CLASS="ElementNameeln">Static</span>)<span CLASS="ElementNameeln"> </span>statement:</p>
<p CLASS="CodeTextct">Dim intCount(14) As Integer<br>Static dblSum(20) As Double</p>
<p CLASS="Textttext">The first declaration creates an array with 15 elements, with index numbers running from 0 through 14. The second creates an array with 21 elements, with index numbers running from 0 through 20. The default lower bound is 0. However, you can change the default lower bound to 1 by placing the following <span CLASS="ElementNameeln">Option Base </span>statement in the Declarations section of a module:</p>
<p CLASS="CodeTextct">Option Base 1</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Option</span> <span CLASS="ElementNameeln">Base</span> statement, search the Help index for &quot;Option Base statement.&quot;</p>
<p CLASS="Textttext">Another way to specify the lower bound is to provide it explicitly by using the <span CLASS="ElementNameeln">To</span> keyword. For example:</p>
<p CLASS="CodeTextct">Dim intCount(1 To 15) As Integer<br>Dim dblSum(100 To 120) As Double</p>
<p CLASS="Textttext">In the preceding declarations, the index numbers of <span CLASS="CodeTextEmbeddedcte">intCount</span> run from 1 through 15 (15 elements), and the index numbers of <span CLASS="CodeTextEmbeddedcte">dblSum</span> run from 100 through 120 (21 elements).</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>With some versions of Basic, you can use an array without first declaring it. With Visual Basic, this isn't possible; you must declare an array before using it.</p>
<a NAME="4MultidimensionalArrays"></a>
<p CLASS="heading4OrgHeading2h2">Multidimensional Arrays</p>
<p CLASS="Textttext">With Visual Basic, you can declare arrays of up to 60 dimensions. For example, the following statement declares a two-dimensional 10-by-10 array within a procedure:</p>
<p CLASS="CodeTextct">Static dblMatrix(9, 9) As Double</p>
<p CLASS="Textttext">Either or both dimensions can be declared with explicit lower bounds:</p>
<p CLASS="CodeTextct">Static dblMatrix(1 To 10, 1 To 10) As Double</p>
<p CLASS="Textttext">You can extend this to more than two dimensions, as in the following example:</p>
<p CLASS="CodeTextct">Dim intMultiD(3, 1 To 10, 1 To 15) As Integer</p>
<p CLASS="Textttext">This declaration creates a three-dimensional 4-by-10-by-15 array. The total number of elements is the product of these three dimensions, or 600. </p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Because the total storage needed by the array increases dramatically when you start adding dimensions to it, be sure to use multidimensional arrays with care. Be especially careful with <span CLASS="ElementNameeln">Variant</span> arrays, because <span CLASS="ElementNameeln">Variant</span> arrays are larger than arrays containing other data types.</p>
<a NAME="4UsingLoopstoManipulateArrays"></a>
<p CLASS="heading4OrgHeading2h2">Using Loops to Manipulate Arrays</p>
<p CLASS="Textttext">Loops often provide an efficient way to manipulate arrays. For example, the following loop initializes all elements in the array to 5:</p>
<p CLASS="CodeTextct">Static intCount(1 To 15) As Integer<br>Dim intX As Integer<br>For intX = 1 To 15<br>&nbsp;&nbsp;&amp;nbspintCount(intX) = 5<br>Next intX</p>
<p CLASS="Textttext">You can efficiently process a multidimensional array by using nested <span CLASS="ElementNameeln">For</span> loops. For example, the following statements initialize every element in <span CLASS="CodeTextEmbeddedcte">dblMatrix</span> to a value based on its location in the array:</p>
<p CLASS="CodeTextct">Dim intX As Integer, intY As Integer<br>Static dblMatrix(1 To 10, 1 To 10) As Double<br>For intX = 1 To 10<br>&nbsp;&nbsp;&amp;nbspFor intY = 1 To 10<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspdblMatrix(intX, intY) = intX * 10 + intY<br>&nbsp;&nbsp;&amp;nbspNext intY<br>Next intX</p>
<a NAME="4DynamicArrays"></a>
<p CLASS="heading4OrgHeading2h2">Dynamic Arrays</p>
<p CLASS="Textttext">Sometimes you may not know exactly how large to make an array. You may want to be able to change the size of the array at run time.
<p CLASS="Textttext">A dynamic array can be resized at any time. Dynamic arrays are among the most flexible and convenient features in Visual Basic, and they help you to manage memory efficiently. For example, you can use a large array for a short time and then free up memory to the system when you're no longer using the array.
<p CLASS="Textttext">The alternative is to declare an array with the largest anticipated size and then to ignore array elements you don't need. However, if overused, this approach may cause Microsoft Access to run low on memory.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To create a dynamic array</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspDeclare the array with a <span CLASS="ElementNameeln">Public</span>,<span CLASS="ElementNameeln"> Private</span>,<span CLASS="ElementNameeln"> </span>or<span CLASS="ElementNameeln"> Dim </span>statement at the module level (if you want the array to be public or module-level), or with a <span CLASS="ElementNameeln">Static</span> or <span CLASS="ElementNameeln">Dim</span> statement at the procedure level (if you want the array to be local). You declare the array as dynamic by giving it an empty dimension list. For example:</p>
<p CLASS="ListCodeText1lct1">Dim intDynArray() As Integer
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspAllocate the actual number of elements with a <span CLASS="ElementNameeln">ReDim</span> statement. For example:</p>
<p CLASS="ListCodeText1lct1">ReDim intDynArray(intX + 1)
<p CLASS="Textttext">The <span CLASS="ElementNameeln">ReDim</span> statement can appear only in a procedure. Unlike the <span CLASS="ElementNameeln">Dim</span> and <span CLASS="ElementNameeln">Static</span> statements, <span CLASS="ElementNameeln">ReDim</span> makes the application carry out an action at run time.
<p CLASS="Textttext">The <span CLASS="ElementNameeln">ReDim</span> statement supports the same syntax as that used for fixed arrays. Each <span CLASS="ElementNameeln">ReDim</span> statement can change the number of elements, as well as the lower and upper bounds for each dimension. However, the number of dimensions in the array can't change from the number used in the first <span CLASS="ElementNameeln">ReDim</span> statement.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on array syntax, see <a HREF="../chapters/ba04_6.htm" OnClick="SyncURL(&quot;chapters/ba04_6.htm&quot;)">&quot;Arrays&quot;</a> earlier in this chapter.</p>
<p CLASS="Textttext">For example, you create the dynamic array <span CLASS="CodeTextEmbeddedcte">intMatrix</span> by first declaring it at the module level:</p>
<p CLASS="CodeTextct">Dim intMatrix() As Integer</p>
<p CLASS="Textttext">A function then allocates space for the array:</p>
<p CLASS="CodeTextct">Function CalcValuesNow () As Integer<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&amp;nbspReDim intMatrix(19, 29)<br>End Function</p>
<p CLASS="Textttext">The <span CLASS="ElementNameeln">ReDim</span> statement allocates a matrix of 20-by-30 integers (for a total size of 600 elements). Alternatively, the bounds of a dynamic array can be set by using variables:</p>
<p CLASS="CodeTextct">ReDim intMatrix(intX, intY)</p>
<a NAME="5PreservingtheContentsofDynamicArrays"></a>
<p CLASS="heading5OrgHeading3h3">Preserving the Contents of Dynamic Arrays</p>
<p CLASS="Textttext">It's important to note that each time you run the <span CLASS="ElementNameeln">ReDim</span> statement, all the values currently stored in the array are lost. Visual Basic resets the values to the <span CLASS="ElementNameeln">Empty </span>value (for <span CLASS="ElementNameeln">Variant</span> arrays), to zero (for numeric arrays), to a zero-length string (<span CLASS="CodeTextEmbeddedcte">&quot;&quot;</span>) (for string arrays), or to <span CLASS="ElementNameeln">Nothing</span> (for arrays of objects).
<p CLASS="Textttext">This is useful when you want to prepare the array for new data or when you want to shrink the size of the array to take up minimal memory. However, you may sometimes want to change the size of the array without losing the data in the array. You can do this by using the <span CLASS="ElementNameeln">ReDim</span> statement with the <span CLASS="ElementNameeln">Preserve</span> keyword. For example, you can enlarge an array by one element without losing the values of the existing elements, as shown in the following code:</p>
<p CLASS="CodeTextct">ReDim Preserve intMatrix(UBound(intMatrix) + 1)</p>
<p CLASS="Textttext">Only the upper bound of the last dimension in a multidimensional array can be changed when you use the <span CLASS="ElementNameeln">Preserve</span> keyword. If you change any of the other dimensions or the lower bound of the last dimension, a run-time error occurs. Therefore, you can use code as follows:</p>
<p CLASS="CodeTextct">ReDim Preserve intMatrix(10, UBound(intMatrix, 2) + 1)</p>
<p CLASS="Textttext">But you cannot use the following code:</p>
<p CLASS="CodeTextct">ReDim Preserve intMatrix(UBound(intMatrix, 1) + 1, 10)</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Preserve </span>keyword, search the Help index for &quot;ReDim statement.&quot;</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba05_1.htm" OnClick="SyncURL(&quot;chapters/ba05_1.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
