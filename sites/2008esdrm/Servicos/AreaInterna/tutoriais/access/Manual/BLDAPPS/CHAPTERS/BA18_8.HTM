<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Creating an External Table</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba18_7.htm" OnClick="SyncURL(&quot;chapters/ba18_7.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3CreatinganExternalTable"></a>
<p CLASS="heading3OrgHeading1h1">Creating an External Table</p>
<p CLASS="Textttext">You can create a table in the format of an external data source by creating a Microsoft Access table and exporting it. For example, you can create a table in Microsoft Access and export it as a Microsoft Excel worksheet. Microsoft Access creates a worksheet in Microsoft Excel that contains a copy of the data from your Microsoft Access table. Field names from the Microsoft Access table are placed in the first row of the worksheet.
<p CLASS="Textttext">You can create an external table by using either the Microsoft Access user interface or Visual Basic code.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To create an external table by using the Microsoft Access user interface</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspCreate the Microsoft Access table.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspIn the Database window, click the name of the table you want to export.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">File</span> menu, click <span CLASS="ElementNameeln">Save As/Export</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Save As</span> dialog box, click <span CLASS="ElementNameeln">To An External File Or Database</span>, and then click <span CLASS="ElementNameeln">OK</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Save As Type</span> box, click the type of data source you want.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">6</span>&nbsp;&nbsp;&amp;nbspSelect the drive and folder you want to export to.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">7</span>&nbsp;&nbsp;&amp;nbspDouble-click an existing file or enter a new name in the <span CLASS="ElementNameeln">File Name</span> box, and then click <span CLASS="ElementNameeln">Export</span>.</p>
<p CLASS="ListCautionText1lcat"><span CLASS="CautionHeadingcah">Caution&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">Usually, if you export to an existing file, Microsoft Access deletes and replaces the data in that file. The exceptions occur when you export to a Microsoft Excel version 5.0, 7.0, or 8.0 workbook, where data is copied to the next available worksheet.</span></p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To create an external table by using Visual Basic code</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOpen the database you want to create the table in. If it is the current database, use the <span CLASS="ElementNameeln">CurrentDb</span> function to return an object variable that represents the current database. If it isn't the current database, use the <span CLASS="ElementNameeln">OpenDatabase</span> method to open the database you want.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">CurrentDb</span> function to create a <span CLASS="ElementNameeln">Database</span> object that points to the current database.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">CreateTableDef</span> method of the <span CLASS="ElementNameeln">Database </span>object to create a table definition for the Microsoft Access table.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">CreateField</span> method of the <span CLASS="ElementNameeln">TableDef</span> object to create one or more fields in the Microsoft Access table.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">Append</span> method of the <span CLASS="ElementNameeln">Fields</span> collection to add the new field or fields to the Microsoft Access table.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">6</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">Append</span> method of the <span CLASS="ElementNameeln">TableDefs</span> collection to create the Microsoft Access table.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">7</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">TransferDatabase</span> method to create the external table in the specified folder.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">8</span>&nbsp;&nbsp;&amp;nbspUse the <span CLASS="ElementNameeln">Delete</span> method of the <span CLASS="ElementNameeln">TableDefs</span> collection to delete the Microsoft Access table definition.</p>
<p CLASS="Textttext">After you've created the table, you can access it from the table's native application or you can link or open it as you would any other external table. The following example creates a Microsoft Access table, uses it as the basis for a FoxPro table, and then links the new external FoxPro table to a Microsoft Access database.</p>
<p CLASS="CodeTextct">Public Sub CreateExternalFoxProTable()<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspDim tdfNewExternalDatabase As TableDef<br>&nbsp;&nbsp;&amp;nbspDim tdfTestNewTable As TableDef<br>&nbsp;&nbsp;&amp;nbspDim fldContactName As Field<br>&nbsp;&nbsp;&amp;nbspDim fldPhoneNumber As Field<br>&nbsp;&nbsp;&amp;nbspDim qdfInsertRecords As QueryDef<br>&nbsp;&nbsp;&amp;nbspDim rstCheckRecordCount As Recordset<br>&nbsp;&nbsp;&amp;nbspDim intNumRecords As Integer<br>&nbsp;&nbsp;&nbsp;' Create a Database object that points to the current database.<br>&nbsp;&nbsp;&amp;nbspSet dbs = CurrentDb<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Create a table definition for the Microsoft Access table that <br>&nbsp;&nbsp;&nbsp;' provides the structure information for the FoxPro table.<br>&nbsp;&nbsp;&amp;nbspSet tdfNewExternalDatabase = dbs.CreateTableDef(&quot;AccessTable&quot;)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Create two Text fields in the Microsoft Access table.<br>&nbsp;&nbsp;&amp;nbspSet fldContactName = tdfNewExternalDatabase.CreateField(&quot;Contact_name&quot;, dbText)<br>&nbsp;&nbsp;&amp;nbspfldContactName.Size = 30<br>&nbsp;&nbsp;&amp;nbspSet fldPhoneNumber = tdfNewExternalDatabase.CreateField(&quot;Phone_number&quot;, dbText)<br>&nbsp;&nbsp;&amp;nbspfldPhoneNumber.Size = 25<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Append the newly created fields to the Microsoft Access table.<br>&nbsp;&nbsp;&amp;nbsptdfNewExternalDatabase.Fields.Append fldContactName<br>&nbsp;&nbsp;&amp;nbsptdfNewExternalDatabase.Fields.Append fldPhoneNumber<br>&nbsp;&nbsp;&nbsp;' Append the TableDef to the TableDefs collection to create the table.<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Append tdfNewExternalDatabase<br>&nbsp;&nbsp;&nbsp;' Use the TransferDatabase method to export the Microsoft Access table's structure<br>&nbsp;&nbsp;&nbsp;' to a FoxPro table; this creates a new FoxPro table in the specified folder.<br>&nbsp;&nbsp;&amp;nbspDoCmd.TransferDatabase acExport, &quot;FoxPro 2.6&quot;,&quot;C:\FoxPro\Data&quot;, acTable, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;AccessTable&quot;,&quot;FoxTable&quot;<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Delete the TableDef for the Microsoft Access table.<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Delete &quot;AccessTable&quot;<br>&nbsp;&nbsp;&nbsp;' Link the new table and test it by inserting some records.<br>&nbsp;&nbsp;&amp;nbspSet tdfTestNewTable = dbs.CreateTableDef(&quot;FoxTable&quot;)<br>&nbsp;&nbsp;&amp;nbsptdfTestNewTable.Connect = &quot;FoxPro 2.6;DATABASE=C:\FoxPro\Data;&quot;<br>&nbsp;&nbsp;&amp;nbsptdfTestNewTable.SourceTableName = &quot;FoxTable&quot;<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Append tdfTestNewTable<br>&nbsp;&nbsp;&amp;nbspSet qdfInsertRecords = dbs.CreateQueryDef(&quot;Insert Records&quot;)<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.SQL = &quot;INSERT INTO FoxTable VALUES ('C. J. Date', '555-5050')&quot;<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.Execute<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.SQL = &quot;INSERT INTO FoxTable VALUES ('Roger Penrose', '333-5050')&quot;<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.Execute<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.SQL = &quot;INSERT INTO FoxTable VALUES ('Alan Turing', '011-56-5050')&quot;<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.Execute<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.SQL = &quot;INSERT INTO FoxTable VALUES ('Niklaus Wirth', '330-2430')&quot;<br>&nbsp;&nbsp;&amp;nbspqdfInsertRecords.Execute<br>&nbsp;&nbsp;&nbsp;' Count the records to ensure that four records were added.<br>&nbsp;&nbsp;&amp;nbspSet rstCheckRecordCount = tdfTestNewTable.OpenRecordset()<br>&nbsp;&nbsp;&amp;nbsprstCheckRecordCount.MoveLast<br>&nbsp;&nbsp;&amp;nbspintNumRecords = rstCheckRecordCount.RecordCount<br>&nbsp;&nbsp;&amp;nbspMsgBox &quot;Successfully added &quot; &amp; intNumRecords &amp; &quot; records.&quot;<br>&nbsp;&nbsp;&amp;nbsprstCheckRecordCount.Close<br>&nbsp;&nbsp;&amp;nbspdbs.Close<br>End Sub</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba18_9.htm" OnClick="SyncURL(&quot;chapters/ba18_9.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
