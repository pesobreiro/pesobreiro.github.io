<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Using the WebBrowser Control</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba21_4.htm" OnClick="SyncURL(&quot;chapters/ba21_4.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3UsingtheWebBrowserControl"></a>
<p CLASS="heading3OrgHeading1h1">Using the WebBrowser Control</p>
<p CLASS="Textttext">The Microsoft WebBrowser control is an ActiveX control that you can use on your application's forms to browse Web sites, view Web pages and other documents, and download data located on the Internet. The WebBrowser control is useful in situations where you don't want to disrupt the work flow in your application by switching from Microsoft Access to a Web browser or other document-viewing application.
<p CLASS="Textttext">The WebBrowser control can display any Web page that Microsoft Internet Explorer version 3.0 can display. For example, the WebBrowser control can display pages that include any of the following features:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspStandard HTML and HTML enhancements, such as floating frames and cascading style sheets</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspOther ActiveX controls</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspMost Netscape plug-ins</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspScripting, such as Microsoft Visual Basic Scripting Edition (VBScript) or JavaScript</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspJava<span CLASS="Trademarktm">&#153;</span> applets</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspMultimedia content, such as video and audio playback</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspThree-dimensional virtual worlds created with Virtual Reality Modeling Language (VRML)</p>
<p CLASS="Textttext">In addition to opening Web pages, the WebBrowser control can open any ActiveX document, which includes most Microsoft Office documents. For example, if Microsoft Office is installed on a user's computer, an application that uses the WebBrowser control can open and edit Microsoft Excel spreadsheets, Microsoft Word documents, and Microsoft PowerPoint presentations from within the control. Similarly, if Microsoft Excel Viewer, Microsoft Word Viewer, or Microsoft PowerPoint Viewer is installed, users can view those documents within the WebBrowser control.
<p CLASS="Textttext">With the WebBrowser control, users of your application can browse sites on the World Wide Web, as well as folders on a local hard disk and on a local area network. Users can follow hyperlinks by clicking them or by typing a URL into a text box. Also, the WebBrowser control maintains a history list that users can browse through to view previously browsed sites, folders, and documents.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Additional ActiveX controls that you can use to work with content on the Internet or an intranet are available in Microsoft Office 97, Developer Edition.</p>
<a NAME="4AddingtheWebBrowserControltoaForm"></a>
<p CLASS="heading4OrgHeading2h2">Adding the WebBrowser Control to a Form</p>
<p CLASS="Textttext">Before you can add the WebBrowser control to a form, you must have Microsoft Internet Explorer version 3.0 installed.
<p CLASS="Textttext">If you purchased Microsoft Access 97 on CD-ROM, you can install Microsoft Internet Explorer version 3.0 from the Iexplore subfolder in the ValuPack folder on the Setup CD-ROM. If you are running Windows 95, run Msie30.exe to install Microsoft Internet Explorer. If you are using Windows NT Workstation, run Msient30.exe.
<p CLASS="Textttext">If you purchased Microsoft Access 97 on floppy disks, or if you prefer to install from the Web, you can download and install Microsoft Internet Explorer version 3.0 from <a HREF="http://www.microsoft.com/ie/download/" TARGET="_top"><img SRC="..\images\external.gif" BORDER="0" HSPACE="0" VSPACE="0">http://www.microsoft.com/ie/download/</a>.
<p CLASS="Textttext">Once you have Microsoft Internet Explorer version 3.0 installed, the WebBrowser control is automatically registered and is available in form Design view.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To add the WebBrowser control to a form</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOpen the form in Design view.</p>

<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&nbsp;<img SRC="..\images\MORCNTRL.gif">&amp;nbspIn the toolbox, click the <span CLASS="ElementNameeln">More Controls</span> tool.</p>
<p CLASS="ListText1lt1">A menu appears that lists all the registered ActiveX controls in your system.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspOn the menu of ActiveX controls, click <span CLASS="ElementNameeln">WebBrowser Control</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspOn the form, click where you want to place the control.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&amp;nbspMove and size the control to the area you want to display.</p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>If the WebBrowser control can't display the full width or height of a Web page or document, it automatically displays scroll bars. However, in most cases, you should make the control wide enough to display the full width of a typical Web page so that users of your application don't have to scroll horizontally.</p>
<a NAME="4DisplayingWebPagesorDocumentsintheWebBrowserControl"></a>
<p CLASS="heading4OrgHeading2h2">Displaying Web Pages or Documents in the WebBrowser Control</p>
<p CLASS="Textttext">To display a Web page or document in the WebBrowser control, use the <span CLASS="ElementNameeln">Navigate</span> method in Visual Basic. The syntax for the <span CLASS="ElementNameeln">Navigate</span> method is:
<p CLASS="Textttext"><span CLASS="NewTermntrm">object</span>.<span CLASS="ElementNameeln">Navigate</span> <span CLASS="Placeholderp">URL</span>
<p CLASS="Textttext"><span CLASS="NewTermntrm">Object</span> is either the name of the WebBrowser control on your form or an object variable that refers to it, and <span CLASS="NewTermntrm">URL</span> is a string expression that evaluates to a valid URL or path. <span CLASS="NewTermntrm">URL</span> can refer to a Web page or other content on the Internet or an intranet, as well as to an Office document, such as a Microsoft Word document.
<p CLASS="Textttext">If <span CLASS="NewTermntrm">URL</span> refers to an Internet protocol and a location on the Internet, Microsoft Access must establish a connection before is can display the document. If the computer running your application is connected to a <span CLASS="NewTermntrm">proxy server</span> (a secure connection to the Internet through a LAN), or if it has a direct connection to the Internet, the WebBrowser control downloads and displays the Web page or other Internet content immediately. If the computer running your application uses a modem and dial-up connection to the Internet, and that connection hasn't been established beforehand, the WebBrowser control initiates the connection. For example, if the user's computer uses a modem and The Microsoft Network to connect to the Internet, the <span CLASS="ElementNameeln">Sign In</span> dialog box is displayed to establish the connection to the Internet before the WebBrowser control can display Internet content.
<p CLASS="Textttext">If <span CLASS="NewTermntrm">URL</span> refers to an Internet protocol and a location on an intranet server, the computer running your application must be connected to the intranet and have permission to access that server.
<p CLASS="Textttext">If <span CLASS="NewTermntrm">URL</span> refers to a standard file system path on a local hard drive or intranet, the WebBrowser control opens the document and displays it immediately. The WebBrowser control can open Microsoft Office documents, text files, and HTML documents that don't require features supported only by an Internet server. For example, the WebBrowser control can't open HTML documents that use IDC/HTX files or ActiveX Server (ASP) files from the standard file system, but it can open HTML documents that contain only the HTML tags supported by Microsoft Internet Explorer version 3.0.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If <span CLASS="NewTermntrm">URL </span>refers to a path in the standard file system that doesn't refer to a file name (for example, C:\Windows\System\), the WebBrowser control displays the file system itself, much like My Computer.</p>
<a NAME="5DisplayingaDocumentintheWebBrowserControlbyUsinganAddressinaTextBox"></a>
<p CLASS="heading5OrgHeading3h3">Displaying a Document in the WebBrowser Control by Using an Address in a Text Box</p>
<p CLASS="Textttext">Using the WebBrowser control, you can create a form that performs most of the functions of Microsoft Internet Explorer version 3.0. For example, the following illustration shows the Browse Web form in the Developer Solutions sample application.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC2104.jpg"></p>
<p CLASS="Textttext">When a user types a valid URL in the text box at the top of the form (<span CLASS="CodeTextEmbeddedcte">txtLinks</span>) and presses ENTER, the WebBrowser control (<span CLASS="CodeTextEmbeddedcte">ActiveXCtl1</span>) displays the Web page or document. Pressing ENTER triggers the AfterUpdate event of the <span CLASS="CodeTextEmbeddedcte">txtLinks</span> text box; the AfterUpdate event contains the following code which navigates to the URL entered by the user:</p>
<p CLASS="CodeTextct">Private Sub txtLinks_AfterUpdate()<br>On Error Resume Next<br>&nbsp;&nbsp;&amp;nbspIf Len(Me!txtLinks) &gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMe!ActiveXCtl1.Navigate Me!txtLinks<br>&nbsp;&nbsp;&amp;nbspEnd If<br>End Sub</p>
<p CLASS="Textttext">Error handling is passed to the control itself because it displays the same error messages displayed by Microsoft Internet Explorer version 3.0.
<p CLASS="Textttext">If you prefer to start navigation by clicking a command button instead pressing ENTER, you can use similar code in the button's Click event.
<p CLASS="Textttext">The Home, Back, Forward, Refresh, and Search buttons on the Browse Web form use the corresponding <span CLASS="ElementNameeln">GoHome</span>, <span CLASS="ElementNameeln">GoBack</span>, <span CLASS="ElementNameeln">GoForward</span>, <span CLASS="ElementNameeln">Refresh</span>, and <span CLASS="ElementNameeln">GoSearch</span> methods of the WebBrowser control.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on how to view brief descriptions about the properties, methods, and events of the WebBrowser control, see <a HREF="#4ViewingDescriptionsofthePropertiesMethodsandEventsoftheWebBrowserControl" OnClick="SyncURL(&quot;chapters/ba21_5.htm&quot;)">&quot;Viewing Descriptions of the Properties, Methods, and Events of the WebBrowser Control&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">With the Save Location button on the Browse Web form, you can save the address and a description of the current document to the Links table in the Developer Solutions database. When you click the Save Location button, Microsoft Access checks to see if the URL has been saved previously, and if not, uses the following statement to open the<span CLASS="ElementNameeln"> Save Location To Table</span> dialog box:</p>
<p CLASS="CodeTextct">DoCmd.OpenForm &quot;frmSaveURLDialog&quot;, acWindowNormal, , , acFormEdit, acDialog, _<br>&nbsp;&nbsp;&amp;nbspctlHyper.LocationName &amp; &quot;;&quot; &amp; ctlHyper.LocationURL</p>
<p CLASS="Textttext">The last argument of this statement (<span CLASS="CodeTextEmbeddedcte">ctlHyper.LocationName &amp; &quot;;&quot; &amp; ctlHyper.LocationURL</span>) sets the <span CLASS="ElementNameeln">OpenArgs</span> property to a concatenated string that contains the two values returned by the <span CLASS="ElementNameeln">LocationName</span> and <span CLASS="ElementNameeln">LocationURL</span> properties of the document currently displayed in the Browse Web form. When the <span CLASS="ElementNameeln">Save Location To Table</span> dialog box opens, code in its <span CLASS="ElementNameeln">Load</span> event parses the <span CLASS="ElementNameeln">OpenArgs</span> property value back into two parts and displays them as the default description and address. When the user clicks <span CLASS="ElementNameeln">OK</span>, the description and address in the <span CLASS="ElementNameeln"> Save Location To Table</span> dialog box form are saved in the Hyperlink and Description fields in the Links table.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the Browse Web form, open the Developer Solutions sample application located in the Samples subfolder of your Office folder.</p>
<a NAME="5DisplayingaDocumentintheWebBrowserControlbyUsingaHyperlinkStoredinaTable"></a>
<p CLASS="heading5OrgHeading3h3">Displaying a Document in the WebBrowser Control by Using a Hyperlink Stored in a Table</p>
<p CLASS="Textttext">Using the WebBrowser control, you can create a form that displays documents specified in hyperlinks stored in a table. For example, the following illustration shows the Browse Table form in the Developer Solutions sample application. You can use the Browse Table form to browse addresses saved in the Links table.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC2105.jpg"></p>
<p CLASS="Textttext">When a user clicks a record navigation button at the bottom of the form to move to a new record, code in the form's Current event displays the Web page or document whose address is stored in the current record.
<p CLASS="Textttext">If a user enters or edits data stored in a Hyperlink field from a datasheet or form, it may contain up to three parts of information separated by the pound sign (#). Even if the user doesn't enter all three parts in the datasheet or form, Microsoft Access automatically stores pound signs in the field. If there are pound signs in the Hyperlink field, you can't pass the data from the field directly to the <span CLASS="ElementNameeln">Navigate</span> method. To handle this, the code in the Browse Table form's Current event passes the stored value to a parsing function to separate the three parts, and then passes the appropriate URL to the <span CLASS="ElementNameeln">Navigate</span> method.
<p CLASS="Textttext">If you use code to enter the data stored in a Hyperlink field, as is done with the Save Location button on the Browse Web form, Microsoft Access doesn't automatically save pound signs in the field. However, because a user can edit the address displayed in the <span CLASS="ElementNameeln">Save Location To Table</span> dialog box, it's possible that a user familiar with the Hyperlink field's stored format could enter pound signs to delimit the display text, address, or subaddress.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>You don't have to store addresses in a Hyperlink field if you don't need users to be able to navigate to addresses by clicking them in datasheets or forms, or if you don't need to save addresses as HTML anchor tags when saving as HTML. As long as an address doesn't exceed 255 characters, you can store it in a Text field. If an address exceeds 255 characters, you can store it in a Memo field. In either case, you can pass the value stored in the field directly to the <span CLASS="ElementNameeln">Navigate</span> method.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the Browse Table form, open the Developer Solutions sample application located in the Samples subfolder of your Office folder. For more information on the format of data stored in a Hyperlink field, see <a HREF="../chapters/ba21_2.htm#5TheHyperlinkFieldStorageFormat" OnClick="SyncURL(&quot;chapters/ba21_2.htm&quot;)">&quot;The Hyperlink Field Storage Format&quot;</a> earlier in this chapter.</p>
<a NAME="4ViewingDescriptionsofthePropertiesMethodsandEventsoftheWebBrowserControl"></a>
<p CLASS="heading4OrgHeading2h2">Viewing Descriptions of the Properties, Methods, and Events of the WebBrowser Control</p>
<p CLASS="Textttext">Like built-in Microsoft Access objects, the WebBrowser control has properties that your application can set or read to determine the control's characteristics, methods that your application can use to perform operations on the control, and events your application can respond to. You can view brief descriptions of the properties, methods, and events of the WebBrowser control by using the Object Browser.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>In order for these properties, methods, and events to appear in the Object Browser, you must set a reference to the <span CLASS="ElementNameeln">Microsoft Internet and Shell Controls</span> object library. To set this reference, open a module, click <span CLASS="ElementNameeln">References</span> on the <span CLASS="ElementNameeln">Tools</span> menu, and select the <span CLASS="ElementNameeln">Microsoft Internet and Shell Controls</span> check box in the <span CLASS="ElementNameeln">Available References</span> box.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To view descriptions of the WebBrowser control's methods, properties, and events</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOpen a module.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspOn the <span CLASS="ElementNameeln">View</span> menu, click <span CLASS="ElementNameeln">Object Browser</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Project/Library</span> box, click <span CLASS="ElementNameeln">SHDocVw</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspIn the <span CLASS="ElementNameeln">Classes</span> box, click <span CLASS="ElementNameeln">WebBrowser</span>.</p>
<p CLASS="ListText1lt1">The <span CLASS="ElementNameeln">Members Of</span> box lists the methods, properties, and events associated with the WebBrowser control.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="NoteHeadingnh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the methods, properties, and events of the WebBrowser control, see <a HREF="http://www.microsoft.com/intdev/sdk/docs/iexplore/" TARGET="_top"><img SRC="..\images\external.gif" BORDER="0" HSPACE="0" VSPACE="0">http://www.microsoft.com/intdev/sdk/docs/iexplore/</a>. If you purchased Microsoft Access 97 on CD-ROM, you can view a Help file that contains this information by opening the \ValuPack\Access\Webhelp folder on the Setup CD-ROM, and then copying the Iexplore.hlp and Iexplore.cnt files to your hard disk.</p>
<a NAME="4DistributingtheWebBrowserControlwithYourApplication"></a>
<p CLASS="heading4OrgHeading2h2">Distributing the WebBrowser Control with Your Application</p>
<p CLASS="Textttext">Unlike most other ActiveX controls, you can't install the WebBrowser control by itself. For an application that uses the WebBrowser control to work, Microsoft Internet Explorer version 3.0 must also be installed on the computer. Microsoft Internet Explorer version 3.0 can be distributed freely, and doesn't require the payment of royalties or other licensing fees.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on installing Microsoft Internet Explorer version 3.0, see <a HREF="#4AddingtheWebBrowserControltoaForm" OnClick="SyncURL(&quot;chapters/ba21_5.htm&quot;)">&quot;Adding the WebBrowser Control to a Form&quot;</a> earlier in this chapter.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="APPA_1.HTM" OnClick="SyncURL(&quot;chapters/Appa_1.HTM&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
