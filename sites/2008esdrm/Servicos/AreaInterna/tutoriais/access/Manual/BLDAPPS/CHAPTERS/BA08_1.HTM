<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>CHAPTER 8</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba07_11.htm" OnClick="SyncURL(&quot;chapters/ba07_11.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<p CLASS="heading2ChapterNumberAppendixLetterchn">CHAPTER&nbsp; 8</p>
<p CLASS="ChapterAppendixTitlecht">Handling Run-Time Errors</p>
<p CLASS="ChapterSummaryTextchsum">Part of application development is to anticipate and plan for the errors users may encounter. While your application is running, external events that you can't prevent or may not anticipate are likely to occur. For example, files may be mistakenly deleted, disk drives can run out of space, and network drives sometimes disconnect unexpectedly. Such eventualities can cause <span CLASS="NewTermntrm">run-time errors</span> in your code, that is, errors that Microsoft Access can detect only when your application is running. To handle these errors, you need to add error-handling code to your procedures.
<a NAME="3ErrorsandErrorHandling"></a>
<p CLASS="heading3OrgHeading1h1">Errors and Error Handling</p>
<p CLASS="Textttext">In the world of programming, an error often isn't the same as a mistake. An error may be the result of an event or an operation that doesn't work out as expected, or the result of an attempt to carry out an impossible or invalid maneuver.
<p CLASS="Textttext">Often, you can anticipate the errors that users will encounter when they work with your application. You can shield users from these errors by including <span CLASS="NewTermntrm">error-handling</span> code, also known as <span CLASS="NewTermntrm">error trapping</span>, in your application. You don't have to use error handling in every procedure that you write, but it's a good idea to include it whenever your application interacts with something external, like the user's machine, a network, or a remote database. You should also use error handling when your application opens, updates, deletes, or adds a database record.
<p CLASS="Textttext">Error-handling code typically <span CLASS="NewTermntrm">traps</span> a run-time error by interrupting the default Microsoft Access response to the error and instead running code that you specify. Your application can correct the error, or give the user an opportunity to correct the error.
<p CLASS="Textttext"><span CLASS="Placeholderp">Run-time</span><span CLASS="NewTermntrm"> </span>errors occur when the application is actually running; other types of errors can occur under different circumstances. For example, a syntax error can occur when you enter code in the Module window, and a compile error can occur when you compile code. In Microsoft Access, however, you can trap only run-time errors.
<p CLASS="Textttext">Depending on where it occurs, you can handle a run-time error in one of two ways.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Where the error occurs</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">How to handle the error </p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Microsoft Access interface or <br>Microsoft Jet database engine</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Add error-handling code to the Error event procedure of a form or report.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Visual Basic</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Add an <span CLASS="ElementNameeln">On Error</span> statement and error-handling code to a procedure.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="Textttext">If your application uses Visual Basic code, you usually have to use both types of error handling.
<p CLASS="Textttext">Both types of error handling require that you identify each error you want to handle by its error code. You usually declare a constant to represent the numeric error code, and then use the constant to refer to the error. You can create an Errors table in Microsoft Access that contains the error codes and strings used or reserved by Visual Basic. Search the Help index for &quot;trapping errors,&quot; and then click <span CLASS="ElementNameeln">Determine the Error Codes Reserved by Visual Basic</span>. You can copy and paste the CreateErrorsTable procedure from this Help topic into a module. </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor information on using Visual Basic to create tables, see Chapter 5, <a HREF="../chapters/ba05_1.htm" OnClick="SyncURL(&quot;chapters/ba05_1.htm&quot;)">&quot;Working with Objects and Collections,&quot;</a> and Chapter 9, <a HREF="../chapters/ba09_1.htm" OnClick="SyncURL(&quot;chapters/ba09_1.htm&quot;)">&quot;Working with Records and Fields.&quot;</a></p>
<p CLASS="Textttext">After you create the Errors table, you can find the error code for an error by looking up its corresponding error message. To do so, open the Errors table, select the Error String column, click <span CLASS="ElementNameeln">Find</span> on the <span CLASS="ElementNameeln">Edit</span> menu, type the error message in the<span CLASS="ElementNameeln"> Find What</span> box, and then click<span CLASS="ElementNameeln"> Find First</span>. You can also base a query or report on the table, or sort the Error String column.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor a list of data access errors, search the Help index for &quot;errors, trapping,&quot; and then click <span CLASS="ElementNameeln">Trappable Data Access Errors</span>.</p>
<a NAME="4TheErrObjecttheErrorsCollectionandtheErrorFunction"></a>
<p CLASS="heading4OrgHeading2h2">The Err Object, the Errors Collection, and the Error Function</p>
<p CLASS="Textttext">Microsoft Access provides the <span CLASS="ElementNameeln">Err</span> object and the <span CLASS="ElementNameeln">Errors</span> collection to help you retrieve information about run-time errors in your applications, and regenerate errors when necessary. 
<p CLASS="Textttext">Microsoft Access uses the <span CLASS="ElementNameeln">Err</span> object to store information about the most recent run-time error that has occurred. When a run-time error occurs, the properties of the <span CLASS="ElementNameeln">Err</span> object are filled with information that uniquely identifies the error's number, description, and source. Depending on the type of error that is generated, you may also be able to obtain other information about the error.
<p CLASS="Textttext">You can also use the <span CLASS="ElementNameeln">Err</span> object to regenerate errors that have occurred in your application.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor information on regenerating errors with the <span CLASS="ElementNameeln">Err</span> object, see <a HREF="../chapters/ba08_3.htm#5TheRaiseMethod" OnClick="SyncURL(&quot;chapters/ba08_3.htm&quot;)">&quot;The Raise Method&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">The <span CLASS="ElementNameeln">Errors</span> collection is contained by the <span CLASS="ElementNameeln">DBEngine</span> object. It contains one <span CLASS="ElementNameeln">Error</span> object for each error that is generated by a single operation involving Data Access Objects (DAO). If multiple errors occur during a single operation, then the collection contains more than one <span CLASS="ElementNameeln">Error</span> object. When another operation generates an error or errors, the existing collection is cleared and refreshed with a new set of <span CLASS="ElementNameeln">Error</span> objects. Unlike other collections, the <span CLASS="ElementNameeln">Errors</span> collection doesn't append objects to existing objects as subsequent operations occur.
<p CLASS="Textttext">In addition to the <span CLASS="ElementNameeln">Error</span> object and the <span CLASS="ElementNameeln">Errors</span> collection, there is also an <span CLASS="ElementNameeln">Error</span> function. The <span CLASS="ElementNameeln">Error</span> function returns the error description that corresponds to a given error number. The <span CLASS="ElementNameeln">Error</span> function and the <span CLASS="ElementNameeln">Description</span> property of the <span CLASS="ElementNameeln">Err</span> object return the same value.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor more information about the <span CLASS="ElementNameeln">Err</span> object, the <span CLASS="ElementNameeln">Error </span>object, the <span CLASS="ElementNameeln">Errors </span>collection, or the <span CLASS="ElementNameeln">Error</span> function, search the Help index for the name of the object, collection, or function.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba08_2.htm" OnClick="SyncURL(&quot;chapters/ba08_2.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
