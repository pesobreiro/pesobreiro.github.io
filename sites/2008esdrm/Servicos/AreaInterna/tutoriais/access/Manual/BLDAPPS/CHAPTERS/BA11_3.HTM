<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Using OLE Objects</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba11_2.htm" OnClick="SyncURL(&quot;chapters/ba11_2.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3UsingOLEObjects"></a>
<p CLASS="heading3OrgHeading1h1">Using OLE Objects</p>
<p CLASS="Textttext">While you use Automation to work with the objects in another component's object model, you use OLE to include objects from other components in a Microsoft Access form or report. These objects are typically documents created by another component that supports OLE and are called OLE objects. A component that provides its documents to be linked or embedded in other components is called an <span CLASS="NewTermntrm">OLE server</span>. A component in which documents can be linked or embedded is called an <span CLASS="NewTermntrm">OLE container</span>. For example, you can embed a Microsoft Word document in a Microsoft Access form and the user can then edit this document in Microsoft Word. In this case, Microsoft Word is the OLE server, and Microsoft Access is the OLE container.
<p CLASS="Textttext">When you embed an OLE object, you store a copy of the document with your Microsoft Access application. You can also link an OLE object to your application. When you link an OLE object, your application stores only a link to the document that is the data source, not the document itself. The same OLE object can be linked to more than one application at a time. When you make changes to the linked document, the updated data is displayed in all of the applications that are linked to it.
<p CLASS="Textttext">There are several different ways to create an OLE object in your Microsoft Access application. To include OLE objects on a form or report, put them in either bound object frame controls or unbound object frame controls. Which type of control you choose depends on what you want to do with the OLE object. A <span CLASS="NewTermntrm">bound object frame</span> displays an OLE object that is stored as data in a table. An <span CLASS="NewTermntrm">unbound object frame</span> displays an OLE object that is not associated with data in a table.
<p CLASS="Textttext">OLE objects can be items of data in a database. For example, if your database includes an Employees table, you can save a photograph of each employee with their record. The photograph would be an OLE object, perhaps a bitmap file. Because the photograph is an item of data that is saved in the underlying table, it can be displayed in a bound object frame. You can find a similar example in the Employees form of the Northwind sample database.
<p CLASS="Textttext">OLE objects can also be unrelated to the data in a database. For example, your application may include a form that contains a Microsoft Word document with instructions for entering data in the database. If the Word document is a linked object, you can edit the file to which it is linked by double-clicking the OLE object to activate Microsoft Word, and then making changes to the data. The changes you make are then reflected on the form. An OLE object like this one would be displayed in an unbound object frame.
<p CLASS="Textttext">When you draw an unbound object frame on a form or report, Microsoft Access displays the <span CLASS="ElementNameeln">Insert Object</span> dialog box, where you can select what type of OLE object you want to include, and specify whether to create a new OLE object or use an existing OLE object. If you use an existing OLE object, you can specify whether it is to be linked or embedded. The <span CLASS="ElementNameeln">Insert Object</span> dialog box also appears when you click <span CLASS="ElementNameeln">Object</span> on the <span CLASS="ElementNameeln">Insert</span> menu. When you insert an OLE object by using this dialog box and you haven't already created the unbound object frame yourself, Microsoft Access draws an unbound object frame that contains the OLE object you have selected.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on object frames, search the Help index for &quot;object frames.&quot;</p>
<p CLASS="Textttext">The following illustration shows a Microsoft Access form that contains different OLE objects.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC1101.jpg"></p>
<p CLASS="Textttext">Each control provides a view of data from a different Windows-based component<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">drawing, word processor, spreadsheet, and chart<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">and each represents one OLE object.
<p CLASS="Textttext">You can create OLE objects in a Microsoft Access form or report without writing any Visual Basic code. However, if you want greater control over the OLE objects in your application, you can also work with them in Visual Basic. The following sections discuss how to work with OLE objects in code.</p>
<a NAME="4SettingPropertiesforOLEObjects"></a>
<p CLASS="heading4OrgHeading2h2">Setting Properties for OLE Objects</p>
<p CLASS="Textttext">To work with OLE objects in Visual Basic, you set properties for the bound and unbound object frame controls that contain the objects. The following table lists some properties that you can use when working with OLE objects in Visual Basic.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Property</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Description</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Action</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Indicates the operation to be performed on an OLE object, such as whether the object is to be embedded or linked. This property is available only at run time. For a list of constants you can use with this property, search the Help index for &quot;Action property.&quot;</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Class</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Identifies the component that supplied the OLE object and identifies the object type (for example, Word.Document or Excel.Sheet).</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">OLETypeAllowed</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Indicates whether a control can contain linked OLE objects, embedded OLE objects, or either type.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">SourceDoc</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Indicates the file to link to when creating a linked OLE object (for example, Sheet1.xls).</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">SourceItem</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Determines which portion of data within the file is to be linked.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="Textttext">The <span CLASS="ElementNameeln">Class</span>, <span CLASS="ElementNameeln">OLETypeAllowed</span>, <span CLASS="ElementNameeln">SourceDoc</span>, and <span CLASS="ElementNameeln">SourceItem</span> properties specify information Microsoft Access uses to create the OLE object. The <span CLASS="ElementNameeln">Action</span> property creates the OLE object by using this information, and thus should always be set after the other properties.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the<span CLASS="ElementNameeln"> Action</span>, <span CLASS="ElementNameeln">Class</span>, <span CLASS="ElementNameeln">OLETypeAllowed</span>, <span CLASS="ElementNameeln">SourceDoc</span>, and <span CLASS="ElementNameeln">SourceItem</span> properties, search the Help index for the name of the property.</p>
<a NAME="5CreatinganEmptyEmbeddedObject"></a>
<p CLASS="heading5OrgHeading3h3">Creating an Empty Embedded Object</p>
<p CLASS="Textttext">You can create an empty embedded OLE object in which the user can enter data. For example, you can embed an empty Microsoft Excel worksheet in a Microsoft Access form.
<p CLASS="Textttext">The following examples create a new embedded Microsoft Excel spreadsheet in an unbound object frame. To try these examples, first enter the following code in a standard module and save the module. This function creates a new form with an empty unbound object frame which you can use to try the examples in this section and the next section of this chapter.</p>
<p CLASS="CodeTextct">Function CreateFormWithFrame(strControlName As String)<br>&nbsp;&nbsp;&amp;nbspDim frm As Form, ctlFrame As Control, ctlCommand As Control<br>&nbsp;&nbsp;&amp;nbspDim intLeft As Integer, intRight As Integer<br>&nbsp;&nbsp;&amp;nbspSet frm = CreateForm<br>&nbsp;&nbsp;&amp;nbspSet ctlFrame = CreateControl(frm.Name, acObjectFrame)<br>&nbsp;&nbsp;&amp;nbspintLeft = ctlFrame.Left + ctlFrame.Width + 200<br>&nbsp;&nbsp;&amp;nbspintRight = 200<br>&nbsp;&nbsp;&amp;nbspSet ctlCommand = CreateControl(frm.Name, acCommandButton, , , , _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspintLeft, intRight)<br>&nbsp;&nbsp;&amp;nbspWith ctlCommand<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Name = strControlName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Caption = strControlName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OnClick = &quot;[Event Procedure]&quot;<br>&nbsp;&nbsp;&amp;nbspEnd With<br>&nbsp;&nbsp;&amp;nbspDoCmd.Restore<br>End Function</p>
<p CLASS="Textttext">Once you've saved this code, run it in the Debug window by entering the following line of code and pressing ENTER.</p>
<p CLASS="CodeTextct">CreateFormWithFrame(&quot;EmbedEmpty&quot;)</p>
<p CLASS="Textttext">Microsoft Access creates a new form with an unbound object frame and a command button named EmbedEmpty. Open the form module and enter the code in the following example. Then switch to Form view. When you click the EmbedEmpty button, Microsoft Access embeds a new, empty Microsoft Excel spreadsheet in the unbound object frame. You can double-click the spreadsheet to edit it.</p>
<p CLASS="CodeTextct">Private Sub EmbedEmpty_Click()<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control<br>&nbsp;&nbsp;&amp;nbspSet ctl = Me!OLEUnbound0<br>&nbsp;&nbsp;&amp;nbspWith ctl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Enable control.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Enabled = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set Locked property to False.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Locked = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Allow embedded objects only.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OLETypeAllowed = acOLEEmbedded<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Specify the OLE server and the type of object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Class = &quot;Excel.Sheet&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Create an embedded object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Action = acOLECreateEmbed<br>&nbsp;&nbsp;&amp;nbspEnd With<br>End Sub</p>
<p CLASS="Textttext">In the preceding example, the embedded object you create is a brand new OLE object that has not been saved to disk. You can't create a new linked object because a linked object must be a document that already exists in a file separate from your Microsoft Access database.</p>
<a NAME="5CreatinganOLEObjectfromaFile"></a>
<p CLASS="heading5OrgHeading3h3">Creating an OLE Object from a File</p>
<p CLASS="Textttext">You can create an OLE object from a file in Visual Basic. For example, you can embed an existing Microsoft Excel document in a Microsoft Access form.
<p CLASS="Textttext">To try this, create a Microsoft Excel worksheet called Revenue.xls, add some data to it, and save it in the My Documents folder. Next, run the following code in the Debug window to create a form with an unbound object frame and a command button named EmbedExisting. This code calls the CreateFormWithFrame function shown in the previous section.</p>
<p CLASS="CodeTextct">CreateFormWithFrame(&quot;EmbedExisting&quot;)</p>
<p CLASS="Textttext">Open the new form module and enter the code in the following example. Then switch to Form view. When you click the EmbedExisting button, Microsoft Access embeds the existing Microsoft Excel document Revenue.xls in the unbound object frame.</p>
<p CLASS="CodeTextct">Private Sub EmbedExisting_Click()<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&amp;nbspSet ctl = Me!OLEUnbound0<br>&nbsp;&nbsp;&amp;nbspWith ctl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Enable control.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Enabled = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set Locked property to False.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Locked = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Allow embedded objects only.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OLETypeAllowed = acOLEEmbedded<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Specify the OLE server and the type of object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Class = &quot;Excel.Sheet&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Specify the file to be embedded.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.SourceDoc = &quot;C:\My Documents\Revenue.xls&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Create the embedded object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Action = acOLECreateEmbed<br>&nbsp;&nbsp;&amp;nbspEnd With<br>End Sub</p>
<p CLASS="Textttext">To link the document rather than embed it, set the <span CLASS="ElementNameeln">OLETypeAllowed</span> property to <span CLASS="ElementNameeln">acOLELinked</span> and the <span CLASS="ElementNameeln">Action</span> property to <span CLASS="ElementNameeln">acOLECreateLink</span>. You can also change an embedded OLE object to a linked OLE object, or a linked OLE object to an embedded OLE object, by changing the settings of these two properties appropriately.
<p CLASS="Textttext">In the preceding example, setting the <span CLASS="ElementNameeln">Class</span> property for the OLE object is optional. If you don't set this property, Microsoft Access determines the appropriate setting based on the file name specified in the <span CLASS="ElementNameeln">SourceDoc</span> property.</p>
<a NAME="4ActivatinganOLEObjectinVisualBasic"></a>
<p CLASS="heading4OrgHeading2h2">Activating an OLE Object in Visual Basic</p>
<p CLASS="Textttext">When you open a linked or embedded document for editing, you <span CLASS="NewTermntrm">activate </span>the object. For example, you've probably already seen that when you double-click an embedded OLE object, the component in which that object was created opens so that you can edit the object. An advantage to working with OLE objects in Visual Basic is that you can control when and how an OLE object is activated, rather than leaving it up to the user.
<p CLASS="Textttext">You activate an OLE object in Visual Basic by setting its <span CLASS="ElementNameeln">Action</span> property to <span CLASS="ElementNameeln">acOLEActivate</span>. For example, you could set an OLE object's <span CLASS="ElementNameeln">Action </span>property within a command button's Click event procedure. When the user clicks the command button, the object is activated.
<p CLASS="Textttext">When you activate an OLE object, the object takes the operation specified by its verb. A <span CLASS="NewTermntrm">verb</span> specifies how an OLE object behaves when it's activated. For example, the verb determines whether the OLE object is opened for editing once it is activated. An OLE object can have a number of verbs. You specify which verb to use by setting the OLE object's <span CLASS="ElementNameeln">Verb</span> property.
<p CLASS="Textttext">The following example activates an embedded OLE object for editing. To try this example, create an unbound object frame named OLEUnbound0 on a form and embed a document, such as a Microsoft Word document. Add a command button named Activate to the form and add the following code to the command button's OnClick event procedure. Then switch to Form view. When you click the Activate button, the document is activated for editing.</p>
<p CLASS="CodeTextct">Private Sub Activate_Click()<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&amp;nbspSet ctl = Me!OLEUnbound0<br>&nbsp;&nbsp;&amp;nbspWith ctl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Enable control.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Enabled = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set Locked property to False.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Locked = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set Verb property to activate for editing.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Verb = acOLEVerbShow<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Activate object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Action = acOLEActivate<br>&nbsp;&nbsp;&amp;nbspEnd With<br>End Sub</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Action </span>property or the <span CLASS="ElementNameeln">Verb</span> property, search the Help index for &quot;Action property&quot; or &quot;Verb property.&quot;</p>
<a NAME="5ControllingHowaUserActivatesanOLEObject"></a>
<p CLASS="heading5OrgHeading3h3">Controlling How a User Activates an OLE Object</p>
<p CLASS="Textttext">The <span CLASS="ElementNameeln">AutoActivate</span> property determines what the user must do to activate an OLE object. The default setting for the <span CLASS="ElementNameeln">AutoActivate</span> property is Double-Click, which specifies that the user can double-click the OLE object to activate it. If you set this property to GetFocus, the object is activated as soon as the user selects or tabs to it. The GetFocus property setting is only available for unbound object frames. To activate an OLE object whose <span CLASS="ElementNameeln">AutoActivate</span> property is set to Manual, the user must select the object, point to the appropriate object type on the <span CLASS="ElementNameeln">Edit</span> menu, and then click one of the verbs listed on the submenu. To set this property in Visual Basic, use one of the following constants: <span CLASS="ElementNameeln">acOLEActivateDoubleClick</span>, <span CLASS="ElementNameeln">acOLEActivateGetFocus</span>, or <span CLASS="ElementNameeln">acOLEActivateManual</span>.
<p CLASS="Textttext">You can set both the <span CLASS="ElementNameeln">AutoActivate</span> and <span CLASS="ElementNameeln">Action</span> properties for an OLE object. For example, you can set the <span CLASS="ElementNameeln">AutoActivate</span> property to one of these constants to determine how the user may activate the object, and also set the <span CLASS="ElementNameeln">Action</span> property to activate the object during a particular event.
<p CLASS="Textttext">To prevent a user from activating an embedded OLE object by double-clicking it, you can change the setting of the <span CLASS="ElementNameeln">AutoActivate</span> property within the DblClick event of the bound or unbound object frame that contains the embedded object. For example, embed an OLE object in an unbound object frame on a form and enter the following code in the form module. Then switch to Form view. When you double-click the embedded OLE object, it is not activated.</p>
<p CLASS="CodeTextct">Private Sub OLEUnbound0_DblClick(Cancel As Integer)<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control<br>&nbsp;&nbsp;&amp;nbspSet ctl = Me!OLEUnbound0<br>&nbsp;&nbsp;&amp;nbspWith ctl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AutoActivate = acOLEActivateManual<br>&nbsp;&nbsp;&amp;nbspEnd With<br>End Sub</p>
<p CLASS="Textttext">You can then activate the OLE object from within a different event by setting the <span CLASS="ElementNameeln">Action</span> property to <span CLASS="ElementNameeln">acOLEActivate</span>, as shown in previous examples.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">AutoActivate</span> property, search the Help index for &quot;AutoActivate<span CLASS="ElementNameeln"> </span>property.&quot;</p>
<a NAME="5InPlaceActivation"></a>
<p CLASS="heading5OrgHeading3h3">In-Place Activation</p>
<p CLASS="Textttext">Some OLE objects can be activated from within the control that contains the object<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">a bound or unbound object frame. When such an object is activated, the user can edit the object, or perform some other action, without leaving Microsoft Access. For example, you could edit an embedded OLE object that was created in Microsoft Word without having to leave Microsoft Access. This feature is called <span CLASS="NewTermntrm">in-place activation.</span>
<p CLASS="Textttext">For an OLE object to be activated in place, the following must be true:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspThe object must have been created in an OLE server that supports in-place activation.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspThe object must be displayed in a bound or unbound object frame on a form that is open in Form view.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspThe bound or unbound object frame's <span CLASS="ElementNameeln">Enabled</span> property must be set to Yes.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If the <span CLASS="ElementNameeln">Locked</span> property of an embedded OLE object is set to Yes, you will be able to edit the object, but any changes that you make will be discarded when the object is deactivated. If the object is linked and not embedded, you can activate it in place, but you cannot edit it in place.</p>
<a NAME="5ReturninganOLEObjectsVerbs"></a>
<p CLASS="heading5OrgHeading3h3">Returning an OLE Object's Verbs</p>
<p CLASS="Textttext">The list of verbs an OLE object supports may vary, depending on the type of object and its current state. If you know which verbs an object supports, you can present a list of available actions to the user.
<p CLASS="Textttext">You can use the <span CLASS="ElementNameeln">Action</span>, <span CLASS="ElementNameeln">ObjectVerbsCount</span>, and <span CLASS="ElementNameeln">ObjectVerbs</span> properties to return the list of verbs supported by an OLE object. Setting the <span CLASS="ElementNameeln">Action </span>property to <span CLASS="ElementNameeln">acOLEFetchVerbs </span>populates the <span CLASS="ElementNameeln">ObjectVerbs </span>property with an array containing all the supported verbs. Because this is an array of string values, you can use the <span CLASS="ElementNameeln">ObjectVerbsCount</span> property to determine the number of elements in the array, and then return each verb value from the array one at a time. The <span CLASS="ElementNameeln">ObjectVerbsCount</span> property returns the number of verbs supported by the object, starting with 0.
<p CLASS="Textttext">For example, the following function returns the verbs supported by an OLE object displayed in a bound object frame or an unbound object frame.</p>
<p CLASS="CodeTextct">Function GetVerbs(ctl As Control) As Integer<br>&nbsp;&nbsp;&amp;nbspDim obj As Object<br>&nbsp;&nbsp;&amp;nbspDim intX As Integer, strGetVerb As String<br>&nbsp;&nbsp;&amp;nbspConst conNoOLEObject As Integer = 2771<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&amp;nbspOn Error GoTo ErrorHandler<br>&nbsp;&nbsp;&amp;nbspIf (ctl.ControlType = acObjectFrame) Or (ctl.ControlType = acBoundObjectFrame) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspctl.Action = acOLEFetchVerbs<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspFor intX = 0 To ctl.ObjectVerbsCount - 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspstrGetVerb = strGetVerb &amp; vbCrLf &amp; ctl.ObjectVerbs(intX)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspNext intX<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;Object Verbs for '&quot; &amp; ctl.Name &amp; &quot;':&quot; &amp; vbCrLf &amp; strGetVerb<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspGetVerbs = ctl.ObjectVerbsCount<br>&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;Control '&quot; &amp; ctl.Name &amp; &quot;' has no verbs and &quot; &amp; vbCrLf &amp; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; is not an OLE object.&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspExit Function<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&amp;nbspExit Function<br>ErrorHandler:<br>&nbsp;&nbsp;&amp;nbspIf Err = conNoOLEObject Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox Err &amp; &quot;: &quot; &amp; vbCrLf &amp; Err.Description<br>&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;Unknown error.&quot;<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&amp;nbspExit Function<br>End Function</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the <span CLASS="ElementNameeln">Action</span>, <span CLASS="ElementNameeln">ObjectVerbsCount</span>, and <span CLASS="ElementNameeln">ObjectVerbs</span> properties, search the Help index for the name of the property.</p>
<a NAME="4DeterminingWhenanOLEObjectIsUpdated"></a>
<p CLASS="heading4OrgHeading2h2">Determining When an OLE Object Is Updated</p>
<p CLASS="Textttext">Whenever the data in an OLE object has been modified, the Updated event occurs. This event returns a value telling you whether the data has been changed or saved by the component that created it. The Updated event also occurs when a file that an OLE object is linked to is closed or renamed, or when the source file that contains the linked object is closed or renamed.
<p CLASS="Textttext">For example, the following code determines what kind of update occurred and displays an appropriate message:</p>
<p CLASS="CodeTextct">Private Sub OLEUnbound0_Updated(Code As Integer)<br>&nbsp;&nbsp;&amp;nbspSelect Case Code<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acOLEChanged<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;OLE object file has been changed.&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acOLESaved<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;OLE object file has been saved.&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acOLEClosed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;OLE object file has been closed.&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspCase acOLERenamed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;OLE object file has been renamed.&quot;<br>&nbsp;&nbsp;&amp;nbspEnd Select<br>End Sub</p>
<p CLASS="Textttext">You can also use the <span CLASS="ElementNameeln">UpdateOptions</span> property to specify when a linked OLE object is updated. By default, the object is updated each time the linked data changes. You can change the property setting so that the object is updated each time any part of the linked document changes. When the <span CLASS="ElementNameeln">Action</span> property for the OLE object is set to <span CLASS="ElementNameeln">acOLEUpdate</span>, the OLE object is automatically updated. The <span CLASS="ElementNameeln">OLE/DDE Links</span> command (<span CLASS="ElementNameeln">Edit</span> menu) displays a dialog box where you can immediately update a linked OLE object or specify whether a linked OLE object is automatically updated.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the Updated event or the <span CLASS="ElementNameeln">UpdateOptions</span> property, search the Help index for &quot;Updated event&quot; or &quot;UpdateOptions property.&quot;</p>
<a NAME="4DisplayingtheInsertObjectandPasteSpecialDialogBoxes"></a>
<p CLASS="heading4OrgHeading2h2">Displaying the Insert Object and Paste Special Dialog Boxes</p>
<p CLASS="Textttext">You can use the <span CLASS="ElementNameeln">Action</span> property to display the <span CLASS="ElementNameeln">Insert Object</span> or <span CLASS="ElementNameeln">Paste Special</span> dialog box to a user. The <span CLASS="ElementNameeln">Insert Object</span> dialog box presents a list of available OLE object types and creates an OLE object based on the user's selection. The <span CLASS="ElementNameeln">Paste Special</span> dialog box allows the user to paste an OLE object, or part of an OLE object<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">such as a certain range of cells from a spreadsheet<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">from the Clipboard into a control.
<p CLASS="Textttext">To display the <span CLASS="ElementNameeln">Insert Object</span> or <span CLASS="ElementNameeln">Paste Special</span> dialog box at run time, set the <span CLASS="ElementNameeln">Action</span> property to a defined constant. To display the <span CLASS="ElementNameeln">Insert Object</span> dialog box, set the <span CLASS="ElementNameeln">Action</span> property to <span CLASS="ElementNameeln">acOLEInsertObjDlg</span>; to display the <span CLASS="ElementNameeln">Paste Special</span> dialog box, set the <span CLASS="ElementNameeln">Action</span> property to <span CLASS="ElementNameeln">acOLEPasteSpecialDlg</span>. You can check the setting of the <span CLASS="ElementNameeln">OLEType</span> property to determine what type of OLE object is in a control.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">OLEType property setting</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Control contents</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">acOLELinked</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Linked object</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">acOLEEmbedded</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Embedded object</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">acOLENone</span></p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">No object</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="Textttext">For example, create a form with two command buttons, InsertObject and PasteSpecial. For both command buttons, set the <span CLASS="ElementNameeln">OnClick</span> event property to [Event Procedure], then enter the following code in the form module. When the user clicks one of the buttons, Microsoft Access displays the appropriate dialog box.</p>
<p CLASS="CodeTextct">Private Sub InsertObject_Click()<br>&nbsp;&nbsp;&amp;nbspOn Error GoTo Err_InsertError<br>&nbsp;&nbsp;&nbsp;' Display Insert Object dialog box.<br>&nbsp;&nbsp;&amp;nbspMe!OLEUnbound0.Action = acOLEInsertObjDlg<br>&nbsp;&nbsp;&amp;nbspExit Sub<br>Err_InsertError:<br>&nbsp;&nbsp;&amp;nbspMsgBox &quot;Insert operation not completed.&quot;<br>&nbsp;&nbsp;&amp;nbspResume Next<br>End Sub<br>Private Sub PasteSpecial_Click()<br>&nbsp;&nbsp;&amp;nbspOn Error GoTo Err_PasteError<br>&nbsp;&nbsp;&nbsp;' Display Paste Special dialog box.<br>&nbsp;&nbsp;&amp;nbspMe!OLEUnbound0.Action = acOLEPasteSpecialDlg<br>&nbsp;&nbsp;&amp;nbspExit Sub<br>Err_PasteError:<br>&nbsp;&nbsp;&amp;nbspMsgBox &quot;Paste operation not completed.&quot;<br>&nbsp;&nbsp;&amp;nbspResume Next<br>End Sub</p>
<a NAME="4UsingtheObjectProperty"></a>
<p CLASS="heading4OrgHeading2h2">Using the Object Property</p>
<p CLASS="Textttext">As discussed earlier in this chapter, some components that support Automation also support OLE. For example, Microsoft Excel supports both. Using Visual Basic in Microsoft Access, you can work with the objects in the Microsoft Excel object model. You can also link or embed Microsoft Excel files in Microsoft Access forms and reports.
<p CLASS="Textttext">If you've embedded or linked a document created in a component that also supports Automation, such as Microsoft Excel, you can work with objects associated with that document much as you would if you were performing Automation. You can use the <span CLASS="ElementNameeln">Object</span> property to set and retrieve the properties of an object and apply its methods. The <span CLASS="ElementNameeln">Object</span> property returns an object reference to an Automation object that is related to the linked or embedded document.
<p CLASS="Textttext">To illustrate this concept, create a Microsoft Excel spreadsheet with some data in the first worksheet and embed the .xls document in an unbound object frame named OLEUnbound0 on a form. Create a button named EditSpreadsheet on the form, set its <span CLASS="ElementNameeln">OnClick</span> event property to [Event Procedure], and enter the following code into the form module. When the user clicks on the EditSpreadsheet button, the Microsoft Excel worksheet is activated and the data in cells in the first row is formatted in bold.</p>
<p CLASS="CodeTextct">Private Sub EditSpreadsheet_Click()<br>&nbsp;&nbsp;&amp;nbspDim ctl As Control, wks As Excel.Worksheet<br>&nbsp;&nbsp;&amp;nbspDim intI As Integer<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;' Return reference to control containing OLE object.<br>&nbsp;&nbsp;&amp;nbspSet ctl = Me!OLEUnbound0<br>&nbsp;&nbsp;&nbsp;' Activate OLE object.<br>&nbsp;&nbsp;&amp;nbspctl.Action = acOLEActivate<br>&nbsp;&nbsp;&nbsp;' Return reference to embedded Worksheet object.<br>&nbsp;&nbsp;&amp;nbspSet wks = ctl.Object.Application.Workbooks(1).Worksheets(1)<br>&nbsp;&nbsp;&nbsp;' Initialize integer variable to 1.<br>&nbsp;&nbsp;&amp;nbspintI = 1<br>&nbsp;&nbsp;&nbsp;' Check whether there is data in cells in first row.<br>&nbsp;&nbsp;&amp;nbspDo Until IsEmpty(wks.Cells(1, intI).Value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Set font to bold.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspwks.Cells(1, intI).Font.Bold = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Increment integer variable.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspintI = intI + 1<br>&nbsp;&nbsp;&amp;nbspLoop<br>End Sub</p>
<p CLASS="Textttext">In this example, the <span CLASS="ElementNameeln">Object</span> property returns an object reference to the <span CLASS="ElementNameeln">Worksheet</span> object that represents the embedded Microsoft Excel worksheet. Once you have a reference to a <span CLASS="ElementNameeln">Worksheet</span> object, you can set and retrieve its properties and apply its methods through Automation.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba11_4.htm" OnClick="SyncURL(&quot;chapters/ba11_4.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
