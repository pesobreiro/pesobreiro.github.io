<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Changes to Your Database</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba20_3.htm" OnClick="SyncURL(&quot;chapters/ba20_3.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3ChangestoYourDatabase"></a>
<p CLASS="heading3OrgHeading1h1">Changes to Your Database</p>
<p CLASS="Textttext">When you convert a database to a Design Master, Microsoft Jet:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspAdds new fields to each existing table in your database.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspAdds new tables to your database.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspAdds new properties to your database.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspChanges the behavior of AutoNumber fields.</p>
<p CLASS="Textttext">Microsoft Jet uses these changes to track modifications to your database's design and data and to efficiently synchronize your database with other replicas in the replica set.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>The addition of three new fields to your tables adds to the size of each record, and the addition of new system tables adds to the size of your database. Many of these new tables contain only a few records, but some of the new tables can grow significantly depending upon the frequency of synchronization between replicas. To reclaim unused space, compact your database frequently. For more information, see <a HREF="../chapters/ba20_9.htm" OnClick="SyncURL(&quot;chapters/ba20_9.htm&quot;)">&quot;Compacting a Replicated Database&quot;</a> later in this chapter.</p>
<a NAME="4NewFields"></a>
<p CLASS="heading4OrgHeading2h2">New Fields</p>
<p CLASS="Textttext">When you convert a database to a Design Master, Microsoft Jet first looks at the existing fields in a table to determine if any field uses both the AutoNumber data type and the Replication ID field size. The Replication ID AutoNumber is a 16-byte value that appears in the following format:
<p CLASS="Textttext">{1234AB87-2314-7623-0000012340506801}
<p CLASS="Textttext">If no field uses that data type and field size, Microsoft Jet adds the s_GUID field to the table. The s_GUID field stores the Replication ID AutoNumber value that uniquely identifies each record. The Replication ID AutoNumber value for a specific record is identical across all replicas.
<p CLASS="Textttext">During the conversion process, Microsoft Jet also adds fields called s_Lineage and s_Generation to each table in the database. The s_Lineage field contains the value of the <span CLASS="ElementNameeln">ReplicaID</span> property of replicas that have updated a record and the last version created by each of those replicas. The s_Generation field stores information about groups of changes. Microsoft Jet also adds a field for every Memo and OLE Object field in a table.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The s_GUID, s_Lineage, and s_Generation system fields may or may not be visible, depending on whether the <span CLASS="ElementNameeln">System Objects</span> check box on the <span CLASS="ElementNameeln">View</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu) is selected or cleared.</p>
<p CLASS="Textttext">Generally, there is a single field per record that stores information about changes. However, to optimize synchronizations for databases that contain Memo or OLE Object fields (sometimes referred to as a BLOBs, or binary large objects), an extra field is associated with each BLOB. If the BLOB is modified, this field value is set to 0 so that the BLOB is sent during the next synchronization. If other fields in the record are modified, but not the BLOB, the field value isn't set to 0 and the BLOB isn't sent.
<p CLASS="Textttext">This extra field is named Gen<span CLASS="NewTermntrm">_FieldName</span>, where <span CLASS="NewTermntrm">FieldName</span> is the BLOB field's name (truncated, if necessary). One of these fields is set for each BLOB field.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on the s_GUID, s_Lineage, s_Generation, and Gen<span CLASS="NewTermntrm">_FieldName</span> fields, search the Help index for the name of the field.</p>
<a NAME="4NewTables"></a>
<p CLASS="heading4OrgHeading2h2">New Tables</p>
<p CLASS="Textttext">When you convert a database to a Design Master, Microsoft Jet adds several new tables to the database. Most of these tables are system tables, which are not normally visible to users and cannot be manipulated by developers. The following table describes a few of the tables that are of the most interest to you as a developer.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Name</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Description</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">MSysSidetables</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Identifies the names of tables that experienced a conflict and the name of the table that contains the conflicting records. MSysSidetables is visible only if a conflict has occurred between the user's replica and another replica in the set. </p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">MSysErrors</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Identifies where and why errors occurred during data synchronization.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">MSysSchemaProb</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Identifies errors that occurred while synchronizing the design of the replica. This table is visible only if a design conflict has occurred between the user's replica and another replica in the set.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">MSysExchangeLog</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Stores information about synchronizations that have taken place between replicas.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="Textttext">To view these four tables (and the other system tables), select the <span CLASS="ElementNameeln">System Objects</span> check box on the <span CLASS="ElementNameeln">View</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on these tables, search the Help index for the name of the table.</p>
<a NAME="4NewProperties"></a>
<p CLASS="heading4OrgHeading2h2">New Properties</p>
<p CLASS="Textttext">When you convert a database to a Design Master, Microsoft Jet adds new properties to it:<span CLASS="ElementNameeln"> ReplicaID</span>,<span CLASS="ElementNameeln"> ReplicableBool</span>, and <span CLASS="ElementNameeln">DesignMasterID</span>.
<p CLASS="Textttext">The <span CLASS="ElementNameeln">ReplicaID </span>property contains the value that uniquely identifies the replica or Design Master. Microsoft Jet automatically generates this value when you create a new replica.
<p CLASS="Textttext">During the conversion process, the <span CLASS="ElementNameeln">ReplicableBool </span>property is set to <span CLASS="ElementNameeln">True</span>, indicating that the database can now be replicated. Once this property is set to <span CLASS="ElementNameeln">True</span>, it cannot be changed. If you change the property setting to <span CLASS="ElementNameeln">False</span> (or to any value other than <span CLASS="ElementNameeln">True</span>), Microsoft Jet returns an error message.
<p CLASS="Textttext">You can use the <span CLASS="ElementNameeln">DesignMasterID</span> property to make another replica the Design Master. Set this property only in the current Design Master replica. Under extreme circumstances<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">for example, the loss of the original Design Master replica<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">you can set this property in the current replica. If you set this property in a replica when there is already another Design Master replica, you may prevent any further synchronization of data.</p>
<p CLASS="CautionTextcat"><span CLASS="CautionHeadingcah">Caution&nbsp;&nbsp;&nbsp;</span>Never create a second Design Master in a replica set. A second Design Master replica can result in the loss of data.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on these properties, search the Help index for the name of the property.</p>
<a NAME="4BehaviorofAutoNumberFields"></a>
<p CLASS="heading4OrgHeading2h2">Behavior of AutoNumber Fields</p>
<p CLASS="Textttext">When you convert a database to a Design Master, the AutoNumber fields in your tables change from incremental to random numbering. All existing AutoNumber fields retain their values, but new values for inserted rows are random numbers. Random AutoNumber fields are not meaningful because they aren't in any particular order and the highest value isn't on the row inserted last. When you open a table with a random AutoNumber field as the primary key, the records appear in the order of ascending random numbers, not in insertion order. With random AutoNumber fields, it is possible for two different records to be assigned the same value, although the probability of this happening is very low. If this happens, updates could be made in incorrect records. To prevent such problems, consider using the s_GUID field as the primary key. Because all numbers in the s_GUID field are unique, each record has a different AutoNumber value.
<p CLASS="Textttext">Before you convert your database to a Design Master, determine if any of your applications or users rely on the order and incremental nature of the AutoNumber field. If so, you can use an additional Date/Time field to provide sequential ordering information.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba20_5.htm" OnClick="SyncURL(&quot;chapters/ba20_5.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
