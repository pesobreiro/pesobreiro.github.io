<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Using Error Events</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba08_1.htm" OnClick="SyncURL(&quot;chapters/ba08_1.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3UsingErrorEvents"></a>
<p CLASS="heading3OrgHeading1h1">Using Error Events</p>
<p CLASS="Textttext">You can handle run-time errors that trigger an Error event by adding code to a form or report's Error event procedure. The Error event is triggered by any run-time error that is generated either in the Microsoft Access interface or by the Microsoft Jet database engine. The Error event won't trap errors in your Visual Basic code. To handle run-time errors generated by Visual Basic, use <span CLASS="ElementNameeln">On Error</span> statements.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor information on the Error event<span CLASS="NewTermntrm">,</span> search the Help index for &quot;Error event.&quot; For information on handling Visual Basic run-time errors, see <a HREF="../chapters/ba08_3.htm" OnClick="SyncURL(&quot;chapters/ba08_3.htm&quot;)">&quot;Using On Error Statements&quot;</a> later in this chapter.</p>
<p CLASS="Textttext">For example, the Orders form in the Orders sample application includes code in its Error event procedure to handle the error that is generated if Microsoft Access tries to save a record that doesn't have an EmployeeID or CustomerID value. When Microsoft Access generates this error, the Form_Error procedure traps it and displays a custom dialog box.</p>
<p CLASS="CodeTextct">Private Sub Form_Error(DataErr As Integer, Response As Integer)<br>' If error is due to a broken join (missing CustomerID), display a<br>' message telling the user what's missing and how to cancel the order.<br>&nbsp;&nbsp;&amp;nbspConst conErrBrokenJoin = 3101<br>&nbsp;&nbsp;&amp;nbspIf DataErr = conErrBrokenJoin Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox &quot;Every order must have a customer for billing. &quot; &amp; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Select a company name in the Bill To list, or to &quot; &amp; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;cancel the order, click Undo Current Field/Record &quot; &amp; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;on the Edit menu.&quot;, vbExclamation<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspForms!Orders.SetFocus<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspBillTo.SetFocus<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspResponse = acDataErrContinue<br>&nbsp;&nbsp;&amp;nbspEnd If<br>End Sub</p>
<p CLASS="Textttext">When an error triggers an Error event in the Orders form, Microsoft Access runs the Form_Error procedure and passes the error code for the error to the procedure's DataErr argument. For example, if you enter a new record, but neglect to enter a value in the Salesperson box (EmployeeID field), then try to move to the next record, Microsoft Access:</p>
<p CLASS="ListSequentialItem1ls">1.&nbsp;&amp;nbspGenerates error code 3101, indicating a broken table join.</p>
<p CLASS="ListSequentialItem1ls">2.&nbsp;&amp;nbspRuns the Form_Error procedure, assigning error code 3101 to the DataErr argument.</p>
<p CLASS="Textttext">The procedure declares the constant conErrBrokenJoin, which represents error code 3101, for the broken join error.
<p CLASS="Textttext">The <span CLASS="ElementNameeln">If</span> statement then uses this constant to test whether the DataErr argument matches this error code. If it does, the procedure traps the error and displays a custom dialog box so the user can correct the problem by entering a value. It then sets the procedure's Response argument to <span CLASS="ElementNameeln">acDataErrContinue</span>, which causes Microsoft Access to continue execution without displaying the standard Microsoft Access error message.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>Because this error-handling code relies on the DataErr argument of the Error event procedure, you can do this kind of error trapping only in an event procedure. You can't trap an error by specifying a macro as an <span CLASS="ElementNameeln">OnError</span> property setting for a form or report.</p>
<p CLASS="Textttext">You can often use an Error event procedure in this way to display a custom message that is more meaningful to your application's users than a standard Microsoft Access error message.
<p CLASS="Textttext">You can also add code to the Error event procedure to either take some action to correct the error, or to give the user an opportunity to correct it. For example, in a multiuser environment, an Error event procedure can handle common locking conflicts, such as those that occur when one user attempts to update data or save a record that is locked by another user. You can add error-handling code to the procedure to automatically retry an operation that has failed because of a locking conflict, or to display a custom dialog box that gives users the choice of retrying or canceling the operation.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also</span>&nbsp;&nbsp;&amp;nbspFor information on handling errors in a multiuser environment, see Chapter 10, <a HREF="../chapters/ba10_1.htm" OnClick="SyncURL(&quot;chapters/ba10_1.htm&quot;)">&quot;Creating Multiuser Applications.&quot;</a></p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba08_3.htm" OnClick="SyncURL(&quot;chapters/ba08_3.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
