<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Replicating Your Database</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba20_2.htm" OnClick="SyncURL(&quot;chapters/ba20_2.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3ReplicatingYourDatabase"></a>
<p CLASS="heading3OrgHeading1h1">Replicating Your Database</p>
<p CLASS="Textttext">To make replicas of your database, you first convert it to a Design Master. The Design Master becomes the first replica of the new replica set. As you make additional replicas from the Design Master, they are added to the set. You can have only one Design Master in a replica set. If you want to make changes to the tables, queries, forms, reports, macros, or modules, you make those changes in the Design Master. This prevents users at multiple replicas from making conflicting changes to the database's design and objects.
<p CLASS="Textttext">You can convert a database to a Design Master in one of three ways:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspUse the <span CLASS="ElementNameeln">Create Replica</span> command (<span CLASS="ElementNameeln">Tools</span> menu, <span CLASS="ElementNameeln">Replication</span> submenu) in Microsoft Access.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspDrag the database file to the My Briefcase icon.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspUse DAO in your Visual Basic code, as described in the following section <a HREF="#4UsingDAOtoReplicateaDatabase" OnClick="SyncURL(&quot;chapters/ba20_3.htm&quot;)">&quot;Using DAO to Replicate a Database.&quot;</a></p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>If you protect a database with a database password, you can't sychronize replicas of that database. Before you begin using replication, remove any database password protection from the database. Setting permissions with Microsoft Access security does not interfere with synchronization. In addition, replicated objects retain the permissions that you give them in the Design Master.</p>
<a NAME="4UsingDAOtoReplicateaDatabase"></a>
<p CLASS="heading4OrgHeading2h2">Using DAO to Replicate a Database</p>
<p CLASS="Textttext">If you want to customize your replication system, you can use DAO to replicate your database.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To replicate a database by using DAO</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOpen the database you want to replicate with exclusive access.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspIdentify the objects in the database you don't want replicated and set their <span CLASS="ElementNameeln">KeepLocal</span> property to <span CLASS="CodeTextEmbeddedcte">&quot;T&quot;</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspMake your database a Design Master by setting its <span CLASS="ElementNameeln">ReplicableBool </span>property to <span CLASS="ElementNameeln">True</span>.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspMake additional replicas from the Design Master by using the <span CLASS="ElementNameeln">MakeReplica</span> method.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>Before you use the <span CLASS="ElementNameeln">KeepLocal</span> and <span CLASS="ElementNameeln">ReplicableBool </span>properties, create and append them to the <span CLASS="ElementNameeln">Properties</span> collection of the object. If you try to refer to these properties in your code before you create and append them, a run-time error occurs. For <span CLASS="ElementNameeln">TableDef</span> and <span CLASS="ElementNameeln">QueryDef</span> objects, you create and append the property to the object's <span CLASS="ElementNameeln">Properties</span> collection. For forms, reports, macros, and modules, you create and append the properties to the <span CLASS="ElementNameeln">Properties</span> collection of the <span CLASS="ElementNameeln">Document</span> object that represents the database object.</p>
<a NAME="5KeepingObjectsLocal"></a>
<p CLASS="heading5OrgHeading3h3">Keeping Objects Local</p>
<p CLASS="Textttext">When you convert a database to a Design Master, all of the objects in the database are converted to objects you can replicate. If you don't want all objects in your database copied throughout the replica set, you can append and set the <span CLASS="ElementNameeln">KeepLocal</span> property on any objects you don't want replicated. You must do this before you convert the database to a Design Master. For example, if your database has a table that contains confidential personnel information, such as salaries, you can set that table's <span CLASS="ElementNameeln">KeepLocal</span> property to <span CLASS="CodeTextEmbeddedcte">&quot;T&quot;</span> to keep it local while all other objects are replicated.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The object on which you are setting the <span CLASS="ElementNameeln">KeepLocal</span> property may have already inherited that property from another object. However, the value set by the other object has no affect on the behavior of the object you want to keep local<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">you must directly set the property for each object.</p>
<p CLASS="Textttext">If you try to set the <span CLASS="ElementNameeln">KeepLocal</span> property and the property has not already been appended or inherited, you get an error. The following example sets the <span CLASS="ElementNameeln">KeepLocal</span> property to <span CLASS="CodeTextEmbeddedcte">&quot;T&quot;</span> and includes an error handler in case the &quot;Property does not exist&quot; error occurs. If called, the error handler both appends and sets the property.</p>
<p CLASS="CodeTextct">Sub SetKeepLocal(objParent As Object)<br>&nbsp;&nbsp;&amp;nbspConst errPropNotFound = 3270<br>&nbsp;&nbsp;&amp;nbspOn Error GoTo KeepLocalPropHndlr<br>&nbsp;&nbsp;&amp;nbspobjParent.Properties(&quot;KeepLocal&quot;).Value = &quot;T&quot;<br>&nbsp;&nbsp;&amp;nbspExit Sub<br>KeepLocalPropHndlr:<br>&nbsp;&nbsp;&amp;nbspIf (Err = errPropNotFound) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Create and append the KeepLocal property if it does<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' not already exist.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspobjParent.Properties.Append _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspobjParent.CreateProperty(&quot;KeepLocal&quot;, dbText, &quot;T&quot;)<br>&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspGoSub UserDefinedErrorHandler<br>&nbsp;&nbsp;&amp;nbspEnd If<br>&nbsp;&nbsp;&amp;nbspResume Next<br>End Sub</p>
<p CLASS="Textttext">If you have defined a relationship with enforced referential integrity between two tables in your database, set the <span CLASS="ElementNameeln">KeepLocal</span> property to the same value for both tables. If the property value is not the same for both tables, the conversion fails. You can't set the <span CLASS="ElementNameeln">KeepLocal</span> property while the relationship is in effect. Before you set the property, remove the relationship between the tables. After you set the <span CLASS="ElementNameeln">KeepLocal</span> property, define the relationship between the two tables again and proceed with converting the database.
<p CLASS="Textttext">After you convert a database to a Design Master, all new objects created in the Design Master replica, or in any other replica in the set, are treated as local objects. Local objects remain in the replica where they're created and are not copied throughout the replica set. Each time you make a new replica in the set, all of the objects in the source replica that can be replicated are included in that new replica, but none of the local objects are included.
<p CLASS="Textttext">A database that can have replicas containing both replicated and local objects is much more useful because users can share corporate, division, or workgroup data that is common to all their tasks, while maintaining location-specific data and custom queries and reports.</p>
<a NAME="5ReplicatingNewObjects"></a>
<p CLASS="heading5OrgHeading3h3">Replicating New Objects</p>
<p CLASS="Textttext">If you create a new object in a replica and want to replicate it so that all users can use it, import the object to or create it in the Design Master, and set the object's <span CLASS="ElementNameeln">ReplicableBool</span> property to <span CLASS="ElementNameeln">True</span> in your code. You can also set the<span CLASS="ElementNameeln"> ReplicableBool </span>property by selecting the <span CLASS="ElementNameeln">Replicable</span> check box in the object's property sheet. Any local objects in other replicas in the set that have the same name as the newly replicated object are renamed to <span CLASS="NewTermntrm">objectname</span>_Local during the next synchronization. The next time you synchronize, the newly replicated object appears in the other replicas in the set.
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>To open an object's property sheet, right-click the object in the Database window, and then click <span CLASS="ElementNameeln">Properties</span> on the shortcut menu.</p>
<p CLASS="Textttext">Similarly, if there is an object that can be replicated and you want to make it local, set its <span CLASS="ElementNameeln">ReplicableBool</span> property to <span CLASS="ElementNameeln">False</span> in your code. You can also set the<span CLASS="ElementNameeln"> ReplicableBool </span>property by clearing the <span CLASS="ElementNameeln">Replicable</span> check box in the object's property sheet.</p>
<p CLASS="CautionTextcat"><span CLASS="CautionHeadingcah">Caution&nbsp;&nbsp;&nbsp;</span>When you change the setting of the object's <span CLASS="ElementNameeln">ReplicableBool </span>property from <span CLASS="ElementNameeln">True</span> to <span CLASS="ElementNameeln">False</span>, the Microsoft Jet database engine deletes the object from all replicas in the replica set except the Design Master. Even if you temporarily set the <span CLASS="ElementNameeln">ReplicableBool </span>property to <span CLASS="ElementNameeln">False</span> in the Design Master and then set it to <span CLASS="ElementNameeln">True</span> again, the next synchronization deletes and re-creates the table in each replica. Unless you synchronize all replicas before you make the design change, you lose any data entered in the table in a replica since the last synchronization.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba20_4.htm" OnClick="SyncURL(&quot;chapters/ba20_4.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
