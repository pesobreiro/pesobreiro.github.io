<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Working with Spreadsheets</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba18_4.htm" OnClick="SyncURL(&quot;chapters/ba18_4.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3WorkingwithSpreadsheets"></a>
<p CLASS="heading3OrgHeading1h1">Working with Spreadsheets</p>
<p CLASS="Textttext">With Microsoft Access and installable ISAM drivers, you can link or open spreadsheets and manipulate information in them as if they were database tables. The procedures for linking spreadsheets and opening them directly are very similar to the procedures for linking and opening external databases. The following sections explain how to use DAO to access data in Microsoft Excel.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>The procedure for accessing the data in Lotus 1-2-3 spreadsheet files (versions WK1, WK3, or WKS) is similar to the procedure used to access data in Microsoft Excel. For information on special considerations for using data in Lotus 1-2-3 spreadsheets, search the Help index for &quot;Lotus 1-2-3.&quot;</p>
<a NAME="4WorkingwithMicrosoftExcelWorksheetsandWorkbooks"></a>
<p CLASS="heading4OrgHeading2h2">Working with Microsoft Excel Worksheets and Workbooks</p>
<p CLASS="Textttext">The Microsoft Excel installable ISAM supports the following single-sheet worksheet and multiple-sheet workbook versions of Microsoft Excel: Microsoft Excel versions 3.0 and 4.0 for single-sheet worksheets, and Microsoft Excel versions 5.0, 7.0, and 8.0 for multiple-sheet workbooks. There are a few operations that you cannot perform on Microsoft Excel worksheets or workbooks through the Microsoft Excel installable ISAM:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYou cannot delete rows from Microsoft Excel worksheets or workbooks.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYou can clear data from individual cells in a worksheet, but you cannot modify or clear cells that contain formulas.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYou cannot create indexes on Microsoft Excel worksheets or workbooks.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYou cannot read encrypted data through the Microsoft Excel installable ISAM. You can't use the PWD argument (PWD=<span CLASS="NewTermntrm">password</span>) in the connection string to open an encrypted worksheet or workbook, even if you supply the correct password. You must decrypt all Microsoft Excel worksheets or workbooks through the Microsoft Excel user interface if you plan to link or open them in your Microsoft Access database.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on the PWD argument, see <a HREF="../chapters/ba18_3.htm#6SpecifyingPasswords" OnClick="SyncURL(&quot;chapters/ba18_3.htm&quot;)">&quot;Specifying Passwords&quot;</a> earlier in this chapter.</span></p>
<p CLASS="heading5OrgHeading3h3">Specifying Sheets and Ranges in Microsoft Excel Worksheet and Workbook Files</p>
<p CLASS="Textttext">You can specify a subset of the available data when you first link or open a Microsoft Excel worksheet or workbook in Visual Basic code. In worksheet files, you can link or open the entire sheet, a named range of cells, or an unnamed range of cells. In a workbook file, you can link or open a single worksheet, a named range anywhere in the workbook, or an unnamed range in a single worksheet.
<p CLASS="Textttext">When you link data from a Microsoft Excel worksheet, you must set the <span CLASS="ElementNameeln">Connect</span> property to a connection string that includes the DATABASE argument; you must also set the <span CLASS="ElementNameeln">SourceTableName</span> property to the name of the worksheet or range of cells you are accessing. When you open a worksheet or range of cells directly, you set the connection string in the <span CLASS="NewTermntrm">dbname</span> argument of the <span CLASS="ElementNameeln">OpenDatabase</span> method and you specify the name of the worksheet or range of cells in the <span CLASS="NewTermntrm">source</span> argument of the <span CLASS="ElementNameeln">OpenRecordset</span> method. The following table lists the conventions for these settings.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">To link or open <br>this object</p></font><!--mstheme--></font></td>
<td NOWRAP><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">In this version of <br>Microsoft Excel</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Use this syntax</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Entire sheet in a worksheet file</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">3.0 and 4.0 </p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Set the DATABASE or <span CLASS="NewTermntrm">dbname</span> argument to specify the fully-qualified path to the worksheet file; set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to specify the sheet as <span CLASS="NewTermntrm">filename</span><span CLASS="ElementNameeln">#xls</span>, where <span CLASS="NewTermntrm">filename</span> is the name of the worksheet.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Entire worksheet in a workbook file</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">5.0, 7.0, and 8.0</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Set the DATABASE or <span CLASS="NewTermntrm">dbname</span> argument to specify the fully-qualified path to the workbook file, including the workbook file name; set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to specify the sheet as <span CLASS="NewTermntrm">sheetname</span><span CLASS="ElementNameeln">$</span>, where <span CLASS="NewTermntrm">sheetname </span>is the name of the worksheet. 
<p CLASS="ImportantTextit"><span CLASS="CrossRefHeadingcrh">Important&nbsp;&nbsp;&nbsp;</span>You must follow the worksheet name with a dollar sign ($).</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Named range of cells in a worksheet or workbook file</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">3.0, 4.0, 5.0, 7.0, and 8.0</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Set the DATABASE or <span CLASS="NewTermntrm">dbname</span> argument to specify the fully-qualified path to the worksheet or workbook file, including the worksheet or workbook file name; set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to specify the named range as <span CLASS="NewTermntrm">NamedRange</span>, where <span CLASS="NewTermntrm">NamedRange</span> is the name you assigned to the range in Microsoft Excel.
<p CLASS="ImportantTextit"><span CLASS="CrossRefHeadingcrh">Important&nbsp;&nbsp;&nbsp;</span>You must name the range in Microsoft Excel before attempting to link or open it.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Unnamed range of cells in a worksheet file</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">3.0 and 4.0</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Set the DATABASE or <span CLASS="NewTermntrm">dbname</span> argument to specify the fully-qualified path to the worksheet file, including the worksheet file name; set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to specify the range as <span CLASS="NewTermntrm">FirstCellInRange</span><span CLASS="ElementNameeln">:</span><span CLASS="NewTermntrm">LastCellInRange</span>. For example, to access cells A1 through Z256, you would set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to <span CLASS="CodeTextEmbeddedcte">A1:Z256</span>.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Unnamed range of cells in a single worksheet in a workbook file</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">5.0, 7.0, and 8.0</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Set the DATABASE or <span CLASS="NewTermntrm">dbname</span> argument to specify the fully-qualified path to the workbook file, including the workbook file name; set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to specify the sheet you want to link or open as <span CLASS="NewTermntrm">sheetname</span><span CLASS="ElementNameeln">$</span> and the range as <span CLASS="NewTermntrm">FirstCellInRange</span><span CLASS="ElementNameeln">:</span><span CLASS="NewTermntrm">LastCellInRange</span>. For example, to access cells A1 through Z256 in a worksheet called Sales, you would set the <span CLASS="ElementNameeln">SourceTableName</span> property or the <span CLASS="NewTermntrm">source</span> argument to <span CLASS="CodeTextEmbeddedcte">Sales$A1:Z256</span>.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>You cannot specify a value in a range that exceeds the maximum number of rows, columns, or sheets for the worksheet or workbook. For more information on these values, see your Microsoft Excel documentation.</p>
<p CLASS="heading5OrgHeading3h3">Linking Microsoft Excel Worksheets</p>
<p CLASS="Textttext">To link data from a Microsoft Excel worksheet to your Microsoft Access database, use the <span CLASS="ElementNameeln">CurrentDb</span> function to return an object variable that represents the current Microsoft Access database. Then create a <span CLASS="ElementNameeln">TableDef</span> object and set the connection string and source table name: set the <span CLASS="ElementNameeln">TableDef</span> object's<span CLASS="ElementNameeln"> Connect</span> property to specify the source database type and the full path to the Microsoft Excel worksheet or workbook, and set its <span CLASS="ElementNameeln">SourceTableName</span> property to the name of the worksheet or range of cells.
<p CLASS="Textttext">The following example links a Microsoft Excel version 5.0 worksheet named January Sales in a workbook named Q1Sales.xls located in the Sales folder to a Microsoft Access database:</p>
<p CLASS="CodeTextct">Sub LinkExcelSheet()<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspDim tdf As TableDef<br>&nbsp;&nbsp;&amp;nbspDim rstSales As Recordset<br>&nbsp;&nbsp;&nbsp;' Open the Microsoft Access database.<br>&nbsp;&nbsp;&amp;nbspSet dbs = CurrentDb<br>&nbsp;&nbsp;&nbsp;' Create a TableDef object.<br>&nbsp;&nbsp;&amp;nbspSet tdf = dbs.CreateTableDef(&quot;Linked Microsoft Excel Worksheet&quot;)<br>&nbsp;&nbsp;&nbsp;' Set the connection string to specify the source database type and the<br>&nbsp;&nbsp;&nbsp;' path to the workbook that contains the data you want to link.<br>&nbsp;&nbsp;&amp;nbsptdf.Connect = &quot;Excel 5.0;DATABASE=C:\Sales\Q1Sales.xls&quot;<br>&nbsp;&nbsp;&nbsp;' Set the SourceTableName property to the worksheet you want to access.<br>&nbsp;&nbsp;&amp;nbsptdf.SourceTableName = &quot;January Sales$&quot;<br>&nbsp;&nbsp;&nbsp;' Append the TableDef object to the TableDefs collection to create a link.<br>&nbsp;&nbsp;&amp;nbspdbs.TableDefs.Append tdf<br>&nbsp;&nbsp;&nbsp;' Create a Recordset object from the linked Microsoft Excel worksheet.<br>&nbsp;&nbsp;&amp;nbspSet rstSales = dbs.OpenRecordset(&quot;Linked Microsoft Excel Worksheet&quot;)<br>End Sub</p>
<p CLASS="Textttext">The following code shows the connection information you would use to link a range of cells named ThirdQuarter in a Microsoft Excel version 8.0 worksheet called Sales.xls which is located on C:\Excel\Examples to a Microsoft Access database.</p>
<p CLASS="CodeTextct">tdfThirdQtr.Connect = &quot;Excel 8.0; DATABASE=C:\Excel\Examples\Sales.xls&quot;<br>tdfThirdQtr.SourceTableName = &quot;ThirdQuarter&quot;
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>Instead of specifying the connection string and source table name by setting properties of the <span CLASS="ElementNameeln">TableDef</span> object, you can specify them by using the<span CLASS="NewTermntrm"> connect</span> and <span CLASS="NewTermntrm">source</span> arguments of the <span CLASS="ElementNameeln">CreateTableDef</span> method. You can also use the Microsoft Access user interface to link external data. For more information on using the<span CLASS="ElementNameeln"> CreateTableDef</span> method or the user interface to link external data, see <a HREF="../chapters/ba18_3.htm#4LinkingExternalTables" OnClick="SyncURL(&quot;chapters/ba18_3.htm&quot;)">&quot;Linking External Tables&quot;</a> earlier in this chapter. </p>
<p CLASS="heading5OrgHeading3h3">Opening Microsoft Excel Worksheets</p>
<p CLASS="Textttext">To open a Microsoft Excel worksheet directly from your Microsoft Access database, create a <span CLASS="ElementNameeln">Database</span> object and set the arguments of the <span CLASS="ElementNameeln">OpenDatabase</span> method to specify the full path to the worksheet or workbook, whether to open the worksheet or workbook exclusively, whether to open it with read/write or read-only permissions, and the source database type. Specify the name of the worksheet or range of cells as the <span CLASS="NewTermntrm">source</span> argument of the <span CLASS="ElementNameeln">OpenRecordset</span> method.
<p CLASS="Textttext">The following example opens a Microsoft Excel version 4.0 worksheet named Data.xls directly from a Microsoft Access database, creates a <span CLASS="ElementNameeln">Recordset</span> object from the worksheet, and counts the number of records that appear in the <span CLASS="ElementNameeln">Recordset</span> object.</p>
<p CLASS="CodeTextct">Sub OpenExcel4Sheet()<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspDim rst As Recordset<br>&nbsp;&nbsp;&amp;nbspDim intNumRecords As Integer<br>&nbsp;&nbsp;&nbsp;' Open the Microsoft Excel worksheet named Data.xls without exclusive access<br>&nbsp;&nbsp;&nbsp;' and with read/write permissions. <br>&nbsp;&nbsp;&amp;nbspSet dbs = OpenDatabase(&quot;C:\Excel\Data.xls&quot;,False, False, &quot;Excel 4.0;HDR=No;&quot;)<br>&nbsp;&nbsp;&nbsp;' Create a Recordset object from the worksheet Data.xls. The number sign<br>&nbsp;&nbsp;&nbsp;' character (#) tells the installable ISAM that the code is referencing<br>&nbsp;&nbsp;&nbsp;' the entire worksheet.<br>&nbsp;&nbsp;&amp;nbspSet rst = dbs.OpenRecordset(&quot;Data#xls&quot;)<br>&nbsp;&nbsp;&nbsp;' Use the MoveLast method to populate the Recordset; use the RecordCount <br>&nbsp;&nbsp;&nbsp;' property to count the records and display a message that gives the results.<br>&nbsp;&nbsp;&amp;nbsprst.MoveLast<br>&nbsp;&nbsp;&amp;nbspintNumRecords = rst.RecordCount<br>&nbsp;&nbsp;&amp;nbspMsgBox &quot;There are &quot; &amp; intNumRecords &amp; &quot; rows in this worksheet.&quot;<br>&nbsp;&nbsp;&amp;nbsprst.Close<br>End Sub</p>
<p CLASS="Textttext">This next example opens a worksheet named SampleSheet in a Microsoft Excel version 7.0 workbook named Data.xls, creates a <span CLASS="ElementNameeln">Recordset</span> object from the worksheet, and counts the number of records that appear in the <span CLASS="ElementNameeln">Recordset</span> object.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Use the source database type <span CLASS="CodeTextEmbeddedcte">Excel 5.0</span> in the connection string for both Microsoft Excel version 5.0 and Microsoft Excel version 7.0. <span CLASS="CodeTextEmbeddedcte">Excel 7.0</span> isn't a valid source database type.</p>
<p CLASS="CodeTextct">Sub OpenExcel7Sheet()<br>&nbsp;&nbsp;&amp;nbspDim dbs As Database<br>&nbsp;&nbsp;&amp;nbspDim rst As Recordset<br>&nbsp;&nbsp;&amp;nbspDim intNumRecords As Integer<br>&nbsp;&nbsp;&nbsp;' Open the Microsoft Excel workbook named Data.xls without exclusive access<br>&nbsp;&nbsp;&nbsp;' and with read/write permissions.<br>&nbsp;&nbsp;&amp;nbspSet dbs = OpenDatabase(&quot;C:\Excel\Data.xls&quot;,False, False, &quot;Excel 5.0;HDR=No;&quot;)<br>&nbsp;&nbsp;&nbsp;' Create a Recordset from the worksheet. The dollar sign character following <br>&nbsp;&nbsp;&nbsp;' the sheet name tells the installable ISAM that the code is referencing the<br>&nbsp;&nbsp;&nbsp;' entire sheet.<br>&nbsp;&nbsp;&amp;nbspSet rst = dbs.OpenRecordset(&quot;SampleSheet$&quot;)<br>&nbsp;&nbsp;&nbsp;' Use the MoveLast method to populate the Recordset; use the RecordCount<br>&nbsp;&nbsp;&nbsp;' property to count the records and display a message that gives the results.<br>&nbsp;&nbsp;&amp;nbsprst.MoveLast<br>&nbsp;&nbsp;&amp;nbspintNumRecords = rst.RecordCount<br>&nbsp;&nbsp;&amp;nbspMsgBox &quot;There are &quot; &amp; intNumRecords &amp; &quot; rows in this worksheet.&quot;<br>&nbsp;&nbsp;&amp;nbsprst.Close<br>End Sub</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note</span>&nbsp;&nbsp;&amp;nbspMicrosoft Excel version 8.0 supports the ability to create files that contain formatting information for both Microsoft Excel version 7.0 and Microsoft Excel version 8.0. You can create files that can be opened by either Microsoft Excel version 7.0 or Microsoft Excel version 8.0 without having to convert the file format. You can access these files only in read-only mode from Microsoft Access.</p>
<p CLASS="heading5OrgHeading3h3">Using the HDR Argument to Suppress Headers</p>
<p CLASS="Textttext">Both Microsoft Excel and Lotus 1-2-3 include the HDR argument in the connection string. The HDR argument determines whether the first row of the range to be opened should be treated as a record or as field names when the Microsoft Access table is created. The following table describes the settings for the HDR argument.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">HDR argument setting</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Result</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Yes</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Data in the first row of a spreadsheet range is treated as field names.</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">No</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Data in the first row of a spreadsheet range is treated as a record.</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="Textttext">For Microsoft Excel worksheets and workbooks, and Lotus 1-2-3 spreadsheets, this behavior is managed by the<span CLASS="ElementNameeln"> </span>FirstRowHasNames<span CLASS="ElementNameeln"> </span>setting in the Windows Registry. You can find this setting in the <span CLASS="ElementNameeln">\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft \Jet \3.5\Engines\Lotus</span> key for Lotus 1-2-3 and in the <span CLASS="ElementNameeln">\HKEY_LOCAL_MACHINE \SOFTWARE\Microsoft\Jet\3.5\Engines\Excel</span> key for Microsoft Excel. The default value of the FirstRowHasNames setting is 01 (Yes), which specifies that the first row in any range is treated as if it contains field name information.
<p CLASS="Textttext">You can override this Windows Registry setting on a range-by-range basis by setting the HDR argument in the connection string. For example, in the code in the preceding section, the HDR argument is set to No, which specifies that the first row of the worksheet is treated as a record in the table, not as a header containing field names. If the HDR argument were set to Yes in this example, the total records in the recordset wouldn't include the first record, and the variable <span CLASS="CodeTextEmbeddedcte">intNumRecords</span> would be one less than its value when the HDR argument is set to No.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba18_6.htm" OnClick="SyncURL(&quot;chapters/ba18_6.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
