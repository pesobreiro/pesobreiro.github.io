<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Adjusting Windows Registry Settings to Improve Performance</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba13_1.htm" OnClick="SyncURL(&quot;chapters/ba13_1.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3AdjustingWindowsRegistrySettingstoImprovePerformance"></a>
<p CLASS="heading3OrgHeading1h1">Adjusting Windows Registry Settings to Improve Performance</p>
<p CLASS="Textttext">Settings in the <span CLASS="ElementNameeln">Engines</span> subkey of the Windows Registry control how the Microsoft Jet database engine uses memory and performs other aspects of its operations. Microsoft Jet automatically provides default settings that usually give the best performance for most common database operations. However, depending on what kind of operations your application performs and how much memory is available at any given time, you may be able to improve performance by adjusting Windows Registry settings.
<p CLASS="Textttext">Keep in mind that the optimum value for a setting can change from computer to computer, and can change depending on how much memory is available, the kind of operation the user is performing, or the level of activity in the database at any given time. Using a system and working environment that's as much like your typical user's system as possible, experiment with these settings to find out what works best.
<p CLASS="Textttext">The default values for these Microsoft Jet settings are written in the <span CLASS="ElementNameeln">\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Jet 3.5</span> key of the Windows Registry when Microsoft Access is installed. Changes made to settings in this key may affect other applications that use the Jet 3.5 database engine, such as Visual Basic version 5.0 or Microsoft Excel 97. To make changes that only affect Microsoft Access 97, create a <span CLASS="ElementNameeln">Jet 3.5</span> key below the <span CLASS="ElementNameeln">\HKEY_LOCAL_MACHINE \SOFTWARE\Microsoft\Office\8.0\Access\Jet\3.5\Engines</span> key where you can add values for any default setting you want to override.
<p CLASS="Textttext">If you want changes to Microsoft Jet settings to affect only your application or your session of Microsoft Access, you can create a custom set of Registry keys, called a <span CLASS="NewTermntrm">user profile</span>, that contains settings to override default Registry settings. You use the <span CLASS="ElementNameeln">/profile</span> command-line option when starting Microsoft Access to specify the user profile you want your application to use.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on user profiles or changing Microsoft Access Registry settings, search the Help index for &quot;user profiles&quot; or &quot;Registry.&quot;
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>You can also change most of these settings by using the <span CLASS="ElementNameeln">SetOption</span> method of the <span CLASS="ElementNameeln">DBEngine</span> object in Data Access Objects (DAO) code. Using the <span CLASS="ElementNameeln">SetOption</span> method, you can change these settings &quot;on the fly&quot; while your application is running. For example, you may want to change the SharedAsyncDelay and PageTimeout settings to low values to increase performance when your application performs operations on one record at a time or is using controls bound to data, but increase these values when performing bulk operations such as update and delete queries or transactions on large numbers of records. Changing Microsoft Jet settings by using the <span CLASS="ElementNameeln">SetOption</span> method doesn't affect the values stored in the Windows Registry. Changes made with the <span CLASS="ElementNameeln">SetOption</span> method are only in effect for the current instance of the <span CLASS="ElementNameeln">DBEngine </span>object. For more information on the <span CLASS="ElementNameeln">SetOption</span> method, search the Help index for &quot;SetOption method.&quot;</p>
<p CLASS="Textttext">The following sections discuss the Windows Registry settings you can adjust to improve performance.</p>
<a NAME="6Threads"></a>
<p CLASS="heading6OrgHeading4h4">Threads</p>
<p CLASS="Textttext">A <span CLASS="NewTermntrm">thread</span> is a software process running independently on a multitasking operating system such as Windows 95 or Windows NT Workstation. For example, the ability to use multiple threads allows you to run a communications software program to download a file at the same time as you use your word processor to edit a document. Microsoft Jet uses threads internally to enhance performance and provide background services such as read-ahead caching, write-behind caching (transaction commit), cache maintenance, and the detection of changes made to shared databases. By default, Microsoft Jet uses up to a maximum of three threads. You may want to try increasing the Threads setting if a large number of actions are performed in your application, or if it contains a large number of linked tables.</p>
<a NAME="6MaxBufferSize"></a>
<p CLASS="heading6OrgHeading4h4">MaxBufferSize</p>
<p CLASS="Textttext">Microsoft Jet reads and writes data in 2K pages, placing the data in a temporary holding area called the <span CLASS="NewTermntrm">buffer</span> as required by its operations. By default, when performing operations that add, delete, or update records and that aren't part of an explicit transaction, Microsoft Jet automatically performs internal transactions that group changes to records and temporarily saves them in the buffer. After a specified time, or when the size specified by the MaxBufferSize setting is exceeded, it then writes the data as a chunk to the database. This minimizes the time spent reading and writing data to the database. Additionally, Microsoft Jet can minimize the time spent reading data for tables, queries, forms, or reports by reading available data from its buffer.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on other settings that regulate the management of transactions, see <a HREF="../chapters/ba13_2.htm#6ImplicitCommitSync" OnClick="SyncURL(&quot;chapters/ba13_2.htm&quot;)">&quot;ImplicitCommitSync,&quot;</a> <a HREF="../chapters/ba13_2.htm#6ExclusiveAsyncDelay" OnClick="SyncURL(&quot;chapters/ba13_2.htm&quot;)">&quot;ExclusiveAsyncDelay,&quot;</a> and <a HREF="../chapters/ba13_2.htm#6SharedAsyncDelay" OnClick="SyncURL(&quot;chapters/ba13_2.htm&quot;)">&quot;SharedAsyncDelay&quot;</a> later in this section.</p>
<p CLASS="Textttext">The MaxBufferSize setting specifies a &quot;high water mark&quot; for the size of the buffer that Microsoft Jet uses to work with records in memory, measured in kilobytes. Microsoft Jet can temporarily exceed the MaxBufferSize. As soon as it does, however, it starts a background thread to write data to the database to bring the buffer's size down to the specified &quot;high water mark.&quot;
<p CLASS="Textttext">By default, Microsoft Jet allocates memory for its internal buffer on an as-needed basis up to the MaxBufferSize. The default value written in the Windows Registry for the MaxBufferSize setting when Microsoft Access is installed is 0, which indicates that Microsoft Jet calculates the setting based on the following formula:
<p CLASS="Textttext">((Total RAM in K - 12,288)/4 + 512K)
<p CLASS="Textttext">For example, on a system with 16 MB of RAM (16,384K), Microsoft Jet uses a MaxBufferSize setting of 1,536.
<p CLASS="Textttext">You can override the default calculated setting by specifying a different MaxBufferSize value. This sets a new &quot;high water mark.&quot; The minimum value that Microsoft Jet uses by default is 512K, but you can specify a value as low as 128K. However, setting the MaxBufferSize to a value less than 512K is not recommended for Microsoft Access applications because it can seriously degrade performance.
<p CLASS="Textttext">For computers with 16 MB or less of installed RAM, there is generally no need to override the calculated setting. For computers with 32 MB of RAM, you may see some performance improvement when specifying a larger MaxBufferSize if no other applications are running at the same time as Microsoft Access. For example, tests have shown performance improvements in applications that perform large transactions when a MaxBufferSize as large as 8 MB is specified.
<p CLASS="Textttext">Specifying a MaxBufferSize larger than 8 MB hasn't been found to increase performance. Setting a value too high can degrade performance due to the added CPU overhead needed to manage the cache, and due to the fact that the operating system may start swapping Microsoft Jet's cache to disk as virtual memory.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>When specifying a MaxBufferSize setting that is larger than the default, you should also increase the SharedAsyncDelay setting to increase the time that data is held in the buffer. If you don't increase the SharedAsyncDelay setting, Microsoft Jet writes the contents of its buffer to the database before it has had time to utilize the additional memory you specified. For more information on the SharedAsyncDelay setting, see <a HREF="../chapters/ba13_2.htm#6SharedAsyncDelay" OnClick="SyncURL(&quot;chapters/ba13_2.htm&quot;)">&quot;SharedAsyncDelay&quot;</a> later in this section.</p>
<a NAME="6UserCommitSync"></a>
<p CLASS="heading6OrgHeading4h4">UserCommitSync</p>
<p CLASS="Textttext">The UserCommitSync setting determines whether changes made as part of an explicit transaction (a change made to data by using the <span CLASS="ElementNameeln">BeginTrans</span>, <span CLASS="ElementNameeln">CommitTrans</span>, and <span CLASS="ElementNameeln">Rollback</span> methods) are written to the database in <span CLASS="NewTermntrm">synchronous</span> mode or <span CLASS="NewTermntrm">asynchronous</span> mode. In synchronous mode, Microsoft Jet doesn't return control to the application code until the changes made by the <span CLASS="ElementNameeln">CommitTrans</span> method are written to the database. In asynchronous mode, Microsoft Jet stores the changes in its memory buffer, returns control to the application code immediately, and then writes the changes to the database in a background thread. Microsoft Jet begins writing the changes either after a specified period of time (determined by the FlushTransactionTimeout setting, or by the SharedAsyncDelay or ExclusiveAsyncDelay settings described later in this section) or when the MaxBufferSize is exceeded. The default UserCommitSync setting is Yes, which specifies synchronous mode. It is not recommended that you change this setting because in asynchronous mode, there is no guarantee that information has been written to disk before your code proceeds to the next command.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If you've used explicit transactions to improve performance in previous versions of Microsoft Access, you no longer need to do so. For more information, see <a HREF="../chapters/ba13_4.htm#4UsingTransactionstoUpdateRecords" OnClick="SyncURL(&quot;chapters/ba13_4.htm&quot;)">&quot;Using Transactions to Update Records&quot;</a> later in this chapter.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on transactions, see <a HREF="../chapters/ba09_1.htm#4MicrosoftJetTransactions" OnClick="SyncURL(&quot;chapters/ba09_1.htm&quot;)">&quot;Microsoft Jet Transactions&quot;</a> in Chapter 9, &quot;Working with Records and Fields.&quot;</p>
<a NAME="6ImplicitCommitSync"></a>
<p CLASS="heading6OrgHeading4h4">ImplicitCommitSync</p>
<p CLASS="Textttext">By default, when performing operations that add, delete, or update records outside of explicit transactions, Microsoft Jet automatically performs internal transactions that temporarily save data in its memory buffer, and then later write the data as a chunk to the disk. The ImplicitCommitSync setting determines whether changes made by using these automatic internal transactions are written to the database in synchronous mode or asynchronous mode. The default setting is No, which specifies that these changes are written to the database in asynchronous mode; this provides the best performance. If you want internal transactions to be written to the database in synchronous mode, change the ImplicitCommitSync setting to Yes. If you change the setting to Yes, you get behavior similar to Microsoft Jet versions 2.<span CLASS="NewTermntrm">x</span> and earlier when you weren't employing explicit transactions. However, doing so can also impair performance considerably, so it is not recommended that you change this setting.</p>
<a NAME="6FlushTransactionTimeout"></a>
<p CLASS="heading6OrgHeading4h4">FlushTransactionTimeout</p>
<p CLASS="Textttext">The FlushTransactionTimeout setting determines Microsoft Jet's method of performing asynchronous writes to a database file. The FlushTransactionTimeout setting is the number of milliseconds after which Microsoft Jet starts writing database changes to disk from its cache. Changes are written to disk after the specified amount of time has expired and if no new pages have been added to the cache during that interval. The only exception is if the size of the cache exceeds the MaxBufferSize setting, at which point the cache starts asynchronous writes regardless of whether the time has expired. The default setting is 500 milliseconds. The only reason to increase the value of the FlushTransactionTimeout setting is if the database is being updated over a slow wide area network (WAN) or local area network (LAN) connection. Increasing this value for databases being updated over fast WAN and typical LAN connections does not improve performance.
<p CLASS="Textttext">The FlushTransactionTimeout setting overrides both the ExclusiveAsyncDelay and SharedAsyncDelay Registry settings, and is the preferred method of determining how Microsoft Jet performs asynchronous writes to a database file. To enable the ExclusiveAsyncDelay and SharedAsyncDelay settings, you must set the FlushTransactionTimeout entry to a value of 0.</p>
<a NAME="6ExclusiveAsyncDelay"></a>
<p CLASS="heading6OrgHeading4h4">ExclusiveAsyncDelay</p>
<p CLASS="Textttext">The ExclusiveAsyncDelay setting is the maximum time that can pass before asynchronous mode changes start to be written to a database that's opened exclusively. The default setting is 2,000 milliseconds. Decrease this setting if you want to be sure that changes are written to your database more frequently, but note that this decreases overall performance. Because the default setting is already quite long, increasing this setting doesn't improve performance in most cases. However, if your system has 32 MB of RAM or more and you have specified a large MaxBufferSize, you may see some performance improvement if you increase this setting. By default, this setting is disabled by the FlushTransactionTimeout setting.</p>
<a NAME="6SharedAsyncDelay"></a>
<p CLASS="heading6OrgHeading4h4">SharedAsyncDelay</p>
<p CLASS="Textttext">The SharedAsyncDelay setting is the maximum time that can pass before asynchronous mode changes start to be written to a database that's opened in shared mode. The default setting is 50 milliseconds. Note that this produces a small delay before changes are made available to other users. Increasing this value enhances performance in shared databases because there are fewer disk writes. However, it may reduce the overall concurrency because pages are locked while they are in the buffer waiting to be written to the database. If your application performs operations that affect many records, increase this setting to give Microsoft Jet additional time to temporarily save additions, deletions, and updates in its buffer before it writes them to the database. This applies whether your application uses action queries, DAO code, or SQL statements to add, delete, or update records. By default, this setting is disabled by the FlushTransactionTimeout setting.</p>
<a NAME="6PageTimeout"></a>
<p CLASS="heading6OrgHeading4h4">PageTimeout</p>
<p CLASS="Textttext">The PageTimeout setting determines how long Microsoft Jet waits before checking to see if other users have made changes to the database. If changes have been made, Microsoft Jet refreshes the data in its memory buffer.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>This action is equivalent to pressing F9 while viewing a table or query in Microsoft Access, or using the <span CLASS="ElementNameeln">Refresh</span> method in DAO code.</p>
<p CLASS="Textttext">The default PageTimeout setting is 5,000 milliseconds. Decreasing this setting increases the amount of time spent reading from the disk, thus impairing performance, but can make the data available to the user more current. The<span CLASS="ElementNameeln"> Refresh Interval</span> setting on the <span CLASS="ElementNameeln">Advanced</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu) in Microsoft Access overrides the PageTimeout setting.
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>You can override the PageTimeout setting and refresh the cache by using the <span CLASS="ElementNameeln">dbRefreshCache</span> argument of the <span CLASS="ElementNameeln">Idle</span> method in DAO code. This allows users to see other users' changes immediately. For more information on the <span CLASS="ElementNameeln">Idle</span> method, search the Help index for &quot;Idle method.&quot;</p>
<a NAME="6LockDelay"></a>
<p CLASS="heading6OrgHeading4h4">LockDelay</p>
<p CLASS="Textttext">If Microsoft Access tries to place a lock on a page in a shared database and a message that locking has failed is returned, the LockDelay setting determines how long it waits before it retries. If the time it takes to return the message exceeds the LockDelay setting, there is no delay. The default setting is 100 milliseconds. On systems that don't manage lock retries themselves, such as Windows 95 peer-to-peer networking, the LockDelay setting prevents Microsoft Jet from performing repeated retries over a short period of time. If you are using such a system, the default setting is usually sufficient to reduce the number of lock requests sent across the network, which frees up network bandwidth for other purposes. If your application or its users frequently lock a large number of records, you may want to try increasing this setting to further reduce the number of lock requests being sent across the network. If you are using a server-based networking system that manages lock retries itself, such as Windows NT Server or Novell NetWare, there is no need to change this setting.</p>
<a NAME="6MaxLocksPerFile"></a>
<p CLASS="heading6OrgHeading4h4">MaxLocksPerFile</p>
<p CLASS="Textttext">The MaxLocksPerFile setting determines the maximum number of locks that Microsoft Jet places against a file. The default setting is 9,500 locks. If the number of locks required to perform a transaction exceeds the MaxLocksPerFile setting, the transaction commits (writes) the data that has locks associated with it, frees the locks, and then continues processing the transaction. If the maximum number of locks a server can handle is less than the MaxLocksPerFile setting, the server returns an error message or appears to hang when performing a large transaction. If this occurs, you should decrease the MaxLocksPerFile setting. A Novell server can be configured to perform a maximum of 10,000 locks per connection. A Novell server connection can include more than one database, so it's possible to exceed the maximum number of available locks if you are using more than one database at a time.</p>
<a NAME="6RecycleLVs"></a>
<p CLASS="heading6OrgHeading4h4">RecycleLVs</p>
<p CLASS="Textttext"><span CLASS="NewTermntrm">Long value </span>(LV)<span CLASS="NewTermntrm"> </span>pages store data in fields with Memo, OLE object, and Hyperlink data types, as well as the data that defines forms, reports, and modules. When a database is open in shared mode, the size of the database increases when data, forms, reports, and modules are deleted or changed in such a way that the current LV page must be discarded and replaced with a new LV page. Sometimes a new LV page is needed to prevent errors for other users who may still be using the object or data in its original form.
<p CLASS="Textttext">The RecycleLVs setting determines when discarded LV pages become available for reuse. The default RecycleLVs setting is 0, which specifies that discarded LV pages continue to occupy space in the database and only become available for reuse after the last user closes the database. You can change the RecycleLVs setting to 1 so that discarded LV pages become available for reuse after Microsoft Jet determines that there's only one user in the database in shared mode and that new LV data has been added to the database. Note that setting RecycleLVs to 1 slows down performance somewhat. Therefore, this is primarily useful when you are creating or modifying forms, reports, and modules because it minimizes the need to compact the database.
<p CLASS="Textttext">When a database is open in exclusive mode, the RecycleLVs setting has no effect: discarded LV pages become available for reuse immediately. In both exclusive mode and shared mode, discarded LV pages are reused only when new LV data needs to be written to the database. To remove discarded LV pages before that time, you must compact the database.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba13_3.htm" OnClick="SyncURL(&quot;chapters/ba13_3.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
