<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Creating Your First Event Procedure</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba02_1.htm" OnClick="SyncURL(&quot;chapters/ba02_1.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3CreatingYourFirstEventProcedure"></a>
<p CLASS="heading3OrgHeading1h1">Creating Your First Event Procedure</p>
<p CLASS="Textttext">You write Visual Basic code in units called <span CLASS="NewTermntrm">procedures</span>. A procedure contains a series of Visual Basic statements that perform an operation or calculate a value. An <span CLASS="NewTermntrm">event</span> <span CLASS="NewTermntrm">procedure</span> is a procedure that runs in response to an event. This section shows you how to create a simple event procedure that makes a command button and a text box work together on a form. The following illustration provides an example of how this interface may appear to the user.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0201.jpg"></p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>This example assumes that you have control wizards turned off in the form's Design view. To do this, make sure the <span CLASS="ElementNameeln">Control Wizards</span> tool <img SRC="..\images\CNTLWIZH.gif">in the toolbox is not pressed in.</p>
<p CLASS="Textttext">Because an event procedure is part of the design of the form or report that runs it, the first step is to create the form and add the controls. In this case, you create a form that isn't based on a table or query and add a text box and a command button. Your code will refer to these controls by name, so it's a good idea to set the <span CLASS="ElementNameeln">Name</span> property of each control on your form to something more descriptive than the default settings that Microsoft Access gives them. For example, Microsoft Access names the text box Text0 and the command button Command1. To be more descriptive, you could name the text box Message and the command button OK.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0202.jpg"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>When you name the tables, fields, and other objects in your database, keep in mind that you'll use these names to refer to the objects elsewhere in your application. Although descriptive names for objects with spaces are easier to recognize than more compact names, they can be difficult to use in expressions, SQL statements, and Visual Basic code. Consider using short, consistent names that don't contain spaces and are easy to remember and type<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">for example, field names such as LastName and Phone.</p>
<p CLASS="Textttext">After you've created your form and its controls and set their properties, you're ready to write your first event procedure in the Module window.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To write the event procedure for the OK command button</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspIn Design view, right-click the object (form, report, section, or control) for which you want to write an event procedure, in this case, the OK command button. On the shortcut menu, click <span CLASS="ElementNameeln">Build Event</span>.</p>
<p CLASS="ListText1lt1">Microsoft Access displays the <span CLASS="ElementNameeln">Choose Builder</span> dialog box.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspIn the list box, click <span CLASS="ElementNameeln">Code Builder</span>, and then click <span CLASS="ElementNameeln">OK</span>.</p>
<p CLASS="ListText1lt1">Microsoft Access opens the Module window and creates a template for the default event procedure of the object you selected, in this case, the Click event procedure. (The <span CLASS="NewTermntrm">default </span>event procedure is the one for which Microsoft Access thinks you're most likely to add code.) The template for the OK command button's Click event procedure is shown in the following illustration.
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0203.jpg"></p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspEnter the code for the event procedure between the <span CLASS="ElementNameeln">Sub</span> and <span CLASS="ElementNameeln">End Sub</span> statements. For the OK command button's event procedure, enter the following code:</p>
<p CLASS="ListCodeText1lct1">Message = &quot;Hello, World!&quot;<br>&nbsp;&nbsp;&nbsp;
<p CLASS="ListText1lt1">This line of code sets the Message text box to the text string, &quot;Hello, World!&quot;</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspSave and close the module.</p>
<p CLASS="ListText1lt1">When you save the module, Microsoft Access sets the command button's <span CLASS="ElementNameeln">OnClick</span> event property to [Event Procedure], as shown in the following illustration.
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0204.jpg"></p>
<p CLASS="Textttext">Now that you've written the event procedure, you're ready to run it. To do this, you make the event happen on the form.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To run the OK_Click event procedure</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&nbsp;<img SRC="..\images\VIEW3.gif">&amp;nbspClick the <span CLASS="ElementNameeln">Form View</span> button on the toolbar to switch to Form view.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspClick <span CLASS="ElementNameeln">OK</span>.</p>
<p CLASS="ListText1lt1">The event procedure runs and the text &quot;Hello, World!&quot; appears in the text box.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on events and event procedures, see Chapter 6, <a HREF="../chapters/ba06_1.htm" OnClick="SyncURL(&quot;chapters/ba06_1.htm&quot;)">&quot;Responding to Events.&quot;</a></p>
<a NAME="4WorkingwithaFormorReportModule"></a>
<p CLASS="heading4OrgHeading2h2">Working with a Form or Report Module</p>
<p CLASS="Textttext">The &quot;Hello, World!&quot; example in the previous section shows you how to create a new event procedure by using the <span CLASS="ElementNameeln">Build Event</span> command on an object's shortcut menu. In addition to this method, Microsoft Access provides a variety of other ways to open a form or report module and create or modify its event procedures.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To open a form or report and its module at the same time
<p CLASS="ListProcedureSingleItemlprocs"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<img SRC="..\images\CODE.gif">&amp;nbspIn the Database window, select the form or report, and then click the <span CLASS="ElementNameeln">Code </span>button on the toolbar.</p>
<p CLASS="ListText1lt1">Microsoft Access opens the form or report and its module. You can also use the <span CLASS="ElementNameeln">Code </span>button in a form or report's Design view to open its module.
<p CLASS="ListText1lt1"></p>
<p CLASS="Textttext">In the previous section, you learned how to open the default event procedure. You can create or open any event procedure directly from the property sheet.</p>
<p CLASS="heading9ListProcedureHeadinglproch"><span CLASS="ProcedureIconproci"><img SRC="../images/bluetri.jpg" ALIGN="LEFT" WIDTH="9" HEIGHT="17">&nbsp;&nbsp;&nbsp;</span>To create or open any event procedure</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">1</span>&nbsp;&nbsp;&amp;nbspOpen the form or report in Design view. </p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">2</span>&nbsp;&nbsp;&amp;nbspDisplay the property sheet by right-clicking the form, report, section, or control, and then clicking <span CLASS="ElementNameeln">Properties</span> on the shortcut menu.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">3</span>&nbsp;&nbsp;&amp;nbspIn the property sheet, click the <span CLASS="ElementNameeln">Event</span> tab.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">4</span>&nbsp;&nbsp;&amp;nbspSelect the property box for the event procedure you want to open.</p>
<p CLASS="ListProcedureItem1lproc"><span CLASS="lproc">5</span>&nbsp;&nbsp;&nbsp;<img SRC="..\images\BUILDBUT.gif">&amp;nbspClick the <span CLASS="ElementNameeln">Build</span> button to the right of the property box.</p>
<p CLASS="ListText1lt1">If the event property already has an event procedure associated with it, Microsoft Access opens the Module window and displays the event procedure.
<p CLASS="ListText1lt1">If the event property is empty, Microsoft Access displays the <span CLASS="ElementNameeln">Choose Builder</span> dialog box. In the list box, click <span CLASS="ElementNameeln">Code Builder</span>, and then click <span CLASS="ElementNameeln">OK</span>. Microsoft Access opens the Module window and creates a template for the event procedure.
<p CLASS="ListText1lt1"></p>
<a NAME="5WritingandEditingCode"></a>
<p CLASS="heading5OrgHeading3h3">Writing and Editing Code</p>
<p CLASS="Textttext">Editing the code in a module is much like editing text with any text editor. The blinking vertical line, or <span CLASS="NewTermntrm">insertion point</span>, marks the place on screen where you insert typed or pasted text. 
<p CLASS="Textttext">As you begin using the Module window, you can take advantage of the following features designed to help you write Visual Basic code efficiently:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Automatic statement building</span>&nbsp;&nbsp;&amp;nbspWhen you type certain Visual Basic elements, Microsoft Access automatically tries to assist you in writing code by displaying a drop-down list of appropriate choices for the code element you've typed. For example, if you type an object variable, and follow it with a period to indicate that you intend to enter a method or property, Microsoft Access automatically displays a list of the methods and properties that apply to the object. (You use <span CLASS="NewTermntrm">methods</span> to perform operations on an object. You use <span CLASS="NewTermntrm">properties</span> to determine or change characteristics of an object.)</p>
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0205.jpg">
<p CLASS="ListText1lt1">To complete the statement you're typing, you can either click an item in the list or continue typing your code. If you continue typing code, the list displays the closest match to what you've typed. To enter the selected item in the list at any time, press TAB. To make the list disappear, press ESC.
<p CLASS="ListText1lt1"></p>
<p CLASS="ListNoteText1lnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">You can press ENTER to enter the selected item in the list. However, pressing ENTER also moves the cursor to the next line, so you'll have to return to the line to enter any arguments or additional information.
</span>
<p CLASS="ListText1lt1">To use automatic statement building, select the <span CLASS="ElementNameeln">Auto List Members</span> check box on the <span CLASS="ElementNameeln">Module</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).
<p CLASS="ListText1lt1">When the <span CLASS="ElementNameeln">Auto List Members</span> check box is selected, the statement-building lists appear automatically as you type. However, you may also want to explicitly cause Microsoft Access to display them, especially for lines of code you typed previously and want to edit. To display the list of methods and properties for an existing object, right-click the existing method or property name (to the right of the period) and then click <span CLASS="ElementNameeln">List Properties/Methods</span> on the shortcut menu.
<p CLASS="ListText1lt1">Some methods take a constant as an argument. To display a list of available constants when you're entering arguments for a method, right-click in the Module window and then click <span CLASS="ElementNameeln">List Constants</span> on the shortcut menu.
<p CLASS="ListText1lt1">If you've typed part of a property, method, or constant and want Microsoft Access to finish typing it for you, click <span CLASS="ElementNameeln">Complete Word</span> on the <span CLASS="ElementNameeln">Edit</span> menu.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Quick Info</span>&nbsp;&nbsp;&amp;nbspWhen you type a procedure or method name (followed by a space or an opening parenthesis), a tip automatically appears underneath the line of code you're writing. The tip gives syntax information about the procedure, such as the arguments you need to type to use it.</p>
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0206.jpg">
<p CLASS="ListText1lt1">To display syntax tips, select the <span CLASS="ElementNameeln">Auto Quick Info</span> check box on the <span CLASS="ElementNameeln">Module</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).
<p CLASS="ListText1lt1">In addition, you can view information on any variable, constant, or procedure in your code by right-clicking the item and then clicking <span CLASS="ElementNameeln">Quick Info</span> or <span CLASS="ElementNameeln">Parameter Info</span> on the shortcut menu.
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Automatic syntax checking</span>&nbsp;&nbsp;&amp;nbspAs you move the insertion point off a line, Visual Basic checks the syntax of that line and displays a message if it finds an error. To enable automatic syntax checking, select the <span CLASS="ElementNameeln">Auto Syntax Check</span> check box on the <span CLASS="ElementNameeln">Module</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Drag and drop</span>&nbsp;&nbsp;&amp;nbspIf you want to move code you've written from one place to another in a module or between windows, you don't need to bother with the <span CLASS="ElementNameeln">Copy</span> and <span CLASS="ElementNameeln">Paste</span> commands. Just select the code you want to move, and then drag it to the new location.</p>
<p CLASS="ListText1lt1">To enable drag-and-drop editing, select the <span CLASS="ElementNameeln">Drag-Drop In Editor</span> check box on the <span CLASS="ElementNameeln">Module</span> tab of the <span CLASS="ElementNameeln">Options</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu).
<p CLASS="ListText1lt1"></p>

<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Undo command</span>&nbsp;&nbsp;&nbsp;<span CLASS="ElementNameeln"><img SRC="..\images\UNDO.gif"></span>&amp;nbspMicrosoft Access keeps track of the changes you make when editing code. By clicking the <span CLASS="ElementNameeln">Undo</span> button one or more times, you can reverse any changes you've made to a module since you opened it.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on these features, or for a list of keyboard shortcuts in the Module window, search the Help index for &quot;Module window.&quot;</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>When several people are using the same database, they use separate versions of the forms, reports, and modules in the database. If one person changes code, the others must close and reopen the database in order to see those changes. More than one person can edit the same form, report, or module at the same time. If you attempt to save a form, report, or module that has already been changed by someone else, Microsoft Access warns you that the module has changed since you opened the database.</p>
<a NAME="5NavigatingBetweenProcedures"></a>
<p CLASS="heading5OrgHeading3h3">Navigating Between Procedures</p>
<p CLASS="Textttext">When you're editing code in the Module window, you can move between procedures in the module by pressing <span CLASS="KeyNamekn">CTRL+PAGE DOWN</span> and <span CLASS="KeyNamekn">CTRL+PAGE UP</span>. In addition, by selecting objects and their procedures or events in the <span CLASS="ElementNameeln">Object</span> and <span CLASS="ElementNameeln">Procedure</span> boxes, you can go directly to a procedure or create a new procedure.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Object box</span>&nbsp;&nbsp;&amp;nbspDisplays the name of the selected object. Click the arrow to the right of the <span CLASS="ElementNameeln">Object</span> box to display a list of all objects associated with the form, then click an object in the list to display its procedures or events in the <span CLASS="ElementNameeln">Procedure</span> box.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Procedure box</span>&nbsp;&nbsp;&amp;nbspWhen <span CLASS="ElementNameeln">(General)</span> appears in the <span CLASS="ElementNameeln">Object</span> box, the <span CLASS="ElementNameeln">Procedure</span> box displays the name of the current procedure. When an object name appears in the <span CLASS="ElementNameeln">Object</span> box, the <span CLASS="ElementNameeln">Procedure</span> box displays the name of the event for the current event procedure. Click the arrow to the right of the <span CLASS="ElementNameeln">Procedure</span> box to display all the events for an object. Events that have event procedures appear in bold in the list. In the following illustration, for example, the <span CLASS="ElementNameeln">Procedure</span> box displays a list of all the events for the OK command button, and the Click event appears in bold.</p>
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0207.jpg"></p>
<p CLASS="Textttext">Although the Module window normally displays one procedure at a time, you can also view all the procedures in a module at once. To switch between Procedure view and Full Module view, click the <span CLASS="ElementNameeln">Procedure View</span> and <span CLASS="ElementNameeln">Full Module View</span> buttons in the lower-left corner of the Module window, as shown in the following illustration.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0208.jpg"></p>
<a NAME="5UsingBookmarks"></a>
<p CLASS="heading5OrgHeading3h3">Using Bookmarks</p>
<p CLASS="Textttext">When working with a large application, it's easy to lose your place as you move between modules and procedures. To keep track of portions of code that you're working on, you can set a <span CLASS="NewTermntrm">bookmark</span> to mark your place. To set a bookmark on the current line of code, point to <span CLASS="ElementNameeln">Bookmarks</span> on the <span CLASS="ElementNameeln">Edit</span> menu, and then click <span CLASS="ElementNameeln">Toggle Bookmark</span>. A blue square in the left margin of the Module window indicates that your bookmark is set.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC0209.jpg"></p>
<p CLASS="Textttext">To return to bookmarks in a module, point to <span CLASS="ElementNameeln">Bookmarks</span> on the <span CLASS="ElementNameeln">Edit</span> menu, and then click <span CLASS="ElementNameeln">Next Bookmark</span> or <span CLASS="ElementNameeln">Previous Bookmark</span>. To clear all bookmarks in all modules, click <span CLASS="ElementNameeln">Clear All Bookmarks</span> on the <span CLASS="ElementNameeln">Bookmarks</span> submenu.</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba02_3.htm" OnClick="SyncURL(&quot;chapters/ba02_3.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
