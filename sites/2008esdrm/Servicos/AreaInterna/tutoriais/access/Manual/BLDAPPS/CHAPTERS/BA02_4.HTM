<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>Visual Basic Fundamentals</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba02_3.htm" OnClick="SyncURL(&quot;chapters/ba02_3.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<a NAME="3VisualBasicFundamentals"></a>
<p CLASS="heading3OrgHeading1h1">Visual Basic Fundamentals</p>
<p CLASS="Textttext">In a<span CLASS="KeyNamekn"> </span>simple application, you may need to use Visual Basic only to create event procedures and simple functions, as shown in the previous sections. However, as your applications get larger and more sophisticated, you'll want to use the full power of the Visual Basic language. This section lays out the fundamental rules for writing Visual Basic code in Microsoft Access.</p>
<a NAME="4StandardModulesandClassModules"></a>
<p CLASS="heading4OrgHeading2h2">Standard Modules and Class Modules</p>
<p CLASS="Textttext">You store your Visual Basic code in <span CLASS="NewTermntrm">modules</span> in a Microsoft Access database. Modules provide a way to organize your procedures.
<p CLASS="Textttext">Your database can contain two types of modules:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Standard modules</span>&nbsp;&nbsp;&amp;nbspYou use standard modules to store code you may want to run from anywhere in the application. You can call public procedures in standard modules from expressions, macros, event procedures, or procedures in other standard modules.</p>
<p CLASS="ListText1lt1">To create a new standard module, you can either click <span CLASS="ElementNameeln">New</span> on the <span CLASS="ElementNameeln">Modules</span> tab in the Database window, or you can click <span CLASS="ElementNameeln">Module</span> on the <span CLASS="ElementNameeln">Insert</span> menu.
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0217.jpg"></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Class modules</span>&nbsp;&nbsp;&amp;nbspYou use class modules to create your own custom objects. The <span CLASS="ElementNameeln">Sub</span> and <span CLASS="ElementNameeln">Function</span> procedures that you define in a class module become methods of the custom object. The properties you define with the <span CLASS="ElementNameeln">Property Get</span>, <span CLASS="ElementNameeln">Property</span> <span CLASS="ElementNameeln">Let</span>, and <span CLASS="ElementNameeln">Property Set</span> statements become properties of the custom object.</p>
<p CLASS="ListText1lt1">To create a new class module, click <span CLASS="ElementNameeln">Class Module</span> on the <span CLASS="ElementNameeln">Insert</span> menu. Saved class modules appear on the <span CLASS="ElementNameeln">Modules</span> tab in the Database window with saved standard modules. You can distinguish an open class module from an open standard module by the title bar of the Module window<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">the title bar for a class module always includes the label Class Module.
<p CLASS="ListText1lt1">Each form and report in your database can contain an associated form module or report module. Form and report modules are also class modules, but you can't save them separate from the form or report that they belong to. The class module that is associated with a form is especially useful because you can use it to create multiple instances of a form.
<p CLASS="ListText1lt1">Most frequently, you'll use a form or report module to contain event procedures associated with the form or report. Each module can also contain other procedures that belong to the form or report.
<p CLASS="ListText1lt1">A form or report module is part of the form or report's design. Thus, if you copy a form or report to another database, its module goes with it; if you delete a form or report, its module is deleted as well. Microsoft Access creates the form or report module automatically when you first add Visual Basic code to the form or report. All you need to do is write the event procedures and other procedures you want to store in the module.
<p CLASS="ListArt1la"><img SRC="..\images\ABAC0216.jpg"></p>
<a NAME="4WhatsInaModule"></a>
<p CLASS="heading4OrgHeading2h2">What's In a Module?</p>
<p CLASS="Textttext">A module can contain:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Declarations</span>&nbsp;&nbsp;&amp;nbspThese are statements that define variables, constants, user-defined types, and external procedures. The Declarations section of a module is separate from the procedures, and declarations in this section apply to every procedure in the module. You can also define variables and constants within a procedure, in which case they apply only to the procedure they're in.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Event procedures</span>&nbsp;&nbsp;&amp;nbspThese are <span CLASS="ElementNameeln">Sub</span> procedures that apply to a specific object; they run in response to a user or system event, such as a mouse click. Event procedures are always stored with a form or report in the form or report module.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">General procedures</span>&nbsp;&nbsp;&amp;nbspThese are procedures that aren't directly associated with an object or event. You can include general procedures in a standard module or a class module. General procedures can be either <span CLASS="ElementNameeln">Sub</span> procedures (procedures that don't return a value) or <span CLASS="ElementNameeln">Function</span> procedures (procedures that do return a value).</p>
<a NAME="4EventProcedures"></a>
<p CLASS="heading4OrgHeading2h2">Event Procedures</p>
<p CLASS="Textttext">When Microsoft Access recognizes that an event has occurred on a form, report, or control, it automatically runs the event procedure named for the object and event. If you want to run code in response to a particular event, you add code to the event procedure for that event.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on the Microsoft Access event model, see Chapter 6, <a HREF="../chapters/ba06_1.htm" OnClick="SyncURL(&quot;chapters/ba06_1.htm&quot;)">&quot;Responding to Events.&quot;</a> For more information on all events, search the Help index for &quot;events.&quot;</p>
<p CLASS="Textttext">When you create an event procedure (by using the procedures described earlier in this chapter), Microsoft Access automatically creates a code template for the event and adds it to the form or report module. The name of an event procedure for a form or report is a combination of the word &quot;Form&quot; or &quot;Report,&quot; an underscore (_), and the event name. For example, if you want a form to run an event procedure when it's clicked, use the procedure Form_Click. 
<p CLASS="Textttext">An event procedure for a control uses the same naming convention. For example, if you want a command button named MyButton to run an event procedure when it's clicked, use the procedure MyButton_Click. If a control name contains characters other than numbers or letters, such as spaces, Microsoft Access replaces those characters with an underscore (_) in any event procedures for the control.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>If you want to change the names of your controls, it's a good idea to do so before you start writing event procedures for them. If you change the name of a control after attaching a procedure to it, you also must change the name of the procedure to match the control's new name. Otherwise, Visual Basic can't match the control to the procedure. When a procedure name doesn't match a control name, Microsoft Access makes it a general procedure. You can find general procedures in the Module window by clicking <span CLASS="ElementNameeln">(General)</span> in the <span CLASS="ElementNameeln">Object</span> box, and then clicking the procedure name in the <span CLASS="ElementNameeln">Procedure</span> box.</p>
<a NAME="4GeneralProcedures"></a>
<p CLASS="heading4OrgHeading2h2">General Procedures</p>
<p CLASS="Textttext">Microsoft Access runs event procedures in response to a particular event on a form, report, or control. A general procedure, in contrast, runs only when you explicitly call it. A function, for example, is a type of general procedure.
<p CLASS="Textttext">Why use general procedures? One reason is to create your own functions to automate tasks you perform frequently. For example, you can create a function and then either create a custom menu command or custom toolbar button that runs the function, or use the function in an expression.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on customizing your menus and toolbars, see Chapter 1, <a HREF="../chapters/ba01_1.htm" OnClick="SyncURL(&quot;chapters/ba01_1.htm&quot;)">&quot;Creating an Application.&quot;</a> For information on using functions in expressions, search the Help index for &quot;expressions.&quot;</p>
<p CLASS="Textttext">Another reason to use general procedures is that you may want several different event procedures to perform the same actions. A good programming strategy is to put common code in a separate general procedure and have event procedures call it. This eliminates the need to duplicate code, making the application easier to maintain.
<p CLASS="Textttext">You can create general procedures either in a form or report module or in a standard module. If you want a general procedure that's always available from anywhere in your application, place it in a standard module. If a procedure applies primarily to a specific form or report, place it in the module for that form or report.</p>
<a NAME="4CreatingandCallingProcedures"></a>
<p CLASS="heading4OrgHeading2h2">Creating and Calling Procedures</p>
<p CLASS="Textttext">This section explains the syntax you use to create and call procedures in your application. Procedures can be either <span CLASS="ElementNameeln">Sub</span> procedures or <span CLASS="ElementNameeln">Function</span> procedures:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Sub</span> procedures perform operations, but they don't return a value and can't be used in expressions. <span CLASS="ElementNameeln">Sub</span> procedures can accept arguments. An event procedure is a <span CLASS="ElementNameeln">Sub</span> procedure that's attached to a form or report. When Microsoft Access recognizes that an event has occurred on a form, report, or control, it automatically runs the event procedure named for the object and event. For example, you can write an event procedure that sets the focus to a specified control when the user exits another control. </p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Function</span> procedures return a value, such as the result of a calculation. Because they return values, <span CLASS="ElementNameeln">Function</span> procedures can be used in expressions. Like <span CLASS="ElementNameeln">Sub</span> procedures, <span CLASS="ElementNameeln">Function</span> procedures can accept arguments. For example, you can write a function that calculates the first day of the month that follows a date you pass the function in an argument. Then you can use that function in an expression on a form or report. </p>
<a NAME="5SubProcedures"></a>
<p CLASS="heading5OrgHeading3h3">Sub Procedures</p>
<p CLASS="Textttext">The syntax for a <span CLASS="ElementNameeln">Sub</span> procedure is:</p>
<p CLASS="SyntaxTextsyn">[<span CLASS="ElementNameeln">Private|Public</span>]<span CLASS="ElementNameeln"> </span>[<span CLASS="ElementNameeln">Static</span>] <span CLASS="ElementNameeln">Sub</span> <span CLASS="NewTermntrm">procedurename</span> [(<span CLASS="NewTermntrm">arguments</span>)]
<p CLASS="SyntaxTextsyn">&nbsp;&nbsp;&nbsp;<span CLASS="NewTermntrm">statements</span>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">End Sub</span></p>
<p CLASS="Textttext">The <span CLASS="NewTermntrm">statements</span> are the Visual Basic statements that make up the code you want to run each time the procedure is called. The <span CLASS="NewTermntrm">arguments</span> are argument names, separated by commas if there are more than one. Each argument looks like a variable declaration and acts like a variable in the procedure. The syntax for each argument is:</p>
<p CLASS="SyntaxTextsyn">[<span CLASS="ElementNameeln">Optional</span>] [<span CLASS="ElementNameeln">ByVal</span>] <span CLASS="NewTermntrm">variablename</span> [( )] [<span CLASS="ElementNameeln">As</span> <span CLASS="NewTermntrm">type</span>]</p>
<p CLASS="Textttext"><span CLASS="NewTermntrm">Type</span> can be any of the fundamental data types: <span CLASS="ElementNameeln">Byte</span>, <span CLASS="ElementNameeln">Integer</span>, <span CLASS="ElementNameeln">Long</span>, <span CLASS="ElementNameeln">Single</span>, <span CLASS="ElementNameeln">Double</span>, <span CLASS="ElementNameeln">Currency</span>, <span CLASS="ElementNameeln">String</span>, <span CLASS="ElementNameeln">Boolean</span>, <span CLASS="ElementNameeln">Date</span>, <span CLASS="ElementNameeln">Object</span>, or <span CLASS="ElementNameeln">Variant</span>. If you don't provide a type, the argument takes the <span CLASS="ElementNameeln">Variant</span> type and can contain any kind of data. Parentheses after <span CLASS="NewTermntrm">variablename</span> indicate that the argument is an array.
<p CLASS="Textttext">By default, arguments to a procedure are passed by reference, meaning that changing the value of the variable changes it in the calling procedure as well. To pass arguments by value rather than by reference, use the <span CLASS="ElementNameeln">ByVal </span>keyword.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on the <span CLASS="ElementNameeln">Optional</span> keyword, see <a HREF="../chapters/ba02_4.htm#5UsingaVariableNumberofArguments" OnClick="SyncURL(&quot;chapters/ba02_4.htm&quot;)">&quot;Using a Variable Number of Arguments&quot;</a> later in this chapter. For information on the<span CLASS="ElementNameeln"> Static </span>and<span CLASS="ElementNameeln"> Private </span>keywords, search the Help index for &quot;Sub statement.&quot;</p>
<p CLASS="Textttext">When you call a <span CLASS="ElementNameeln">Sub</span> procedure, you specify the arguments you want the procedure to use. For example, the following <span CLASS="ElementNameeln">Sub</span> procedure makes a beep sound the number of times you specify with the <span CLASS="NewTermntrm">intBeeps</span> argument.</p>
<p CLASS="CodeTextct">Sub MultiBeep(intBeeps As Integer)<br>&nbsp;&nbsp;&amp;nbspDim intX As Integer, lngY As Long<br>&nbsp;&nbsp;&amp;nbspFor intX = 1 To intBeeps<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspBeep<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspFor lngY = 1 To 100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Short delay between beeps.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspNext lngY<br>&nbsp;&nbsp;&amp;nbspNext intX<br>End Sub</p>
<p CLASS="Textttext">The following statement calls the MultiBeep <span CLASS="ElementNameeln">Sub</span> procedure by using an <span CLASS="NewTermntrm">intBeeps</span> argument of 3, making a beep sound three times.</p>
<p CLASS="CodeTextct">MultiBeep 3</p>
<p CLASS="Textttext">You don't enclose arguments in parentheses when you call a <span CLASS="ElementNameeln">Sub</span> procedure, as you do when you declare one.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>To make your code more readable, you can pass arguments to <span CLASS="ElementNameeln">Sub</span> or <span CLASS="ElementNameeln">Function</span> procedures by name. For example, the following call to the MultiBeep <span CLASS="ElementNameeln">Sub</span> procedure passes the <span CLASS="NewTermntrm">intBeeps</span> argument by name:</p>
<p CLASS="NoteCodeTextnct">MultiBeep intBeeps:=3</p>
<p CLASS="NoteTextnt">When you pass multiple arguments by name, you can include them in any order you want. For more information on passing arguments by name, search the Help index for &quot;named arguments.&quot;</p>
<a NAME="5FunctionProcedures"></a>
<p CLASS="heading5OrgHeading3h3">Function Procedures</p>
<p CLASS="Textttext">The syntax for a <span CLASS="ElementNameeln">Function</span> procedure is:</p>
<p CLASS="SyntaxTextsyn">[<span CLASS="ElementNameeln">Private|Public</span>]<span CLASS="ElementNameeln"> </span>[<span CLASS="ElementNameeln">Static</span>] <span CLASS="ElementNameeln">Function</span> <span CLASS="NewTermntrm">procedurename</span> [(<span CLASS="NewTermntrm">arguments</span>)] [<span CLASS="ElementNameeln">As</span> <span CLASS="NewTermntrm">type</span>]
<p CLASS="SyntaxTextsyn">&nbsp;&nbsp;&nbsp;<span CLASS="NewTermntrm">statements</span>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">End Function</span></p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on the<span CLASS="ElementNameeln"> Static </span>and<span CLASS="ElementNameeln"> Private </span>keywords, search the Help index for &quot;Function statement.&quot;</p>
<p CLASS="Textttext">The arguments for a <span CLASS="ElementNameeln">Function</span> procedure work in exactly the same way as the arguments for a <span CLASS="ElementNameeln">Sub</span> procedure, and have the same syntax. <span CLASS="ElementNameeln">Function</span> procedures differ from <span CLASS="ElementNameeln">Sub</span> procedures in three ways:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYou enclose arguments in parentheses both when declaring and when calling a <span CLASS="ElementNameeln">Function</span> procedure.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Function</span> procedures, like variables, have data types that determine the type of the return value.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspYou return a value by assigning it to the <span CLASS="NewTermntrm">procedurename</span> itself. The value returned by the <span CLASS="ElementNameeln">Function</span> procedure can then be used as part of a larger expression.</p>
<p CLASS="Textttext">For example, you could write a <span CLASS="ElementNameeln">Function</span> procedure that calculates the third side, or hypotenuse, of a right triangle given the other two sides.</p>
<p CLASS="CodeTextct">Function Hypotenuse (dblA As Double, dblB As Double) As Double<br>&nbsp;&nbsp;&amp;nbspHypotenuse = Sqr(dblA ^ 2 + dblB ^ 2)<br>End Function</p>
<p CLASS="Textttext">You call a <span CLASS="ElementNameeln">Function</span> procedure the same way you call any of the built-in functions in Visual Basic. For example:</p>
<p CLASS="CodeTextct">dblResult = Hypotenuse(dblWidth, dblHeight)
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>If you aren't interested in the result of a <span CLASS="ElementNameeln">Function</span> procedure, you can call it without including parentheses or assigning it to a variable, as you would a <span CLASS="ElementNameeln">Sub</span> procedure. For example, you can use the following code to call a function called DisplayForm and ignore its return value:</p>
<p CLASS="CodeTextct">DisplayForm strMessage</p>
<a NAME="5UsingaVariableNumberofArguments"></a>
<p CLASS="heading5OrgHeading3h3">Using a Variable Number of Arguments</p>
<p CLASS="Textttext">You can declare optional arguments in a procedure definition with the <span CLASS="ElementNameeln">Optional</span> keyword. An optional argument is one that doesn't have to be passed every time you call the procedure. You must declare optional arguments after any required arguments in the argument list. They can be of any type.
<p CLASS="Textttext">If you include an optional argument in a procedure definition, then you need to consider what happens in the procedure when the argument is not passed. You can initialize an optional argument to a default value when you declare the argument, so that if the optional argument is not included when the procedure is called, the default value is used. If you don't initialize the argument to a default value, Microsoft Access initializes it as it would initialize a variable of that type. If the argument is a number type, then it is initialized to zero. If it is a string, then it is initialized to a zero-length string (&quot;&quot;).
<p CLASS="Textttext">In the following example, if a value is not passed for the optional argument, this argument is assigned the default value of 100.</p>
<p CLASS="CodeTextct">Sub DisplayError(strText As String, Optional intNumber As Integer = 100)<br>&nbsp;&nbsp;&amp;nbspIf intNumber = 100 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox strText<br>&nbsp;&nbsp;&amp;nbspElse<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspMsgBox intNumber &amp; &quot;: &quot; &amp; strText<br>&nbsp;&nbsp;&amp;nbspEnd If<br>End Sub</p>
<p CLASS="Textttext">You can call the procedure with either of the following lines of code.</p>
<p CLASS="CodeTextct">DisplayError &quot;Invalid Entry&quot;<br>DisplayError &quot;Invalid Entry&quot;, 250</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>If an optional argument is of type <span CLASS="ElementNameeln">Variant</span>, then you can use the <span CLASS="ElementNameeln">IsMissing</span> function to determine whether an optional argument was included when the procedure was called. The <span CLASS="ElementNameeln">IsMissing</span> function only works with arguments of type <span CLASS="ElementNameeln">Variant</span>.</p>
<p CLASS="Textttext">To write a procedure that accepts an arbitrary number of arguments, use the <span CLASS="ElementNameeln">ParamArray</span> keyword to pass an array of arguments with the <span CLASS="ElementNameeln">Variant</span> data type. With the <span CLASS="ElementNameeln">ParamArray</span> keyword, you can write functions like Sum, which calculates the sum of an arbitrary number of arguments.</p>
<p CLASS="CodeTextct">Function Sum(ParamArray varNumbers() As Variant) As Double<br>&nbsp;&nbsp;&amp;nbspDim dblTotal As Double, var As Variant<br>&nbsp;&nbsp;&amp;nbspFor Each var In varNumbers<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbspdblTotal = dblTotal + var<br>&nbsp;&nbsp;&amp;nbspNext var<br>&nbsp;&nbsp;&amp;nbspSum = dblTotal<br>End Function</p>
<p CLASS="Textttext">You can call the Sum function with the following line of code.</p>
<p CLASS="CodeTextct">dblSum = Sum(1, 3, 5, 7, 8)</p>
<a NAME="5CallingProceduresfromOtherModules"></a>
<p CLASS="heading5OrgHeading3h3">Calling Procedures from Other Modules</p>
<p CLASS="Textttext">Unless you specify otherwise, general procedures you create are <span CLASS="NewTermntrm">public</span>, meaning that you can call them from anywhere in your application.
<p CLASS="TipIcontpi"></p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>If you know you will use a procedure only within its module, you should declare it with the <span CLASS="ElementNameeln">Private</span> keyword to avoid confusion and to speed up compilation of your code. Event procedures are always declared with the <span CLASS="ElementNameeln">Private </span>keyword, because they normally apply only to the form or report in which they are stored. For information on procedures declared with the<span CLASS="ElementNameeln"> Private </span>keyword, search the Help index for &quot;Private statement.&quot;</p>
<p CLASS="Textttext">When you call a procedure that isn't in the current module, Microsoft Access searches other modules and runs the first public procedure it finds that has the name you called. If the name of a public procedure isn't unique in the database, you can specify the module it's in when you call the procedure. For example, to run a <span CLASS="ElementNameeln">Sub</span> procedure called DisplayMsg that's stored in a module called Utility, you use the following code:</p>
<p CLASS="CodeTextct">Utility.DisplayMsg</p>
<p CLASS="Textttext">You can call procedures in a class module from other modules as well. To do this, specify the name of the class module along with the procedure name. For example, to run a <span CLASS="ElementNameeln">Function</span> procedure called AddValues in a class module called Class1 and print the result to the Debug window, use the following code:</p>
<p CLASS="CodeTextct">Debug.Print Class1.AddValues</p>
<p CLASS="Textttext">Because form and report modules are also class modules, you call a procedure in a form or report module in the same way. To call a procedure in a form or report module, specify the name of the form or report module along with the procedure name. The name of the form or report module includes the qualification Form_ or Report_ followed by the name of the form or report. For example, to run a <span CLASS="ElementNameeln">Sub</span> procedure called DisplayRecords that's stored with the Orders form, use the following code:</p>
<p CLASS="CodeTextct">Form_Orders.DisplayRecords</p>
<p CLASS="Textttext">Alternatively, you can call a procedure in a class module or a form or report module by referring to an object variable that points to an instance of either the class or the form or report. For example, the following code opens an instance of the Orders form, and then runs the DisplayRecords procedure.</p>
<p CLASS="CodeTextct">Dim frmOrders As New Form_Orders&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Declare an object variable.<br>frmOrders.Visible = True&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Open and display the Orders form.<br>frmOrders.DisplayRecords&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Call the form's procedure.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>Set frmOrders = Nothing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' Close the Orders form.</p>
<p CLASS="Textttext">By storing the DisplayRecords procedure in the Orders form module and making it public, you in effect create a custom method of the Orders form.</p>
<p CLASS="CodeTextct">Sub DisplayRecords<br>' This procedure can be called from another form<br>' to cause the Orders form to update itself.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>&nbsp;&nbsp;&nbsp;.<br>End Sub</p>
<a NAME="4UsingVariables"></a>
<p CLASS="heading4OrgHeading2h2">Using Variables</p>
<p CLASS="Textttext">Often you store values temporarily when performing calculations with Visual Basic. For example, you may want to calculate several values, compare them, and perform different operations on them, depending on the result of the comparison. You want to retain the values so you can compare them, but because you need to store them only while your code is running, you don't want to store them in a table.
<p CLASS="Textttext">Visual Basic uses <span CLASS="NewTermntrm">variables</span> to store values. Variables are like fields except that they exist within Visual Basic rather than in a table. Like a field, a variable has a name, which you use to refer to the value the variable contains, and a data type, which determines the kind of data the variable can store. Before you use a variable, it's a good idea to declare it with a <span CLASS="ElementNameeln">Dim</span> statement, which tells Microsoft Access to set aside space for the variable.
<p CLASS="Textttext">For example, in the following procedure, <span CLASS="CodeTextEmbeddedcte">dtmAny</span>, <span CLASS="CodeTextEmbeddedcte">dtmYear</span>, and <span CLASS="CodeTextEmbeddedcte">dtmMonth</span> are variables with the <span CLASS="ElementNameeln">Date</span> data type.</p>
<p CLASS="CodeTextct">Function DueDate(dtmAny As Date)<br>&nbsp;&nbsp;&amp;nbspDim dtmYear As Date, dtmMonth As Date<br>&nbsp;&nbsp;&amp;nbspdtmYear = Year(dtmAny)<br>&nbsp;&nbsp;&amp;nbspdtmMonth = Month(dtmAny) + 1<br>&nbsp;&nbsp;&amp;nbspDueDate = DateSerial(dtmYear, dtmMonth, 1)<br>End Function</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on declaring and using variables, see Chapter 4, <a HREF="../chapters/ba04_1.htm" OnClick="SyncURL(&quot;chapters/ba04_1.htm&quot;)">&quot;Working with Variables, Data Types, and Constants.&quot;</a></p>
<a NAME="4NamingConventions"></a>
<p CLASS="heading4OrgHeading2h2">Naming Conventions </p>
<p CLASS="Textttext">While you are writing your Visual Basic code, you declare and name many elements (<span CLASS="ElementNameeln">Sub</span> and <span CLASS="ElementNameeln">Function</span> procedures, variables and constants, and so forth). The names of the procedures, variables, and constants you declare in your Visual Basic code must:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspBegin with a letter.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspContain only letters, numbers, and the underscore character (_); punctuation characters and spaces aren't allowed.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspBe no longer than 255 characters.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&amp;nbspContain no keywords.</p>
<p CLASS="Textttext">A <span CLASS="NewTermntrm">keyword</span> is a word that Visual Basic uses as part of its language. This includes predefined statements (such as <span CLASS="ElementNameeln">If</span> and <span CLASS="ElementNameeln">Loop</span>), functions (such as <span CLASS="ElementNameeln">Len </span>and <span CLASS="ElementNameeln">Abs</span>), methods (such as <span CLASS="ElementNameeln">Close</span> and <span CLASS="ElementNameeln">FindFirst</span>), and operators (such as <span CLASS="ElementNameeln">Or </span>and <span CLASS="ElementNameeln">Mod</span>).</p>
<a NAME="4ControllingExecution"></a>
<p CLASS="heading4OrgHeading2h2">Controlling Execution</p>
<p CLASS="Textttext">Visual Basic has several commands that help you control the execution of your code. For example, you can define groups of statements that may or may not be run, depending on the value of an expression, or you can define groups of statements that Visual Basic runs repeatedly.
<p CLASS="Textttext">To run code conditionally, use the following statements:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">If...Then</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">If...Then...Else</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Select Case</span></p>
<p CLASS="Textttext">To run one or more lines of code repetitively, use the following statements:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Do...Loop</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">For...Next</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">While...Wend</span></p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on using these statements, search the Help index for any keyword in the statement.</p>
<a NAME="4UsingtheDoCmdObjecttoPerformMacroActions"></a>
<p CLASS="heading4OrgHeading2h2">Using the DoCmd Object to Perform Macro Actions</p>
<p CLASS="Textttext">Many common actions you perform in an application don't have a corresponding command in the Visual Basic language. To perform the equivalent of a macro action, use methods of the <span CLASS="ElementNameeln">DoCmd</span> object. The syntax for the <span CLASS="ElementNameeln">DoCmd</span> object is:</p>
<p CLASS="SyntaxTextsyn">[<span CLASS="ElementNameeln">Application.</span>]<span CLASS="ElementNameeln">DoCmd</span>.<span CLASS="NewTermntrm">method</span> [<span CLASS="NewTermntrm">arguments</span>]</p>
<p CLASS="Textttext">Replace <span CLASS="NewTermntrm">method </span>with the name of a macro action. How many and what kind of arguments come after <span CLASS="NewTermntrm">method</span> depends on the specific macro action you want to run. Specifying the <span CLASS="ElementNameeln">Application</span> object is optional; you can start a line with the <span CLASS="ElementNameeln">DoCmd</span> object.
<p CLASS="Textttext">For example, the <span CLASS="ElementNameeln">Close</span> method, which corresponds to the Close action, takes two arguments that specify the type and name of the database object you want to close. You use commas to separate the arguments when a method takes multiple arguments.</p>
<p CLASS="CodeTextct">DoCmd.Close acForm, &quot;Add Products&quot;</p>
<p CLASS="Textttext">The first argument, <span CLASS="ElementNameeln">acForm</span>, is a Microsoft Access <span CLASS="NewTermntrm">intrinsic constant</span> specifying that the object to be closed is a form. Microsoft Access automatically declares a number of intrinsic constants that you can use to represent a variety of objects, actions, or data types. For example, you often use intrinsic constants with methods of the <span CLASS="ElementNameeln">DoCmd</span> object to specify action arguments that you can enter in the lower part of the Macro window.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on intrinsic constants, see Chapter 4, <a HREF="../chapters/ba04_1.htm" OnClick="SyncURL(&quot;chapters/ba04_1.htm&quot;)">&quot;Working with Variables, Data Types, and Constants.&quot;</a></p>
<p CLASS="Textttext">Some methods of the <span CLASS="ElementNameeln">DoCmd</span> object take optional arguments. If you leave these arguments unspecified, Microsoft Access uses their default values. For example, if you leave both arguments for the <span CLASS="ElementNameeln">Close</span> method unspecified, Microsoft Access closes the active database object (whatever it may be).</p>
<p CLASS="CodeTextct">DoCmd.Close</p>
<p CLASS="Textttext">If you omit an optional argument but specify an argument that follows that argument, you must include a comma as a placeholder for the omitted argument. For example, the syntax for the <span CLASS="ElementNameeln">MoveSize</span> method is:</p>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">DoCmd.MoveSize</span> [<span CLASS="NewTermntrm">right</span>] [<span CLASS="ElementNameeln">,</span> <span CLASS="NewTermntrm">down</span>] [<span CLASS="ElementNameeln">, </span><span CLASS="NewTermntrm">width</span>] [<span CLASS="ElementNameeln">,</span> <span CLASS="NewTermntrm">height</span>]</p>
<p CLASS="Textttext">The following code uses the default (current) settings for its <span CLASS="NewTermntrm">right</span> and <span CLASS="NewTermntrm">down</span> arguments, while using the specified values for its <span CLASS="NewTermntrm">width</span> and <span CLASS="NewTermntrm">height</span> arguments.</p>
<p CLASS="CodeTextct">DoCmd.MoveSize , , 5000, 3000</p>
<p CLASS="Textttext">You can use methods of the <span CLASS="ElementNameeln">DoCmd</span> object to perform most macro actions, including the RunMacro action (which runs an existing macro as if it were a procedure). However, eight macro actions have no equivalent methods of the <span CLASS="ElementNameeln">DoCmd </span>object. In most cases, Visual Basic provides equivalent functionality with built-in statements or functions.</p>
<!--mstheme--></font><table WIDTH="100%" BORDER="0" CELLPADDING="5" CELLSPACING="0" FRAME="VOID" RULES="THEAD"><thead>
<tr VALIGN="TOP" BGCOLOR="#DDDDDD">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Action</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableHeadingth">Visual Basic equivalent</p></font><!--mstheme--></font></td></tr><tbody>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">AddMenu</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">No equivalent</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">MsgBox</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">MsgBox statement or </span>function</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">RunApp</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Shell </span>function</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">RunCode</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Procedure call</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">SendKeys</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">SendKeys </span>statement</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">SetValue</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">Assignment statement</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">StopAllMacros</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Stop</span> or <span CLASS="ElementNameeln">End</span> statements</p></font><!--mstheme--></font></td></tr>
<tr VALIGN="TOP">
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt">StopMacro</p></font><!--mstheme--></font></td>
<td><!--mstheme--><font face="book antiqua, times new roman, times"><font FACE="Arial" SIZE="2">
<p CLASS="TableTexttt"><span CLASS="ElementNameeln">Exit Sub</span> or <span CLASS="ElementNameeln">Exit Function</span> statements</p></font><!--mstheme--></font></td></tr>
</table><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on methods of the <span CLASS="ElementNameeln">DoCmd</span> object, search the Help index for &quot;DoCmd object.&quot;</p>
<a NAME="4UsingtheRunCommandMethodtoPerformMenuCommands"></a>
<p CLASS="heading4OrgHeading2h2">Using the RunCommand Method to Perform Menu Commands</p>
<p CLASS="Textttext">Occasionally, you may want your application to perform a command that's on a Microsoft Access menu or toolbar. To perform a built-in command just as if the user clicked it, use the <span CLASS="ElementNameeln">RunCommand</span> method. The syntax for the<span CLASS="ElementNameeln"> RunCommand</span> <br>method is:</p>
<p CLASS="SyntaxTextsyn"><span CLASS="ElementNameeln">RunCommand</span> <span CLASS="Placeholderp">command</span></p>
<p CLASS="Textttext"><span CLASS="NewTermntrm">Command</span> is a constant that corresponds to the Microsoft Access command you want to run. For example, the following line of code performs the <span CLASS="ElementNameeln">Options</span> command, causing Microsoft Access to display the <span CLASS="ElementNameeln">Options</span> dialog box:</p>
<p CLASS="CodeTextct">RunCommand acCmdOptions</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>To determine the constant for the command you want to run, search the Help index for &quot;RunCommand method.&quot;</p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba02_5.htm" OnClick="SyncURL(&quot;chapters/ba02_5.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
