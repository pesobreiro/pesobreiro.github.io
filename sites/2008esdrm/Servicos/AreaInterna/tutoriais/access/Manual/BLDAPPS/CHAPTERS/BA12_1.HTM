<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>CHAPTER 12</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba11_4.htm" OnClick="SyncURL(&quot;chapters/ba11_4.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<p CLASS="heading2ChapterNumberAppendixLetterchn">CHAPTER&nbsp; 12</p>
<p CLASS="ChapterAppendixTitlecht">Using Library Databases and Dynamic-Link Libraries</p>
<p CLASS="ChapterSummaryTextchsum">A library database is a collection of procedures and database objects that you can call from any application. You can use libraries to store routines that you use often,<span CLASS="ElementNameeln"> </span>so you don't have to write the same routine for each application you create. You can also use libraries to distribute new features to your users. </p>
<p CLASS="Textttext">A dynamic-link library (DLL) is a file containing procedures that your application can link to and use at run time. This chapter shows you how to create and use your own Microsoft Access library databases, and how to call routines in dynamic-link libraries.
<a NAME="3UsingLibraryDatabases"></a>
<p CLASS="heading3OrgHeading1h1">Using Library Databases</p>
<p CLASS="Textttext">When you create an application, the objects and Visual Basic code in the application database work only within that application. For example, you can call functions in the UtilityFunctions module in the Orders sample application only from the objects in the Orders database<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">they aren't available from other databases. That works fine for objects and code that you use in only one application. However, you may begin accumulating a set of general-purpose functions that you'd like to be able to call from any application, without re-creating the functions in each separate application database.
<p CLASS="Textttext">You can create a <span CLASS="NewTermntrm">library database</span> to store such general-purpose functions. For example, the IsLoaded function in the Orders database's UtilityFunctions module is a good candidate for a library function. This function doesn't contain any hard-coded names from the Northwind database, such as form names or field names. Instead, you pass it a form name as an argument to determine whether the form is loaded. If you store this function in a library, you can use it with any open database.
<p CLASS="Textttext">You can also create new features for Microsoft Access and use library databases to distribute these features to users. The following sections show you how to create and use library databases of your own.</p>
<a NAME="4CreatingLibraryDatabases"></a>
<p CLASS="heading4OrgHeading2h2">Creating Library Databases</p>
<p CLASS="Textttext">Anytime you want to make a procedure or feature available to multiple applications, add it to a library database. Here are the basic steps for creating a library in Microsoft Access:
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step One: Write the functions and create the objects&nbsp;&nbsp;&nbsp;</span>In a new database, write and debug the Visual Basic functions that you want to be available in a library. Design and create the forms and other objects that make up the interface for any generic feature. Because the forms that make up the feature's interface and the Visual Basic functions that make it work are all stored in the library database, they're available in any database from which you establish a reference.
<p CLASS="Textttext">Unlike Microsoft Access versions 2.<span CLASS="NewTermntrm">x</span> and earlier, duplicate function names in different libraries don't result in a conflict. Given two functions with duplicate names in two referenced libraries, Microsoft Access uses the function in the library with the highest priority specified in the <span CLASS="ElementNameeln">References</span> dialog box (<span CLASS="ElementNameeln">Tools</span> menu). If you need to call a function that is in a library lower in the priority list, qualify the function call with the name of the module that it resides in.
<p CLASS="Textttext"><span CLASS="ElementNameeln">Step Two: Load the database as a library&nbsp;&nbsp;&nbsp;</span>You may want to rename the database so its file name extension is .mda instead of .mdb. (By convention, library databases have a .mda file name extension.) Then add a reference to the library by way of the <span CLASS="ElementNameeln">References</span> dialog box so that Microsoft Access loads the database as a library when you make a call to that library from your code.
<p CLASS="Textttext">When you are selecting databases to reference, click <span CLASS="ElementNameeln">Databases</span> in the <span CLASS="ElementNameeln">Files Of Type</span> box to see a list of files with .mdb and .mda extensions.</p>
<p CLASS="ImportantTextit"><span CLASS="ImportantHeadingih">Important&nbsp;&nbsp;&nbsp;</span>You need to establish this reference to every database that will use the library.</p>
<p CLASS="Textttext">After you load the database as a library, you can call the functions in the library database from your application, and you can use code in the library database to open forms or other objects stored in the library database and display them in the current application.</p>
<a NAME="4ReferencingLibraryDatabases">
<p CLASS="heading4OrgHeading2h2">Referencing Library Databases</p></a>
<p CLASS="Textttext">Microsoft Access doesn't actually load a library database into memory until code in an active application calls that library. If you want to use a library from your application, you must first establish a link, called a <span CLASS="NewTermntrm">reference</span>, from your application to that library database. You can add a reference to one or more library databases in your application by using the <span CLASS="ElementNameeln">References</span> dialog box.
<p CLASS="Textttext">To get to the <span CLASS="ElementNameeln">References</span> dialog box, click <span CLASS="ElementNameeln">References</span> on the <span CLASS="ElementNameeln">Tools</span> menu when a Visual Basic module is open. The following figure shows how you can select libraries to reference.</p>
<p CLASS="Arta"><img SRC="..\images\ABAC1201.jpg"></p>
<p CLASS="Textttext">You can also use the <span CLASS="ElementNameeln">References</span> dialog box to view currently existing references in any open database.
<p CLASS="Textttext">Another way to add a reference to a library database is to use the <span CLASS="ElementNameeln">Reference</span> object and the <span CLASS="ElementNameeln">References</span> collection in your Visual Basic code. To establish a reference in Visual Basic, create a new <span CLASS="ElementNameeln">Reference</span> object with either the <span CLASS="ElementNameeln">AddFromFile</span> or <span CLASS="ElementNameeln">AddFromGUID</span> method of the <span CLASS="ElementNameeln">References</span> collection. Use the <span CLASS="ElementNameeln">AddFromFile </span>method if you know the full path and file name of the file that contains the library you want to add a reference to. Use the <span CLASS="ElementNameeln">AddFromGUID</span> method if you know the library's 16-bit unique identifier. You can retrieve this value from the <span CLASS="ElementNameeln">GUID </span>property of a <span CLASS="ElementNameeln">Reference</span> object after a reference has been established, and use it to re-create the reference if necessary.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on establishing references by using Visual Basic, search the Help index for &quot;referencing, other databases.&quot;</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>When you establish a reference, the full path to that library database is stored with the reference. If you move the library database to a different folder, or if you change the name of the folder, you need to reestablish the reference. When you are designing an application that will be distributed to other users, you'll want to implement error-handling routines which control what happens when a library database cannot be loaded.</p>
<p CLASS="Textttext">Once you have established your references, you can call functions in the library database from code in your application. Then you can use functions in the library database to open its forms and other objects and display them in the application. Even though you can use the code and the database objects in the library database, they don't appear in the Database window of the open database.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>While Microsoft Access supports references to multiple libraries, it doesn't support circular references between libraries. A single library A can establish a reference and call functions in another library B, but as long as that reference exists, library B cannot establish a reference to library A.</p>
<a NAME="4DebuggingLibraryDatabases"></a>
<p CLASS="heading4OrgHeading2h2">Debugging Library Databases</p>
<p CLASS="Textttext">While you're creating objects and writing code in a library database, you open the library as a database and work in it as you would any other database. It's a good idea to get the objects in the library database working the way you want them to and to debug all Visual Basic code before you use the database as a library.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on debugging, see Chapter 7, <a HREF="../chapters/ba07_1.htm" OnClick="SyncURL(&quot;chapters/ba07_1.htm&quot;)">&quot;Debugging Visual Basic Code.&quot;</a></p>
<p CLASS="Textttext">Sometimes objects and code that work perfectly in the context of the open library database can have trouble running in the context of your application, where new bugs and behavior can emerge. Therefore, after loading the database as a library, you may still need to make some adjustments to your objects and code. If you have problems with your application that appear to be related to the behavior of a library you have referenced, close the current database you are working in and open the library database for testing and debugging.</p>
<a NAME="4RunningMacrosandActionsinLibraryDatabases"></a>
<p CLASS="heading4OrgHeading2h2">Running Macros and Actions in Library Databases</p>
<p CLASS="Textttext">You can attach macros to forms and reports in a library database and run them from the library database. This includes menu bar macros that you attach to forms in the library database. 
<p CLASS="Textttext">When a library database calls a macro, Microsoft Access looks first for a macro of that name in the library database and, if it finds one, runs that macro. If the library database that called the macro doesn't contain a macro of that name, Microsoft Access looks for the macro in the current database.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>It's a good idea to avoid using macros in library databases when possible. Macros don't provide the error-handling capabilities of Visual Basic, so you can't trap run-time errors that may occur when you run a library database macro. In addition, it's much easier to debug a library database that uses Visual Basic rather than macros. You carry out macro actions in Visual Basic by using the <span CLASS="ElementNameeln">DoCmd</span> object. For more information, search the Help index for &quot;DoCmd object.&quot;</p>
<p CLASS="Textttext">Certain actions, such as OpenForm and OpenReport, have arguments that specify the object on which the action performs its operation. When you carry out these actions from a library database<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">whether in a macro or by using the <span CLASS="ElementNameeln">DoCmd</span> object in Visual Basic<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">Microsoft Access looks first for an object of that name in the library database that called the action and, if it finds one, performs the operation on that object. If the library database that called the action doesn't contain an object of that name, Microsoft Access looks for the object in the current database.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on how Microsoft Access handles objects referred to by a specific action, search the Help index for the name of the action.</p>
<a NAME="4StoringCustomToolbarsinLibraryDatabases"></a>
<p CLASS="heading4OrgHeading2h2">Storing Custom Toolbars in Library Databases</p>
<p CLASS="Textttext">If you want to store custom toolbars for your application in a library database and show or hide them by carrying out the ShowToolbar action from the library, then the database must be loaded as an add-in.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For more information on installing add-ins, see Chapter 17, <a HREF="../chapters/ba17_1.htm" OnClick="SyncURL(&quot;chapters/ba17_1.htm&quot;)">&quot;Creating Wizards, Builders, and Menu Add-ins.&quot;</a></p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba12_2.htm" OnClick="SyncURL(&quot;chapters/ba12_2.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
