<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html><head><title>CHAPTER 2</title>
<link REL="STYLESHEET" HREF="naetugp.css" TYPE="text/css">
<script Language="VBScript">
Dim look
Sub SyncURL(look)
if right(top.frames(0).frames(1).location.href, 10)="toc_tc.htm" then
top.frames(0).frames(1).TreeCtl1.SyncToURL(look)
end if
End Sub
</script>
<meta name="Microsoft Theme" content="expeditn 011, default"></head>
<!--DocHeaderStart-->
<body background="../../../../_themes/expeditn/exptextb.jpg" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#666600" alink="#CC3300"><!--mstheme--><font face="book antiqua, times new roman, times"><a HREF="ba01_8.htm" OnClick="SyncURL(&quot;chapters/ba01_8.htm&quot;)"><img SRC="..\images\prevpage.gif" ALT="Previous Page" ALIGN="RIGHT" BORDER="0"></a>
<!--DocHeaderEnd-->
<!-- This is a PANDA Generated HTML file. The source is a WinWord Document. -->
<p CLASS="heading2ChapterNumberAppendixLetterchn">CHAPTER&nbsp; 2</p>
<p CLASS="ChapterAppendixTitlecht">Introducing Visual Basic</p>
<p CLASS="ChapterSummaryTextchsum">When you're looking for a level of power and control over your application that goes beyond what you can find in the Microsoft Access interface, Visual Basic is the place to find it. This chapter shows you how to use Visual Basic to respond to events on forms and reports, and how to create custom functions. It also introduces you to the fundamentals of the Visual Basic programming language.
<a NAME="3WhatIsVisualBasic"></a>
<p CLASS="heading3OrgHeading1h1">What Is Visual Basic?</p>
<p CLASS="Textttext">Visual Basic is the programming language for Microsoft Access. You use it for the same reason you use macros<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">to tie the objects in your application together into a coherent system. The difference is that Visual Basic provides more power and a finer degree of control than you get by using macros alone.</p>
<!--mstheme--></font><table CELLPADDING="3" BORDER="2" BORDERCOLOR="#0000FF" bordercolordark="#660000" bordercolorlight="#CC9966"><tr BGCOLOR="#FFFFFF"><td><!--mstheme--><font face="book antiqua, times new roman, times">
<p CLASS="SidebarHeadingsbrh">Some Familiar Territory for the Seasoned Programmer</p>
<p CLASS="SidebarTextsbrt">Visual Basic is a modern programming language that strongly resembles most of the popular, structured programming languages. If you're a Pascal or C programmer, you'll find all the program structures you're used to<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">loops, <span CLASS="ElementNameeln">If...Then...Else</span> statements, <span CLASS="ElementNameeln">Select Case</span> statements, functions, and subroutines<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">with only superficial differences. With all its improvements from earlier versions of Basic, Visual Basic retains its English-like flavor and ease of use.</p><!--mstheme--></font></td></tr></table><!--mstheme--><font face="book antiqua, times new roman, times">
<a NAME="4WhentoUseVisualBasicInsteadofMacros"></a>
<p CLASS="heading4OrgHeading2h2">When to Use Visual Basic Instead of Macros</p>
<p CLASS="Textttext">With Microsoft Access, you can accomplish many tasks with macros or through the user interface that require programming in other database systems. So, when do you turn to Visual Basic? It depends on what you want to do. </p>
<a NAME="5WhyUseVisualBasic"></a>
<p CLASS="heading5OrgHeading3h3">Why Use Visual Basic?</p>
<p CLASS="Textttext">You'll want to use Visual Basic instead of macros if you want to do any of the following:</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Make your application easier to maintain</span>&nbsp;&nbsp;&amp;nbspBecause macros are separate objects from the forms and reports that use them, an application containing a large number of macros that respond to events on forms and reports can become difficult for you, the application developer, to maintain. In contrast, when you use Visual Basic to respond to events, your <span CLASS="NewTermntrm">code</span> is built into the form or report's definition. If you move a form or report from one database to another, the Visual Basic code built into the form or report moves with it. (Code is a general term for the statements you write in a programming language.)</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Create your own functions</span>&nbsp;&nbsp;&amp;nbspMicrosoft Access includes many built-in, or <span CLASS="NewTermntrm">intrinsic</span>, functions<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">such as the <span CLASS="ElementNameeln">IPmt</span> function that calculates an interest payment. You can use these functions to perform calculations without having to create complicated expressions. Using Visual Basic, you can also create your own functions to either perform calculations that exceed the capability of an expression or replace complex expressions you've written in your application.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on creating a function, see <a HREF="../chapters/ba02_3.htm" OnClick="SyncURL(&quot;chapters/ba02_3.htm&quot;)">&quot;Creating Your First Function&quot;</a> later in this chapter.</span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Mask error messages</span>&nbsp;&nbsp;&amp;nbspWhen something unexpected happens in your application and Microsoft Access displays an error message, the message can be quite mysterious to your application's users, especially if they aren't familiar with Microsoft Access. Using Visual Basic, you can detect the error when it occurs and display your own message, or you can have your application do something else. Applications used by a variety of people almost always require some Visual Basic code for handling errors.</p>
<p CLASS="ListText1lt1"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span><span CLASS="Xref">For more information on handling errors in your application, see Chapter 8, <a HREF="../chapters/ba08_1.htm" OnClick="SyncURL(&quot;chapters/ba08_1.htm&quot;)">&quot;Handling Run-Time Errors.&quot;</a></span></p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Create or manipulate objects</span>&nbsp;&nbsp;&amp;nbspIn most cases, you'll find that it's easiest to create and modify an object in that object's Design view. In some situations, however, you may want to manipulate the definition of an object in code. Using Visual Basic, you can manipulate all the objects in a database, including the database itself. A Microsoft Access wizard is a good example of an application that creates and modifies objects using code. For example, the Form Wizard is a collection of Visual Basic functions that creates a form according to the specifications supplied by the user.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Perform system-level actions</span>&nbsp;&nbsp;&amp;nbspYou can use the RunApp action in a macro to run another Windows-based or MS-DOS®-based application from your Microsoft Access application, but you can't use a macro to do much else outside Microsoft Access. Using Visual Basic, you can check to see if a file exists on the system, use Automation or dynamic data exchange (DDE) to communicate with other Windows-based applications such as Microsoft Excel, and call functions in Windows dynamic-link libraries (DLLs).</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Manipulate records one at a time</span>&nbsp;&nbsp;&amp;nbspYou can use Visual Basic to step through a set of records one record at a time and perform an operation on each record. In contrast, macros work with entire sets of records at once.</p>
<p CLASS="ListBulletedItem1lb1"><img SRC="../images/bullet.jpg" WIDTH="5" HEIGHT="7">&nbsp;<span CLASS="ElementNameeln">Pass arguments to your code</span>&nbsp;&nbsp;&amp;nbspAn <span CLASS="NewTermntrm">argument</span> is a value that supplies the additional information that some actions require. You set arguments for macro actions in the lower part of the Macro window when you create the macro; you can't change them when the macro is running. With Visual Basic, however, you can pass arguments to your code at the time it runs. You can even use variables for arguments<img SRC="../images/Emdash.gif" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="16" HEIGHT="5">something you can't do in macros. This gives you a great deal of flexibility in how your code runs.</p>
<p CLASS="TipTexttpt"><span CLASS="TipHeadingtph">Tip&nbsp;&nbsp;&nbsp;</span>Although you can have both macros and Visual Basic code in your application, you may find it easier to use Visual Basic exclusively once you get started programming. If you have macros in your application, Microsoft Access can automatically convert them to event procedures or modules that perform all the equivalent actions in Visual Basic code. </p>
<p CLASS="NoteTextnt">In form or report Design view, use the <span CLASS="ElementNameeln">Convert Macros To Visual Basic</span> command (<span CLASS="ElementNameeln">Tools</span> menu, <span CLASS="ElementNameeln">Macro</span> submenu). For global macros that aren't attached to a specific form or report, use the <span CLASS="ElementNameeln">Save As/Export</span> command (<span CLASS="ElementNameeln">File</span> menu) to save the macro as a module. For more information, search the Help index for &quot;macros, converting.&quot;</p>
<a NAME="5WhyUseMacros"></a>
<p CLASS="heading5OrgHeading3h3">Why Use Macros?</p>
<p CLASS="Textttext">After reading all the reasons for using Visual Basic, you may wonder if there are any reasons left for using macros. However, macros do have their place in many applications. Macros are an easy way to take care of simple details such as opening and closing forms, showing and hiding toolbars, and running reports. Because you specify options for each action in the lower part of the Macro window, there's little syntax to remember, and developing applications can often be faster than with Visual Basic.
<p CLASS="Textttext">In addition to the ease of use macros provide, creating a macro is the only way to make global key assignments. </p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on assigning keys with an AutoKeys macro, see Chapter 1, <a HREF="../chapters/ba01_1.htm" OnClick="SyncURL(&quot;chapters/ba01_1.htm&quot;)">&quot;Creating an Application.&quot;</a></p>
<a NAME="4HowanEventDrivenApplicationWorks"></a>
<p CLASS="heading4OrgHeading2h2">How an Event-Driven Application Works</p>
<p CLASS="Textttext">An <span CLASS="NewTermntrm">event</span> is an action recognized by a form, report, or control. Each type of object in Microsoft Access automatically recognizes a predefined set of events. When you want a form, report, or control to respond to an event in a particular way, you can write a Visual Basic <span CLASS="NewTermntrm">event procedure</span> for that event.
<p CLASS="Textttext">Here's what happens in a typical event-driven application:</p>
<p CLASS="ListSequentialItem1ls">1.&nbsp;&amp;nbspA user starts the application and Microsoft Access automatically opens the startup form specified in the <span CLASS="ElementNameeln">Startup</span> dialog box.</p>
<p CLASS="ListSequentialItem1ls">2.&nbsp;&amp;nbspThe startup form, or a control on the startup form, receives an event. The event can be caused by the user (for example, a keystroke), or by your code (for example, an Open event when your code opens a form).</p>
<p CLASS="ListSequentialItem1ls">3.&nbsp;&amp;nbspIf there is an event procedure corresponding to that event, it runs.</p>
<p CLASS="ListSequentialItem1ls">4.&nbsp;&amp;nbspThe application waits for the next event.</p>
<p CLASS="NoteTextnt"><span CLASS="NoteHeadingnh">Note&nbsp;&nbsp;&nbsp;</span>Some events automatically trigger other events. For example, when the MouseDown event occurs, the Click and MouseUp events immediately follow.</p>
<a NAME="5EventDrivenvsTraditionalProgramming"></a>
<p CLASS="heading5OrgHeading3h3">Event-Driven vs. Traditional Programming</p>
<p CLASS="Textttext">In a traditional procedural program, the application rather than an event controls the portions of code that are run. It begins with the first line of code and follows a defined pathway through the application, calling procedures as needed.
<p CLASS="Textttext">In event-driven applications, a user action or system event runs an event procedure. Thus, the order in which your code is run depends on the order in which events occur; the order in which events occur is determined by the user's actions. This is the essence of graphical user interfaces and event-driven programming: The user is in charge, and your code responds accordingly.
<p CLASS="Textttext">Because you can't predict what the user will do, your code must make a few assumptions about &quot;the state of the world&quot; when it runs. It is important that you either test these assumptions before running your code or try to structure your application so that the assumptions are always valid. For example, if your application assumes that a text box has text in it before the user clicks a command button, you can write code to enable the command button only when the Change event for the text box occurs.</p>
<p CLASS="CrossRefTextcrt"><span CLASS="CrossRefHeadingcrh">See Also&nbsp;&nbsp;&nbsp;</span>For information on events, see Chapter 6, <a HREF="../chapters/ba06_1.htm" OnClick="SyncURL(&quot;chapters/ba06_1.htm&quot;)">&quot;Responding to Events.&quot;</a></p>
<p><!--DocFooterStart-->
<p><span CLASS="copyright"><a HREF="cpyright.htm">© 1996 Microsoft Corporation. All rights reserved.</a></span>
<p><!--DocFooterEnd-->
<a HREF="ba02_2.htm" OnClick="SyncURL(&quot;chapters/ba02_2.htm&quot;)"><img SRC="..\images\nextpage.gif" ALT="Next Page" ALIGN="RIGHT" BORDER="0"></a><!--mstheme--></font></body></html>
